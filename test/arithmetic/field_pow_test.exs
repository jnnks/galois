defmodule FieldPowTest do
  use ExUnit.Case
  @tag :gen_test_pow
  test "GF(2, 1) pow" do
    gf = GF.new(2, 1, [1,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
  end

  @tag :gen_test_pow
  test "GF(2, 2) pow" do
    gf = GF.new(2, 2, [1,1,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 1 == GF.pow(gf, 2, -3)
    assert 2 == GF.pow(gf, 2, -2)
    assert 3 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 3 == GF.pow(gf, 2, 2)
    assert 1 == GF.pow(gf, 3, -3)
    assert 3 == GF.pow(gf, 3, -2)
    assert 2 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 2 == GF.pow(gf, 3, 2)
  end

  @tag :gen_test_pow
  test "GF(2, 3) pow" do
    gf = GF.new(2, 3, [1,1,0,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 6 == GF.pow(gf, 2, -3)
    assert 7 == GF.pow(gf, 2, -2)
    assert 5 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 4 == GF.pow(gf, 2, 2)
    assert 7 == GF.pow(gf, 3, -3)
    assert 2 == GF.pow(gf, 3, -2)
    assert 6 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 5 == GF.pow(gf, 3, 2)
    assert 2 == GF.pow(gf, 4, -3)
    assert 3 == GF.pow(gf, 4, -2)
    assert 7 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 6 == GF.pow(gf, 4, 2)
    assert 3 == GF.pow(gf, 5, -3)
    assert 4 == GF.pow(gf, 5, -2)
    assert 2 == GF.pow(gf, 5, -1)
    assert 1 == GF.pow(gf, 5, 0)
    assert 5 == GF.pow(gf, 5, 1)
    assert 7 == GF.pow(gf, 5, 2)
    assert 4 == GF.pow(gf, 6, -3)
    assert 5 == GF.pow(gf, 6, -2)
    assert 3 == GF.pow(gf, 6, -1)
    assert 1 == GF.pow(gf, 6, 0)
    assert 6 == GF.pow(gf, 6, 1)
    assert 2 == GF.pow(gf, 6, 2)
    assert 5 == GF.pow(gf, 7, -3)
    assert 6 == GF.pow(gf, 7, -2)
    assert 4 == GF.pow(gf, 7, -1)
    assert 1 == GF.pow(gf, 7, 0)
    assert 7 == GF.pow(gf, 7, 1)
    assert 3 == GF.pow(gf, 7, 2)
  end

  @tag :gen_test_pow
  test "GF(3, 1) pow" do
    gf = GF.new(3, 1, [1,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 2 == GF.pow(gf, 2, -3)
    assert 1 == GF.pow(gf, 2, -2)
    assert 2 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 1 == GF.pow(gf, 2, 2)
  end

  @tag :gen_test_pow
  test "GF(3, 2) pow" do
    gf = GF.new(3, 2, [2,2,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 2 == GF.pow(gf, 2, -3)
    assert 1 == GF.pow(gf, 2, -2)
    assert 2 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 1 == GF.pow(gf, 2, 2)
    assert 6 == GF.pow(gf, 3, -3)
    assert 8 == GF.pow(gf, 3, -2)
    assert 5 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 4 == GF.pow(gf, 3, 2)
    assert 4 == GF.pow(gf, 4, -3)
    assert 2 == GF.pow(gf, 4, -2)
    assert 8 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 2 == GF.pow(gf, 4, 2)
    assert 7 == GF.pow(gf, 5, -3)
    assert 4 == GF.pow(gf, 5, -2)
    assert 3 == GF.pow(gf, 5, -1)
    assert 1 == GF.pow(gf, 5, 0)
    assert 5 == GF.pow(gf, 5, 1)
    assert 8 == GF.pow(gf, 5, 2)
    assert 3 == GF.pow(gf, 6, -3)
    assert 8 == GF.pow(gf, 6, -2)
    assert 7 == GF.pow(gf, 6, -1)
    assert 1 == GF.pow(gf, 6, 0)
    assert 6 == GF.pow(gf, 6, 1)
    assert 4 == GF.pow(gf, 6, 2)
    assert 5 == GF.pow(gf, 7, -3)
    assert 4 == GF.pow(gf, 7, -2)
    assert 6 == GF.pow(gf, 7, -1)
    assert 1 == GF.pow(gf, 7, 0)
    assert 7 == GF.pow(gf, 7, 1)
    assert 8 == GF.pow(gf, 7, 2)
    assert 8 == GF.pow(gf, 8, -3)
    assert 2 == GF.pow(gf, 8, -2)
    assert 4 == GF.pow(gf, 8, -1)
    assert 1 == GF.pow(gf, 8, 0)
    assert 8 == GF.pow(gf, 8, 1)
    assert 2 == GF.pow(gf, 8, 2)
  end

  @tag :gen_test_pow
  test "GF(3, 3) pow" do
    gf = GF.new(3, 3, [1,2,0,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 2 == GF.pow(gf, 2, -3)
    assert 1 == GF.pow(gf, 2, -2)
    assert 2 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 1 == GF.pow(gf, 2, 2)
    assert 24 == GF.pow(gf, 3, -3)
    assert 25 == GF.pow(gf, 3, -2)
    assert 19 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 9 == GF.pow(gf, 3, 2)
    assert 19 == GF.pow(gf, 4, -3)
    assert 20 == GF.pow(gf, 4, -2)
    assert 21 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 16 == GF.pow(gf, 4, 2)
    assert 21 == GF.pow(gf, 5, -3)
    assert 22 == GF.pow(gf, 5, -2)
    assert 24 == GF.pow(gf, 5, -1)
    assert 1 == GF.pow(gf, 5, 0)
    assert 5 == GF.pow(gf, 5, 1)
    assert 13 == GF.pow(gf, 5, 2)
    assert 12 == GF.pow(gf, 6, -3)
    assert 25 == GF.pow(gf, 6, -2)
    assert 11 == GF.pow(gf, 6, -1)
    assert 1 == GF.pow(gf, 6, 0)
    assert 6 == GF.pow(gf, 6, 1)
    assert 9 == GF.pow(gf, 6, 2)
    assert 15 == GF.pow(gf, 7, -3)
    assert 22 == GF.pow(gf, 7, -2)
    assert 12 == GF.pow(gf, 7, -1)
    assert 1 == GF.pow(gf, 7, 0)
    assert 7 == GF.pow(gf, 7, 1)
    assert 13 == GF.pow(gf, 7, 2)
    assert 11 == GF.pow(gf, 8, -3)
    assert 20 == GF.pow(gf, 8, -2)
    assert 15 == GF.pow(gf, 8, -1)
    assert 1 == GF.pow(gf, 8, 0)
    assert 8 == GF.pow(gf, 8, 1)
    assert 16 == GF.pow(gf, 8, 2)
    assert 22 == GF.pow(gf, 9, -3)
    assert 8 == GF.pow(gf, 9, -2)
    assert 25 == GF.pow(gf, 9, -1)
    assert 1 == GF.pow(gf, 9, 0)
    assert 9 == GF.pow(gf, 9, 1)
    assert 15 == GF.pow(gf, 9, 2)
    assert 18 == GF.pow(gf, 10, -3)
    assert 12 == GF.pow(gf, 10, -2)
    assert 23 == GF.pow(gf, 10, -1)
    assert 1 == GF.pow(gf, 10, 0)
    assert 10 == GF.pow(gf, 10, 1)
    assert 7 == GF.pow(gf, 10, 2)
    assert 7 == GF.pow(gf, 11, -3)
    assert 9 == GF.pow(gf, 11, -2)
    assert 6 == GF.pow(gf, 11, -1)
    assert 1 == GF.pow(gf, 11, 0)
    assert 11 == GF.pow(gf, 11, 1)
    assert 25 == GF.pow(gf, 11, 2)
    assert 8 == GF.pow(gf, 12, -3)
    assert 13 == GF.pow(gf, 12, -2)
    assert 7 == GF.pow(gf, 12, -1)
    assert 1 == GF.pow(gf, 12, 0)
    assert 12 == GF.pow(gf, 12, 1)
    assert 22 == GF.pow(gf, 12, 2)
    assert 20 == GF.pow(gf, 13, -3)
    assert 6 == GF.pow(gf, 13, -2)
    assert 22 == GF.pow(gf, 13, -1)
    assert 1 == GF.pow(gf, 13, 0)
    assert 13 == GF.pow(gf, 13, 1)
    assert 11 == GF.pow(gf, 13, 2)
    assert 26 == GF.pow(gf, 14, -3)
    assert 15 == GF.pow(gf, 14, -2)
    assert 18 == GF.pow(gf, 14, -1)
    assert 1 == GF.pow(gf, 14, 0)
    assert 14 == GF.pow(gf, 14, 1)
    assert 8 == GF.pow(gf, 14, 2)
    assert 6 == GF.pow(gf, 15, -3)
    assert 16 == GF.pow(gf, 15, -2)
    assert 8 == GF.pow(gf, 15, -1)
    assert 1 == GF.pow(gf, 15, 0)
    assert 15 == GF.pow(gf, 15, 1)
    assert 20 == GF.pow(gf, 15, 2)
    assert 25 == GF.pow(gf, 16, -3)
    assert 7 == GF.pow(gf, 16, -2)
    assert 20 == GF.pow(gf, 16, -1)
    assert 1 == GF.pow(gf, 16, 0)
    assert 16 == GF.pow(gf, 16, 1)
    assert 12 == GF.pow(gf, 16, 2)
    assert 23 == GF.pow(gf, 17, -3)
    assert 11 == GF.pow(gf, 17, -2)
    assert 26 == GF.pow(gf, 17, -1)
    assert 1 == GF.pow(gf, 17, 0)
    assert 17 == GF.pow(gf, 17, 1)
    assert 6 == GF.pow(gf, 17, 2)
    assert 17 == GF.pow(gf, 18, -3)
    assert 8 == GF.pow(gf, 18, -2)
    assert 14 == GF.pow(gf, 18, -1)
    assert 1 == GF.pow(gf, 18, 0)
    assert 18 == GF.pow(gf, 18, 1)
    assert 15 == GF.pow(gf, 18, 2)
    assert 5 == GF.pow(gf, 19, -3)
    assert 9 == GF.pow(gf, 19, -2)
    assert 3 == GF.pow(gf, 19, -1)
    assert 1 == GF.pow(gf, 19, 0)
    assert 19 == GF.pow(gf, 19, 1)
    assert 25 == GF.pow(gf, 19, 2)
    assert 9 == GF.pow(gf, 20, -3)
    assert 12 == GF.pow(gf, 20, -2)
    assert 16 == GF.pow(gf, 20, -1)
    assert 1 == GF.pow(gf, 20, 0)
    assert 20 == GF.pow(gf, 20, 1)
    assert 7 == GF.pow(gf, 20, 2)
    assert 3 == GF.pow(gf, 21, -3)
    assert 16 == GF.pow(gf, 21, -2)
    assert 4 == GF.pow(gf, 21, -1)
    assert 1 == GF.pow(gf, 21, 0)
    assert 21 == GF.pow(gf, 21, 1)
    assert 20 == GF.pow(gf, 21, 2)
    assert 16 == GF.pow(gf, 22, -3)
    assert 11 == GF.pow(gf, 22, -2)
    assert 13 == GF.pow(gf, 22, -1)
    assert 1 == GF.pow(gf, 22, 0)
    assert 22 == GF.pow(gf, 22, 1)
    assert 6 == GF.pow(gf, 22, 2)
    assert 14 == GF.pow(gf, 23, -3)
    assert 7 == GF.pow(gf, 23, -2)
    assert 10 == GF.pow(gf, 23, -1)
    assert 1 == GF.pow(gf, 23, 0)
    assert 23 == GF.pow(gf, 23, 1)
    assert 12 == GF.pow(gf, 23, 2)
    assert 4 == GF.pow(gf, 24, -3)
    assert 13 == GF.pow(gf, 24, -2)
    assert 5 == GF.pow(gf, 24, -1)
    assert 1 == GF.pow(gf, 24, 0)
    assert 24 == GF.pow(gf, 24, 1)
    assert 22 == GF.pow(gf, 24, 2)
    assert 13 == GF.pow(gf, 25, -3)
    assert 15 == GF.pow(gf, 25, -2)
    assert 9 == GF.pow(gf, 25, -1)
    assert 1 == GF.pow(gf, 25, 0)
    assert 25 == GF.pow(gf, 25, 1)
    assert 8 == GF.pow(gf, 25, 2)
    assert 10 == GF.pow(gf, 26, -3)
    assert 6 == GF.pow(gf, 26, -2)
    assert 17 == GF.pow(gf, 26, -1)
    assert 1 == GF.pow(gf, 26, 0)
    assert 26 == GF.pow(gf, 26, 1)
    assert 11 == GF.pow(gf, 26, 2)
  end

  @tag :gen_test_pow
  test "GF(5, 1) pow" do
    gf = GF.new(5, 1, [3,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 2 == GF.pow(gf, 2, -3)
    assert 4 == GF.pow(gf, 2, -2)
    assert 3 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 4 == GF.pow(gf, 2, 2)
    assert 3 == GF.pow(gf, 3, -3)
    assert 4 == GF.pow(gf, 3, -2)
    assert 2 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 4 == GF.pow(gf, 3, 2)
    assert 4 == GF.pow(gf, 4, -3)
    assert 1 == GF.pow(gf, 4, -2)
    assert 4 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 1 == GF.pow(gf, 4, 2)
  end

  @tag :gen_test_pow
  test "GF(5, 2) pow" do
    gf = GF.new(5, 2, [2,4,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 2 == GF.pow(gf, 2, -3)
    assert 4 == GF.pow(gf, 2, -2)
    assert 3 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 4 == GF.pow(gf, 2, 2)
    assert 3 == GF.pow(gf, 3, -3)
    assert 4 == GF.pow(gf, 3, -2)
    assert 2 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 4 == GF.pow(gf, 3, 2)
    assert 4 == GF.pow(gf, 4, -3)
    assert 1 == GF.pow(gf, 4, -2)
    assert 4 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 1 == GF.pow(gf, 4, 2)
    assert 14 == GF.pow(gf, 5, -3)
    assert 6 == GF.pow(gf, 5, -2)
    assert 13 == GF.pow(gf, 5, -1)
    assert 1 == GF.pow(gf, 5, 0)
    assert 5 == GF.pow(gf, 5, 1)
    assert 8 == GF.pow(gf, 5, 2)
    assert 2 == GF.pow(gf, 6, -3)
    assert 12 == GF.pow(gf, 6, -2)
    assert 8 == GF.pow(gf, 6, -1)
    assert 1 == GF.pow(gf, 6, 0)
    assert 6 == GF.pow(gf, 6, 1)
    assert 19 == GF.pow(gf, 6, 2)
    assert 23 == GF.pow(gf, 7, -3)
    assert 3 == GF.pow(gf, 7, -2)
    assert 16 == GF.pow(gf, 7, -1)
    assert 1 == GF.pow(gf, 7, 0)
    assert 7 == GF.pow(gf, 7, 1)
    assert 2 == GF.pow(gf, 7, 2)
    assert 3 == GF.pow(gf, 8, -3)
    assert 19 == GF.pow(gf, 8, -2)
    assert 6 == GF.pow(gf, 8, -1)
    assert 1 == GF.pow(gf, 8, 0)
    assert 8 == GF.pow(gf, 8, 1)
    assert 12 == GF.pow(gf, 8, 2)
    assert 14 == GF.pow(gf, 9, -3)
    assert 22 == GF.pow(gf, 9, -2)
    assert 10 == GF.pow(gf, 9, -1)
    assert 1 == GF.pow(gf, 9, 0)
    assert 9 == GF.pow(gf, 9, 1)
    assert 24 == GF.pow(gf, 9, 2)
    assert 23 == GF.pow(gf, 10, -3)
    assert 24 == GF.pow(gf, 10, -2)
    assert 9 == GF.pow(gf, 10, -1)
    assert 1 == GF.pow(gf, 10, 0)
    assert 10 == GF.pow(gf, 10, 1)
    assert 22 == GF.pow(gf, 10, 2)
    assert 1 == GF.pow(gf, 11, -3)
    assert 11 == GF.pow(gf, 11, -2)
    assert 18 == GF.pow(gf, 11, -1)
    assert 1 == GF.pow(gf, 11, 0)
    assert 11 == GF.pow(gf, 11, 1)
    assert 18 == GF.pow(gf, 11, 2)
    assert 4 == GF.pow(gf, 12, -3)
    assert 18 == GF.pow(gf, 12, -2)
    assert 19 == GF.pow(gf, 12, -1)
    assert 1 == GF.pow(gf, 12, 0)
    assert 12 == GF.pow(gf, 12, 1)
    assert 11 == GF.pow(gf, 12, 2)
    assert 23 == GF.pow(gf, 13, -3)
    assert 8 == GF.pow(gf, 13, -2)
    assert 5 == GF.pow(gf, 13, -1)
    assert 1 == GF.pow(gf, 13, 0)
    assert 13 == GF.pow(gf, 13, 1)
    assert 6 == GF.pow(gf, 13, 2)
    assert 16 == GF.pow(gf, 14, -3)
    assert 2 == GF.pow(gf, 14, -2)
    assert 23 == GF.pow(gf, 14, -1)
    assert 1 == GF.pow(gf, 14, 0)
    assert 14 == GF.pow(gf, 14, 1)
    assert 3 == GF.pow(gf, 14, 2)
    assert 7 == GF.pow(gf, 15, -3)
    assert 24 == GF.pow(gf, 15, -2)
    assert 21 == GF.pow(gf, 15, -1)
    assert 1 == GF.pow(gf, 15, 0)
    assert 15 == GF.pow(gf, 15, 1)
    assert 22 == GF.pow(gf, 15, 2)
    assert 14 == GF.pow(gf, 16, -3)
    assert 2 == GF.pow(gf, 16, -2)
    assert 7 == GF.pow(gf, 16, -1)
    assert 1 == GF.pow(gf, 16, 0)
    assert 16 == GF.pow(gf, 16, 1)
    assert 3 == GF.pow(gf, 16, 2)
    assert 7 == GF.pow(gf, 17, -3)
    assert 8 == GF.pow(gf, 17, -2)
    assert 20 == GF.pow(gf, 17, -1)
    assert 1 == GF.pow(gf, 17, 0)
    assert 17 == GF.pow(gf, 17, 1)
    assert 6 == GF.pow(gf, 17, 2)
    assert 1 == GF.pow(gf, 18, -3)
    assert 18 == GF.pow(gf, 18, -2)
    assert 11 == GF.pow(gf, 18, -1)
    assert 1 == GF.pow(gf, 18, 0)
    assert 18 == GF.pow(gf, 18, 1)
    assert 11 == GF.pow(gf, 18, 2)
    assert 4 == GF.pow(gf, 19, -3)
    assert 11 == GF.pow(gf, 19, -2)
    assert 12 == GF.pow(gf, 19, -1)
    assert 1 == GF.pow(gf, 19, 0)
    assert 19 == GF.pow(gf, 19, 1)
    assert 18 == GF.pow(gf, 19, 2)
    assert 16 == GF.pow(gf, 20, -3)
    assert 6 == GF.pow(gf, 20, -2)
    assert 17 == GF.pow(gf, 20, -1)
    assert 1 == GF.pow(gf, 20, 0)
    assert 20 == GF.pow(gf, 20, 1)
    assert 8 == GF.pow(gf, 20, 2)
    assert 16 == GF.pow(gf, 21, -3)
    assert 22 == GF.pow(gf, 21, -2)
    assert 15 == GF.pow(gf, 21, -1)
    assert 1 == GF.pow(gf, 21, 0)
    assert 21 == GF.pow(gf, 21, 1)
    assert 24 == GF.pow(gf, 21, 2)
    assert 2 == GF.pow(gf, 22, -3)
    assert 19 == GF.pow(gf, 22, -2)
    assert 24 == GF.pow(gf, 22, -1)
    assert 1 == GF.pow(gf, 22, 0)
    assert 22 == GF.pow(gf, 22, 1)
    assert 12 == GF.pow(gf, 22, 2)
    assert 7 == GF.pow(gf, 23, -3)
    assert 3 == GF.pow(gf, 23, -2)
    assert 14 == GF.pow(gf, 23, -1)
    assert 1 == GF.pow(gf, 23, 0)
    assert 23 == GF.pow(gf, 23, 1)
    assert 2 == GF.pow(gf, 23, 2)
    assert 3 == GF.pow(gf, 24, -3)
    assert 12 == GF.pow(gf, 24, -2)
    assert 22 == GF.pow(gf, 24, -1)
    assert 1 == GF.pow(gf, 24, 0)
    assert 24 == GF.pow(gf, 24, 1)
    assert 19 == GF.pow(gf, 24, 2)
  end

  @tag :gen_test_pow
  test "GF(5, 3) pow" do
    gf = GF.new(5, 3, [3,3,0,1])
    assert 81 == GF.pow(gf, 73, -3)
    assert 61 == GF.pow(gf, 73, -2)
    assert 112 == GF.pow(gf, 73, -1)
    assert 1 == GF.pow(gf, 73, 0)
    assert 73 == GF.pow(gf, 73, 1)
    assert 46 == GF.pow(gf, 73, 2)
    assert 58 == GF.pow(gf, 54, -3)
    assert 56 == GF.pow(gf, 54, -2)
    assert 83 == GF.pow(gf, 54, -1)
    assert 1 == GF.pow(gf, 54, 0)
    assert 54 == GF.pow(gf, 54, 1)
    assert 116 == GF.pow(gf, 54, 2)
    assert 11 == GF.pow(gf, 56, -3)
    assert 109 == GF.pow(gf, 56, -2)
    assert 116 == GF.pow(gf, 56, -1)
    assert 1 == GF.pow(gf, 56, 0)
    assert 56 == GF.pow(gf, 56, 1)
    assert 94 == GF.pow(gf, 56, 2)
    assert 45 == GF.pow(gf, 42, -3)
    assert 49 == GF.pow(gf, 42, -2)
    assert 7 == GF.pow(gf, 42, -1)
    assert 1 == GF.pow(gf, 42, 0)
    assert 42 == GF.pow(gf, 42, 1)
    assert 6 == GF.pow(gf, 42, 2)
    assert 99 == GF.pow(gf, 40, -3)
    assert 71 == GF.pow(gf, 40, -2)
    assert 60 == GF.pow(gf, 40, -1)
    assert 1 == GF.pow(gf, 40, 0)
    assert 40 == GF.pow(gf, 40, 1)
    assert 47 == GF.pow(gf, 40, 2)
    assert 73 == GF.pow(gf, 120, -3)
    assert 108 == GF.pow(gf, 120, -2)
    assert 95 == GF.pow(gf, 120, -1)
    assert 1 == GF.pow(gf, 120, 0)
    assert 120 == GF.pow(gf, 120, 1)
    assert 84 == GF.pow(gf, 120, 2)
    assert 5 == GF.pow(gf, 21, -3)
    assert 105 == GF.pow(gf, 21, -2)
    assert 92 == GF.pow(gf, 21, -1)
    assert 1 == GF.pow(gf, 21, 0)
    assert 21 == GF.pow(gf, 21, 1)
    assert 41 == GF.pow(gf, 21, 2)
    assert 21 == GF.pow(gf, 67, -3)
    assert 113 == GF.pow(gf, 67, -2)
    assert 33 == GF.pow(gf, 67, -1)
    assert 1 == GF.pow(gf, 67, 0)
    assert 67 == GF.pow(gf, 67, 1)
    assert 23 == GF.pow(gf, 67, 2)
    assert 100 == GF.pow(gf, 114, -3)
    assert 91 == GF.pow(gf, 114, -2)
    assert 45 == GF.pow(gf, 114, -1)
    assert 1 == GF.pow(gf, 114, 0)
    assert 114 == GF.pow(gf, 114, 1)
    assert 78 == GF.pow(gf, 114, 2)
    assert 61 == GF.pow(gf, 108, -3)
    assert 93 == GF.pow(gf, 108, -2)
    assert 84 == GF.pow(gf, 108, -1)
    assert 1 == GF.pow(gf, 108, 0)
    assert 108 == GF.pow(gf, 108, 1)
    assert 70 == GF.pow(gf, 108, 2)
    assert 89 == GF.pow(gf, 45, -3)
    assert 78 == GF.pow(gf, 45, -2)
    assert 114 == GF.pow(gf, 45, -1)
    assert 1 == GF.pow(gf, 45, 0)
    assert 45 == GF.pow(gf, 45, 1)
    assert 91 == GF.pow(gf, 45, 2)
    assert 61 == GF.pow(gf, 108, -3)
    assert 93 == GF.pow(gf, 108, -2)
    assert 84 == GF.pow(gf, 108, -1)
    assert 1 == GF.pow(gf, 108, 0)
    assert 108 == GF.pow(gf, 108, 1)
    assert 70 == GF.pow(gf, 108, 2)
    assert 27 == GF.pow(gf, 100, -3)
    assert 40 == GF.pow(gf, 100, -2)
    assert 89 == GF.pow(gf, 100, -1)
    assert 1 == GF.pow(gf, 100, 0)
    assert 100 == GF.pow(gf, 100, 1)
    assert 60 == GF.pow(gf, 100, 2)
    assert 39 == GF.pow(gf, 60, -3)
    assert 47 == GF.pow(gf, 60, -2)
    assert 40 == GF.pow(gf, 60, -1)
    assert 1 == GF.pow(gf, 60, 0)
    assert 60 == GF.pow(gf, 60, 1)
    assert 71 == GF.pow(gf, 60, 2)
    assert 61 == GF.pow(gf, 108, -3)
    assert 93 == GF.pow(gf, 108, -2)
    assert 84 == GF.pow(gf, 108, -1)
    assert 1 == GF.pow(gf, 108, 0)
    assert 108 == GF.pow(gf, 108, 1)
    assert 70 == GF.pow(gf, 108, 2)
    assert 116 == GF.pow(gf, 90, -3)
    assert 47 == GF.pow(gf, 90, -2)
    assert 110 == GF.pow(gf, 90, -1)
    assert 1 == GF.pow(gf, 90, 0)
    assert 90 == GF.pow(gf, 90, 1)
    assert 71 == GF.pow(gf, 90, 2)
    assert 84 == GF.pow(gf, 111, -3)
    assert 19 == GF.pow(gf, 111, -2)
    assert 53 == GF.pow(gf, 111, -1)
    assert 1 == GF.pow(gf, 111, 0)
    assert 111 == GF.pow(gf, 111, 1)
    assert 118 == GF.pow(gf, 111, 2)
    assert 118 == GF.pow(gf, 39, -3)
    assert 94 == GF.pow(gf, 39, -2)
    assert 99 == GF.pow(gf, 39, -1)
    assert 1 == GF.pow(gf, 39, 0)
    assert 39 == GF.pow(gf, 39, 1)
    assert 109 == GF.pow(gf, 39, 2)
    assert 34 == GF.pow(gf, 61, -3)
    assert 7 == GF.pow(gf, 61, -2)
    assert 46 == GF.pow(gf, 61, -1)
    assert 1 == GF.pow(gf, 61, 0)
    assert 61 == GF.pow(gf, 61, 1)
    assert 42 == GF.pow(gf, 61, 2)
    assert 103 == GF.pow(gf, 25, -3)
    assert 40 == GF.pow(gf, 25, -2)
    assert 66 == GF.pow(gf, 25, -1)
    assert 1 == GF.pow(gf, 25, 0)
    assert 25 == GF.pow(gf, 25, 1)
    assert 60 == GF.pow(gf, 25, 2)
    assert 11 == GF.pow(gf, 56, -3)
    assert 109 == GF.pow(gf, 56, -2)
    assert 116 == GF.pow(gf, 56, -1)
    assert 1 == GF.pow(gf, 56, 0)
    assert 56 == GF.pow(gf, 56, 1)
    assert 94 == GF.pow(gf, 56, 2)
    assert 102 == GF.pow(gf, 121, -3)
    assert 114 == GF.pow(gf, 121, -2)
    assert 17 == GF.pow(gf, 121, -1)
    assert 1 == GF.pow(gf, 121, 0)
    assert 121 == GF.pow(gf, 121, 1)
    assert 45 == GF.pow(gf, 121, 2)
    assert 32 == GF.pow(gf, 12, -3)
    assert 103 == GF.pow(gf, 12, -2)
    assert 87 == GF.pow(gf, 12, -1)
    assert 1 == GF.pow(gf, 12, 0)
    assert 12 == GF.pow(gf, 12, 1)
    assert 119 == GF.pow(gf, 12, 2)
    assert 97 == GF.pow(gf, 76, -3)
    assert 56 == GF.pow(gf, 76, -2)
    assert 72 == GF.pow(gf, 76, -1)
    assert 1 == GF.pow(gf, 76, 0)
    assert 76 == GF.pow(gf, 76, 1)
    assert 116 == GF.pow(gf, 76, 2)
    assert 44 == GF.pow(gf, 27, -3)
    assert 99 == GF.pow(gf, 27, -2)
    assert 36 == GF.pow(gf, 27, -1)
    assert 1 == GF.pow(gf, 27, 0)
    assert 27 == GF.pow(gf, 27, 1)
    assert 39 == GF.pow(gf, 27, 2)
    assert 21 == GF.pow(gf, 67, -3)
    assert 113 == GF.pow(gf, 67, -2)
    assert 33 == GF.pow(gf, 67, -1)
    assert 1 == GF.pow(gf, 67, 0)
    assert 67 == GF.pow(gf, 67, 1)
    assert 23 == GF.pow(gf, 67, 2)
    assert 7 == GF.pow(gf, 93, -3)
    assert 102 == GF.pow(gf, 93, -2)
    assert 70 == GF.pow(gf, 93, -1)
    assert 1 == GF.pow(gf, 93, 0)
    assert 93 == GF.pow(gf, 93, 1)
    assert 10 == GF.pow(gf, 93, 2)
    assert 91 == GF.pow(gf, 6, -3)
    assert 27 == GF.pow(gf, 6, -2)
    assert 49 == GF.pow(gf, 6, -1)
    assert 1 == GF.pow(gf, 6, 0)
    assert 6 == GF.pow(gf, 6, 1)
    assert 36 == GF.pow(gf, 6, 2)
    assert 88 == GF.pow(gf, 117, -3)
    assert 80 == GF.pow(gf, 117, -2)
    assert 86 == GF.pow(gf, 117, -1)
    assert 1 == GF.pow(gf, 117, 0)
    assert 117 == GF.pow(gf, 117, 1)
    assert 62 == GF.pow(gf, 117, 2)
    assert 121 == GF.pow(gf, 94, -3)
    assert 7 == GF.pow(gf, 94, -2)
    assert 109 == GF.pow(gf, 94, -1)
    assert 1 == GF.pow(gf, 94, 0)
    assert 94 == GF.pow(gf, 94, 1)
    assert 42 == GF.pow(gf, 94, 2)
    assert 123 == GF.pow(gf, 18, -3)
    assert 103 == GF.pow(gf, 18, -2)
    assert 68 == GF.pow(gf, 18, -1)
    assert 1 == GF.pow(gf, 18, 0)
    assert 18 == GF.pow(gf, 18, 1)
    assert 119 == GF.pow(gf, 18, 2)
    assert 114 == GF.pow(gf, 7, -3)
    assert 6 == GF.pow(gf, 7, -2)
    assert 42 == GF.pow(gf, 7, -1)
    assert 1 == GF.pow(gf, 7, 0)
    assert 7 == GF.pow(gf, 7, 1)
    assert 49 == GF.pow(gf, 7, 2)
    assert 82 == GF.pow(gf, 30, -3)
    assert 108 == GF.pow(gf, 30, -2)
    assert 55 == GF.pow(gf, 30, -1)
    assert 1 == GF.pow(gf, 30, 0)
    assert 30 == GF.pow(gf, 30, 1)
    assert 84 == GF.pow(gf, 30, 2)
    assert 72 == GF.pow(gf, 48, -3)
    assert 90 == GF.pow(gf, 48, -2)
    assert 50 == GF.pow(gf, 48, -1)
    assert 1 == GF.pow(gf, 48, 0)
    assert 48 == GF.pow(gf, 48, 1)
    assert 110 == GF.pow(gf, 48, 2)
    assert 65 == GF.pow(gf, 59, -3)
    assert 106 == GF.pow(gf, 59, -2)
    assert 16 == GF.pow(gf, 59, -1)
    assert 1 == GF.pow(gf, 59, 0)
    assert 59 == GF.pow(gf, 59, 1)
    assert 24 == GF.pow(gf, 59, 2)
    assert 18 == GF.pow(gf, 51, -3)
    assert 25 == GF.pow(gf, 51, -2)
    assert 20 == GF.pow(gf, 51, -1)
    assert 1 == GF.pow(gf, 51, 0)
    assert 51 == GF.pow(gf, 51, 1)
    assert 66 == GF.pow(gf, 51, 2)
    assert 3 == GF.pow(gf, 3, -3)
    assert 4 == GF.pow(gf, 3, -2)
    assert 2 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 4 == GF.pow(gf, 3, 2)
    assert 17 == GF.pow(gf, 109, -3)
    assert 42 == GF.pow(gf, 109, -2)
    assert 94 == GF.pow(gf, 109, -1)
    assert 1 == GF.pow(gf, 109, 0)
    assert 109 == GF.pow(gf, 109, 1)
    assert 7 == GF.pow(gf, 109, 2)
    assert 42 == GF.pow(gf, 70, -3)
    assert 10 == GF.pow(gf, 70, -2)
    assert 93 == GF.pow(gf, 70, -1)
    assert 1 == GF.pow(gf, 70, 0)
    assert 70 == GF.pow(gf, 70, 1)
    assert 102 == GF.pow(gf, 70, 2)
    assert 7 == GF.pow(gf, 93, -3)
    assert 102 == GF.pow(gf, 93, -2)
    assert 70 == GF.pow(gf, 93, -1)
    assert 1 == GF.pow(gf, 93, 0)
    assert 93 == GF.pow(gf, 93, 1)
    assert 10 == GF.pow(gf, 93, 2)
    assert 51 == GF.pow(gf, 63, -3)
    assert 41 == GF.pow(gf, 63, -2)
    assert 9 == GF.pow(gf, 63, -1)
    assert 1 == GF.pow(gf, 63, 0)
    assert 63 == GF.pow(gf, 63, 1)
    assert 105 == GF.pow(gf, 63, 2)
    assert 81 == GF.pow(gf, 73, -3)
    assert 61 == GF.pow(gf, 73, -2)
    assert 112 == GF.pow(gf, 73, -1)
    assert 1 == GF.pow(gf, 73, 0)
    assert 73 == GF.pow(gf, 73, 1)
    assert 46 == GF.pow(gf, 73, 2)
    assert 68 == GF.pow(gf, 20, -3)
    assert 66 == GF.pow(gf, 20, -2)
    assert 51 == GF.pow(gf, 20, -1)
    assert 1 == GF.pow(gf, 20, 0)
    assert 20 == GF.pow(gf, 20, 1)
    assert 25 == GF.pow(gf, 20, 2)
    assert 32 == GF.pow(gf, 12, -3)
    assert 103 == GF.pow(gf, 12, -2)
    assert 87 == GF.pow(gf, 12, -1)
    assert 1 == GF.pow(gf, 12, 0)
    assert 12 == GF.pow(gf, 12, 1)
    assert 119 == GF.pow(gf, 12, 2)
    assert 21 == GF.pow(gf, 67, -3)
    assert 113 == GF.pow(gf, 67, -2)
    assert 33 == GF.pow(gf, 67, -1)
    assert 1 == GF.pow(gf, 67, 0)
    assert 67 == GF.pow(gf, 67, 1)
    assert 23 == GF.pow(gf, 67, 2)
    assert 13 == GF.pow(gf, 46, -3)
    assert 42 == GF.pow(gf, 46, -2)
    assert 61 == GF.pow(gf, 46, -1)
    assert 1 == GF.pow(gf, 46, 0)
    assert 46 == GF.pow(gf, 46, 1)
    assert 7 == GF.pow(gf, 46, 2)
    assert 46 == GF.pow(gf, 84, -3)
    assert 70 == GF.pow(gf, 84, -2)
    assert 108 == GF.pow(gf, 84, -1)
    assert 1 == GF.pow(gf, 84, 0)
    assert 84 == GF.pow(gf, 84, 1)
    assert 93 == GF.pow(gf, 84, 2)
    assert 33 == GF.pow(gf, 69, -3)
    assert 62 == GF.pow(gf, 69, -2)
    assert 38 == GF.pow(gf, 69, -1)
    assert 1 == GF.pow(gf, 69, 0)
    assert 69 == GF.pow(gf, 69, 1)
    assert 80 == GF.pow(gf, 69, 2)
    assert 88 == GF.pow(gf, 117, -3)
    assert 80 == GF.pow(gf, 117, -2)
    assert 86 == GF.pow(gf, 117, -1)
    assert 1 == GF.pow(gf, 117, 0)
    assert 117 == GF.pow(gf, 117, 1)
    assert 62 == GF.pow(gf, 117, 2)
    assert 15 == GF.pow(gf, 13, -3)
    assert 45 == GF.pow(gf, 13, -2)
    assert 34 == GF.pow(gf, 13, -1)
    assert 1 == GF.pow(gf, 13, 0)
    assert 13 == GF.pow(gf, 13, 1)
    assert 114 == GF.pow(gf, 13, 2)
    assert 86 == GF.pow(gf, 101, -3)
    assert 37 == GF.pow(gf, 101, -2)
    assert 58 == GF.pow(gf, 101, -1)
    assert 1 == GF.pow(gf, 101, 0)
    assert 101 == GF.pow(gf, 101, 1)
    assert 11 == GF.pow(gf, 101, 2)
    assert 121 == GF.pow(gf, 94, -3)
    assert 7 == GF.pow(gf, 94, -2)
    assert 109 == GF.pow(gf, 94, -1)
    assert 1 == GF.pow(gf, 94, 0)
    assert 94 == GF.pow(gf, 94, 1)
    assert 42 == GF.pow(gf, 94, 2)
    assert 41 == GF.pow(gf, 23, -3)
    assert 6 == GF.pow(gf, 23, -2)
    assert 113 == GF.pow(gf, 23, -1)
    assert 1 == GF.pow(gf, 23, 0)
    assert 23 == GF.pow(gf, 23, 1)
    assert 49 == GF.pow(gf, 23, 2)
    assert 38 == GF.pow(gf, 97, -3)
    assert 11 == GF.pow(gf, 97, -2)
    assert 29 == GF.pow(gf, 97, -1)
    assert 1 == GF.pow(gf, 97, 0)
    assert 97 == GF.pow(gf, 97, 1)
    assert 37 == GF.pow(gf, 97, 2)
    assert 2 == GF.pow(gf, 2, -3)
    assert 4 == GF.pow(gf, 2, -2)
    assert 3 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 4 == GF.pow(gf, 2, 2)
    assert 38 == GF.pow(gf, 97, -3)
    assert 11 == GF.pow(gf, 97, -2)
    assert 29 == GF.pow(gf, 97, -1)
    assert 1 == GF.pow(gf, 97, 0)
    assert 97 == GF.pow(gf, 97, 1)
    assert 37 == GF.pow(gf, 97, 2)
    assert 41 == GF.pow(gf, 23, -3)
    assert 6 == GF.pow(gf, 23, -2)
    assert 113 == GF.pow(gf, 23, -1)
    assert 1 == GF.pow(gf, 23, 0)
    assert 23 == GF.pow(gf, 23, 1)
    assert 49 == GF.pow(gf, 23, 2)
    assert 64 == GF.pow(gf, 24, -3)
    assert 27 == GF.pow(gf, 24, -2)
    assert 106 == GF.pow(gf, 24, -1)
    assert 1 == GF.pow(gf, 24, 0)
    assert 24 == GF.pow(gf, 24, 1)
    assert 36 == GF.pow(gf, 24, 2)
    assert 19 == GF.pow(gf, 99, -3)
    assert 109 == GF.pow(gf, 99, -2)
    assert 39 == GF.pow(gf, 99, -1)
    assert 1 == GF.pow(gf, 99, 0)
    assert 99 == GF.pow(gf, 99, 1)
    assert 94 == GF.pow(gf, 99, 2)
    assert 82 == GF.pow(gf, 30, -3)
    assert 108 == GF.pow(gf, 30, -2)
    assert 55 == GF.pow(gf, 30, -1)
    assert 1 == GF.pow(gf, 30, 0)
    assert 30 == GF.pow(gf, 30, 1)
    assert 84 == GF.pow(gf, 30, 2)
    assert 20 == GF.pow(gf, 9, -3)
    assert 105 == GF.pow(gf, 9, -2)
    assert 63 == GF.pow(gf, 9, -1)
    assert 1 == GF.pow(gf, 9, 0)
    assert 9 == GF.pow(gf, 9, 1)
    assert 41 == GF.pow(gf, 9, 2)
    assert 84 == GF.pow(gf, 111, -3)
    assert 19 == GF.pow(gf, 111, -2)
    assert 53 == GF.pow(gf, 111, -1)
    assert 1 == GF.pow(gf, 111, 0)
    assert 111 == GF.pow(gf, 111, 1)
    assert 118 == GF.pow(gf, 111, 2)
    assert 4 == GF.pow(gf, 4, -3)
    assert 1 == GF.pow(gf, 4, -2)
    assert 4 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 1 == GF.pow(gf, 4, 2)
    assert 75 == GF.pow(gf, 98, -3)
    assert 64 == GF.pow(gf, 98, -2)
    assert 85 == GF.pow(gf, 98, -1)
    assert 1 == GF.pow(gf, 98, 0)
    assert 98 == GF.pow(gf, 98, 1)
    assert 52 == GF.pow(gf, 98, 2)
    assert 79 == GF.pow(gf, 92, -3)
    assert 41 == GF.pow(gf, 92, -2)
    assert 21 == GF.pow(gf, 92, -1)
    assert 1 == GF.pow(gf, 92, 0)
    assert 92 == GF.pow(gf, 92, 1)
    assert 105 == GF.pow(gf, 92, 2)
    assert 93 == GF.pow(gf, 118, -3)
    assert 121 == GF.pow(gf, 118, -2)
    assert 19 == GF.pow(gf, 118, -1)
    assert 1 == GF.pow(gf, 118, 0)
    assert 118 == GF.pow(gf, 118, 1)
    assert 17 == GF.pow(gf, 118, 2)
    assert 106 == GF.pow(gf, 15, -3)
    assert 89 == GF.pow(gf, 15, -2)
    assert 28 == GF.pow(gf, 15, -1)
    assert 1 == GF.pow(gf, 15, 0)
    assert 15 == GF.pow(gf, 15, 1)
    assert 100 == GF.pow(gf, 15, 2)
    assert 81 == GF.pow(gf, 73, -3)
    assert 61 == GF.pow(gf, 73, -2)
    assert 112 == GF.pow(gf, 73, -1)
    assert 1 == GF.pow(gf, 73, 0)
    assert 73 == GF.pow(gf, 73, 1)
    assert 46 == GF.pow(gf, 73, 2)
    assert 58 == GF.pow(gf, 54, -3)
    assert 56 == GF.pow(gf, 54, -2)
    assert 83 == GF.pow(gf, 54, -1)
    assert 1 == GF.pow(gf, 54, 0)
    assert 54 == GF.pow(gf, 54, 1)
    assert 116 == GF.pow(gf, 54, 2)
    assert 102 == GF.pow(gf, 121, -3)
    assert 114 == GF.pow(gf, 121, -2)
    assert 17 == GF.pow(gf, 121, -1)
    assert 1 == GF.pow(gf, 121, 0)
    assert 121 == GF.pow(gf, 121, 1)
    assert 45 == GF.pow(gf, 121, 2)
    assert 90 == GF.pow(gf, 52, -3)
    assert 77 == GF.pow(gf, 52, -2)
    assert 64 == GF.pow(gf, 52, -1)
    assert 1 == GF.pow(gf, 52, 0)
    assert 52 == GF.pow(gf, 52, 1)
    assert 44 == GF.pow(gf, 52, 2)
    assert 96 == GF.pow(gf, 35, -3)
    assert 15 == GF.pow(gf, 35, -2)
    assert 31 == GF.pow(gf, 35, -1)
    assert 1 == GF.pow(gf, 35, 0)
    assert 35 == GF.pow(gf, 35, 1)
    assert 28 == GF.pow(gf, 35, 2)
    assert 6 == GF.pow(gf, 102, -3)
    assert 100 == GF.pow(gf, 102, -2)
    assert 10 == GF.pow(gf, 102, -1)
    assert 1 == GF.pow(gf, 102, 0)
    assert 102 == GF.pow(gf, 102, 1)
    assert 89 == GF.pow(gf, 102, 2)
    assert 57 == GF.pow(gf, 16, -3)
    assert 24 == GF.pow(gf, 16, -2)
    assert 59 == GF.pow(gf, 16, -1)
    assert 1 == GF.pow(gf, 16, 0)
    assert 16 == GF.pow(gf, 16, 1)
    assert 106 == GF.pow(gf, 16, 2)
    assert 110 == GF.pow(gf, 64, -3)
    assert 44 == GF.pow(gf, 64, -2)
    assert 52 == GF.pow(gf, 64, -1)
    assert 1 == GF.pow(gf, 64, 0)
    assert 64 == GF.pow(gf, 64, 1)
    assert 77 == GF.pow(gf, 64, 2)
    assert 88 == GF.pow(gf, 117, -3)
    assert 80 == GF.pow(gf, 117, -2)
    assert 86 == GF.pow(gf, 117, -1)
    assert 1 == GF.pow(gf, 117, 0)
    assert 117 == GF.pow(gf, 117, 1)
    assert 62 == GF.pow(gf, 117, 2)
    assert 54 == GF.pow(gf, 75, -3)
    assert 110 == GF.pow(gf, 75, -2)
    assert 107 == GF.pow(gf, 75, -1)
    assert 1 == GF.pow(gf, 75, 0)
    assert 75 == GF.pow(gf, 75, 1)
    assert 90 == GF.pow(gf, 75, 2)
    assert 46 == GF.pow(gf, 84, -3)
    assert 70 == GF.pow(gf, 84, -2)
    assert 108 == GF.pow(gf, 84, -1)
    assert 1 == GF.pow(gf, 84, 0)
    assert 84 == GF.pow(gf, 84, 1)
    assert 93 == GF.pow(gf, 84, 2)
    assert 69 == GF.pow(gf, 29, -3)
    assert 37 == GF.pow(gf, 29, -2)
    assert 97 == GF.pow(gf, 29, -1)
    assert 1 == GF.pow(gf, 29, 0)
    assert 29 == GF.pow(gf, 29, 1)
    assert 11 == GF.pow(gf, 29, 2)
    assert 13 == GF.pow(gf, 46, -3)
    assert 42 == GF.pow(gf, 46, -2)
    assert 61 == GF.pow(gf, 46, -1)
    assert 1 == GF.pow(gf, 46, 0)
    assert 46 == GF.pow(gf, 46, 1)
    assert 7 == GF.pow(gf, 46, 2)
    assert 23 == GF.pow(gf, 62, -3)
    assert 102 == GF.pow(gf, 62, -2)
    assert 80 == GF.pow(gf, 62, -1)
    assert 1 == GF.pow(gf, 62, 0)
    assert 62 == GF.pow(gf, 62, 1)
    assert 10 == GF.pow(gf, 62, 2)
    assert 53 == GF.pow(gf, 119, -3)
    assert 39 == GF.pow(gf, 119, -2)
    assert 103 == GF.pow(gf, 119, -1)
    assert 1 == GF.pow(gf, 119, 0)
    assert 119 == GF.pow(gf, 119, 1)
    assert 99 == GF.pow(gf, 119, 2)
    assert 34 == GF.pow(gf, 61, -3)
    assert 7 == GF.pow(gf, 61, -2)
    assert 46 == GF.pow(gf, 61, -1)
    assert 1 == GF.pow(gf, 61, 0)
    assert 61 == GF.pow(gf, 61, 1)
    assert 42 == GF.pow(gf, 61, 2)
    assert 32 == GF.pow(gf, 12, -3)
    assert 103 == GF.pow(gf, 12, -2)
    assert 87 == GF.pow(gf, 12, -1)
    assert 1 == GF.pow(gf, 12, 0)
    assert 12 == GF.pow(gf, 12, 1)
    assert 119 == GF.pow(gf, 12, 2)
    assert 45 == GF.pow(gf, 42, -3)
    assert 49 == GF.pow(gf, 42, -2)
    assert 7 == GF.pow(gf, 42, -1)
    assert 1 == GF.pow(gf, 42, 0)
    assert 42 == GF.pow(gf, 42, 1)
    assert 6 == GF.pow(gf, 42, 2)
    assert 52 == GF.pow(gf, 106, -3)
    assert 36 == GF.pow(gf, 106, -2)
    assert 24 == GF.pow(gf, 106, -1)
    assert 1 == GF.pow(gf, 106, 0)
    assert 106 == GF.pow(gf, 106, 1)
    assert 27 == GF.pow(gf, 106, 2)
    assert 101 == GF.pow(gf, 83, -3)
    assert 116 == GF.pow(gf, 83, -2)
    assert 54 == GF.pow(gf, 83, -1)
    assert 1 == GF.pow(gf, 83, 0)
    assert 83 == GF.pow(gf, 83, 1)
    assert 56 == GF.pow(gf, 83, 2)
    assert 63 == GF.pow(gf, 122, -3)
    assert 23 == GF.pow(gf, 122, -2)
    assert 88 == GF.pow(gf, 122, -1)
    assert 1 == GF.pow(gf, 122, 0)
    assert 122 == GF.pow(gf, 122, 1)
    assert 113 == GF.pow(gf, 122, 2)
    assert 34 == GF.pow(gf, 61, -3)
    assert 7 == GF.pow(gf, 61, -2)
    assert 46 == GF.pow(gf, 61, -1)
    assert 1 == GF.pow(gf, 61, 0)
    assert 61 == GF.pow(gf, 61, 1)
    assert 42 == GF.pow(gf, 61, 2)
    assert 43 == GF.pow(gf, 55, -3)
    assert 84 == GF.pow(gf, 55, -2)
    assert 30 == GF.pow(gf, 55, -1)
    assert 1 == GF.pow(gf, 55, 0)
    assert 55 == GF.pow(gf, 55, 1)
    assert 108 == GF.pow(gf, 55, 2)
    assert 50 == GF.pow(gf, 57, -3)
    assert 64 == GF.pow(gf, 57, -2)
    assert 65 == GF.pow(gf, 57, -1)
    assert 1 == GF.pow(gf, 57, 0)
    assert 57 == GF.pow(gf, 57, 1)
    assert 52 == GF.pow(gf, 57, 2)
    assert 30 == GF.pow(gf, 104, -3)
    assert 53 == GF.pow(gf, 104, -2)
    assert 32 == GF.pow(gf, 104, -1)
    assert 1 == GF.pow(gf, 104, 0)
    assert 104 == GF.pow(gf, 104, 1)
    assert 111 == GF.pow(gf, 104, 2)
    assert 67 == GF.pow(gf, 38, -3)
    assert 80 == GF.pow(gf, 38, -2)
    assert 69 == GF.pow(gf, 38, -1)
    assert 1 == GF.pow(gf, 38, 0)
    assert 38 == GF.pow(gf, 38, 1)
    assert 62 == GF.pow(gf, 38, 2)
    assert 83 == GF.pow(gf, 107, -3)
    assert 90 == GF.pow(gf, 107, -2)
    assert 75 == GF.pow(gf, 107, -1)
    assert 1 == GF.pow(gf, 107, 0)
    assert 107 == GF.pow(gf, 107, 1)
    assert 110 == GF.pow(gf, 107, 2)
    assert 29 == GF.pow(gf, 72, -3)
    assert 116 == GF.pow(gf, 72, -2)
    assert 76 == GF.pow(gf, 72, -1)
    assert 1 == GF.pow(gf, 72, 0)
    assert 72 == GF.pow(gf, 72, 1)
    assert 56 == GF.pow(gf, 72, 2)
    assert 32 == GF.pow(gf, 12, -3)
    assert 103 == GF.pow(gf, 12, -2)
    assert 87 == GF.pow(gf, 12, -1)
    assert 1 == GF.pow(gf, 12, 0)
    assert 12 == GF.pow(gf, 12, 1)
    assert 119 == GF.pow(gf, 12, 2)
    assert 124 == GF.pow(gf, 74, -3)
    assert 34 == GF.pow(gf, 74, -2)
    assert 8 == GF.pow(gf, 74, -1)
    assert 1 == GF.pow(gf, 74, 0)
    assert 74 == GF.pow(gf, 74, 1)
    assert 13 == GF.pow(gf, 74, 2)
    assert 85 == GF.pow(gf, 96, -3)
    assert 106 == GF.pow(gf, 96, -2)
    assert 14 == GF.pow(gf, 96, -1)
    assert 1 == GF.pow(gf, 96, 0)
    assert 96 == GF.pow(gf, 96, 1)
    assert 24 == GF.pow(gf, 96, 2)
    assert 9 == GF.pow(gf, 88, -3)
    assert 113 == GF.pow(gf, 88, -2)
    assert 122 == GF.pow(gf, 88, -1)
    assert 1 == GF.pow(gf, 88, 0)
    assert 88 == GF.pow(gf, 88, 1)
    assert 23 == GF.pow(gf, 88, 2)
    assert 31 == GF.pow(gf, 81, -3)
    assert 34 == GF.pow(gf, 81, -2)
    assert 22 == GF.pow(gf, 81, -1)
    assert 1 == GF.pow(gf, 81, 0)
    assert 81 == GF.pow(gf, 81, 1)
    assert 13 == GF.pow(gf, 81, 2)
  end

  @tag :gen_test_pow
  test "GF(7, 1) pow" do
    gf = GF.new(7, 1, [4,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 1 == GF.pow(gf, 2, -3)
    assert 2 == GF.pow(gf, 2, -2)
    assert 4 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 4 == GF.pow(gf, 2, 2)
    assert 6 == GF.pow(gf, 3, -3)
    assert 4 == GF.pow(gf, 3, -2)
    assert 5 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 2 == GF.pow(gf, 3, 2)
    assert 1 == GF.pow(gf, 4, -3)
    assert 4 == GF.pow(gf, 4, -2)
    assert 2 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 2 == GF.pow(gf, 4, 2)
    assert 6 == GF.pow(gf, 5, -3)
    assert 2 == GF.pow(gf, 5, -2)
    assert 3 == GF.pow(gf, 5, -1)
    assert 1 == GF.pow(gf, 5, 0)
    assert 5 == GF.pow(gf, 5, 1)
    assert 4 == GF.pow(gf, 5, 2)
    assert 6 == GF.pow(gf, 6, -3)
    assert 1 == GF.pow(gf, 6, -2)
    assert 6 == GF.pow(gf, 6, -1)
    assert 1 == GF.pow(gf, 6, 0)
    assert 6 == GF.pow(gf, 6, 1)
    assert 1 == GF.pow(gf, 6, 2)
  end

  @tag :gen_test_pow
  test "GF(7, 2) pow" do
    gf = GF.new(7, 2, [3,6,1])
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 1 == GF.pow(gf, 2, -3)
    assert 2 == GF.pow(gf, 2, -2)
    assert 4 == GF.pow(gf, 2, -1)
    assert 1 == GF.pow(gf, 2, 0)
    assert 2 == GF.pow(gf, 2, 1)
    assert 4 == GF.pow(gf, 2, 2)
    assert 6 == GF.pow(gf, 3, -3)
    assert 4 == GF.pow(gf, 3, -2)
    assert 5 == GF.pow(gf, 3, -1)
    assert 1 == GF.pow(gf, 3, 0)
    assert 3 == GF.pow(gf, 3, 1)
    assert 2 == GF.pow(gf, 3, 2)
    assert 1 == GF.pow(gf, 4, -3)
    assert 4 == GF.pow(gf, 4, -2)
    assert 2 == GF.pow(gf, 4, -1)
    assert 1 == GF.pow(gf, 4, 0)
    assert 4 == GF.pow(gf, 4, 1)
    assert 2 == GF.pow(gf, 4, 2)
    assert 6 == GF.pow(gf, 5, -3)
    assert 2 == GF.pow(gf, 5, -2)
    assert 3 == GF.pow(gf, 5, -1)
    assert 1 == GF.pow(gf, 5, 0)
    assert 5 == GF.pow(gf, 5, 1)
    assert 4 == GF.pow(gf, 5, 2)
    assert 6 == GF.pow(gf, 6, -3)
    assert 1 == GF.pow(gf, 6, -2)
    assert 6 == GF.pow(gf, 6, -1)
    assert 1 == GF.pow(gf, 6, 0)
    assert 6 == GF.pow(gf, 6, 1)
    assert 1 == GF.pow(gf, 6, 2)
    assert 40 == GF.pow(gf, 7, -3)
    assert 27 == GF.pow(gf, 7, -2)
    assert 19 == GF.pow(gf, 7, -1)
    assert 1 == GF.pow(gf, 7, 0)
    assert 7 == GF.pow(gf, 7, 1)
    assert 11 == GF.pow(gf, 7, 2)
    assert 28 == GF.pow(gf, 8, -3)
    assert 9 == GF.pow(gf, 8, -2)
    assert 34 == GF.pow(gf, 8, -1)
    assert 1 == GF.pow(gf, 8, 0)
    assert 8 == GF.pow(gf, 8, 1)
    assert 26 == GF.pow(gf, 8, 2)
    assert 38 == GF.pow(gf, 9, -3)
    assert 33 == GF.pow(gf, 9, -2)
    assert 26 == GF.pow(gf, 9, -1)
    assert 1 == GF.pow(gf, 9, 0)
    assert 9 == GF.pow(gf, 9, 1)
    assert 36 == GF.pow(gf, 9, 2)
    assert 10 == GF.pow(gf, 10, -3)
    assert 6 == GF.pow(gf, 10, -2)
    assert 46 == GF.pow(gf, 10, -1)
    assert 1 == GF.pow(gf, 10, 0)
    assert 10 == GF.pow(gf, 10, 1)
    assert 6 == GF.pow(gf, 10, 2)
    assert 41 == GF.pow(gf, 11, -3)
    assert 23 == GF.pow(gf, 11, -2)
    assert 27 == GF.pow(gf, 11, -1)
    assert 1 == GF.pow(gf, 11, 0)
    assert 11 == GF.pow(gf, 11, 1)
    assert 20 == GF.pow(gf, 11, 2)
    assert 31 == GF.pow(gf, 12, -3)
    assert 45 == GF.pow(gf, 12, -2)
    assert 32 == GF.pow(gf, 12, -1)
    assert 1 == GF.pow(gf, 12, 0)
    assert 12 == GF.pow(gf, 12, 1)
    assert 29 == GF.pow(gf, 12, 2)
    assert 39 == GF.pow(gf, 13, -3)
    assert 30 == GF.pow(gf, 13, -2)
    assert 14 == GF.pow(gf, 13, -1)
    assert 1 == GF.pow(gf, 13, 0)
    assert 13 == GF.pow(gf, 13, 1)
    assert 47 == GF.pow(gf, 13, 2)
    assert 40 == GF.pow(gf, 14, -3)
    assert 47 == GF.pow(gf, 14, -2)
    assert 13 == GF.pow(gf, 14, -1)
    assert 1 == GF.pow(gf, 14, 0)
    assert 14 == GF.pow(gf, 14, 1)
    assert 30 == GF.pow(gf, 14, 2)
    assert 41 == GF.pow(gf, 15, -3)
    assert 46 == GF.pow(gf, 15, -2)
    assert 38 == GF.pow(gf, 15, -1)
    assert 1 == GF.pow(gf, 15, 0)
    assert 15 == GF.pow(gf, 15, 1)
    assert 10 == GF.pow(gf, 15, 2)
    assert 28 == GF.pow(gf, 16, -3)
    assert 18 == GF.pow(gf, 16, -2)
    assert 17 == GF.pow(gf, 16, -1)
    assert 1 == GF.pow(gf, 16, 0)
    assert 16 == GF.pow(gf, 16, 1)
    assert 41 == GF.pow(gf, 16, 2)
    assert 31 == GF.pow(gf, 17, -3)
    assert 41 == GF.pow(gf, 17, -2)
    assert 16 == GF.pow(gf, 17, -1)
    assert 1 == GF.pow(gf, 17, 0)
    assert 17 == GF.pow(gf, 17, 1)
    assert 18 == GF.pow(gf, 17, 2)
    assert 38 == GF.pow(gf, 18, -3)
    assert 10 == GF.pow(gf, 18, -2)
    assert 41 == GF.pow(gf, 18, -1)
    assert 1 == GF.pow(gf, 18, 0)
    assert 18 == GF.pow(gf, 18, 1)
    assert 46 == GF.pow(gf, 18, 2)
    assert 39 == GF.pow(gf, 19, -3)
    assert 11 == GF.pow(gf, 19, -2)
    assert 7 == GF.pow(gf, 19, -1)
    assert 1 == GF.pow(gf, 19, 0)
    assert 19 == GF.pow(gf, 19, 1)
    assert 27 == GF.pow(gf, 19, 2)
    assert 10 == GF.pow(gf, 20, -3)
    assert 5 == GF.pow(gf, 20, -2)
    assert 23 == GF.pow(gf, 20, -1)
    assert 1 == GF.pow(gf, 20, 0)
    assert 20 == GF.pow(gf, 20, 1)
    assert 3 == GF.pow(gf, 20, 2)
    assert 16 == GF.pow(gf, 21, -3)
    assert 38 == GF.pow(gf, 21, -2)
    assert 25 == GF.pow(gf, 21, -1)
    assert 1 == GF.pow(gf, 21, 0)
    assert 21 == GF.pow(gf, 21, 1)
    assert 15 == GF.pow(gf, 21, 2)
    assert 25 == GF.pow(gf, 22, -3)
    assert 26 == GF.pow(gf, 22, -2)
    assert 48 == GF.pow(gf, 22, -1)
    assert 1 == GF.pow(gf, 22, 0)
    assert 22 == GF.pow(gf, 22, 1)
    assert 9 == GF.pow(gf, 22, 2)
    assert 46 == GF.pow(gf, 23, -3)
    assert 3 == GF.pow(gf, 23, -2)
    assert 20 == GF.pow(gf, 23, -1)
    assert 1 == GF.pow(gf, 23, 0)
    assert 23 == GF.pow(gf, 23, 1)
    assert 5 == GF.pow(gf, 23, 2)
    assert 21 == GF.pow(gf, 24, -3)
    assert 29 == GF.pow(gf, 24, -2)
    assert 44 == GF.pow(gf, 24, -1)
    assert 1 == GF.pow(gf, 24, 0)
    assert 24 == GF.pow(gf, 24, 1)
    assert 45 == GF.pow(gf, 24, 2)
    assert 17 == GF.pow(gf, 25, -3)
    assert 15 == GF.pow(gf, 25, -2)
    assert 21 == GF.pow(gf, 25, -1)
    assert 1 == GF.pow(gf, 25, 0)
    assert 25 == GF.pow(gf, 25, 1)
    assert 38 == GF.pow(gf, 25, 2)
    assert 15 == GF.pow(gf, 26, -3)
    assert 36 == GF.pow(gf, 26, -2)
    assert 9 == GF.pow(gf, 26, -1)
    assert 1 == GF.pow(gf, 26, 0)
    assert 26 == GF.pow(gf, 26, 1)
    assert 33 == GF.pow(gf, 26, 2)
    assert 18 == GF.pow(gf, 27, -3)
    assert 20 == GF.pow(gf, 27, -2)
    assert 11 == GF.pow(gf, 27, -1)
    assert 1 == GF.pow(gf, 27, 0)
    assert 27 == GF.pow(gf, 27, 1)
    assert 23 == GF.pow(gf, 27, 2)
    assert 40 == GF.pow(gf, 28, -3)
    assert 38 == GF.pow(gf, 28, -2)
    assert 31 == GF.pow(gf, 28, -1)
    assert 1 == GF.pow(gf, 28, 0)
    assert 28 == GF.pow(gf, 28, 1)
    assert 15 == GF.pow(gf, 28, 2)
    assert 38 == GF.pow(gf, 29, -3)
    assert 20 == GF.pow(gf, 29, -2)
    assert 45 == GF.pow(gf, 29, -1)
    assert 1 == GF.pow(gf, 29, 0)
    assert 29 == GF.pow(gf, 29, 1)
    assert 23 == GF.pow(gf, 29, 2)
    assert 41 == GF.pow(gf, 30, -3)
    assert 36 == GF.pow(gf, 30, -2)
    assert 47 == GF.pow(gf, 30, -1)
    assert 1 == GF.pow(gf, 30, 0)
    assert 30 == GF.pow(gf, 30, 1)
    assert 33 == GF.pow(gf, 30, 2)
    assert 39 == GF.pow(gf, 31, -3)
    assert 15 == GF.pow(gf, 31, -2)
    assert 28 == GF.pow(gf, 31, -1)
    assert 1 == GF.pow(gf, 31, 0)
    assert 31 == GF.pow(gf, 31, 1)
    assert 38 == GF.pow(gf, 31, 2)
    assert 28 == GF.pow(gf, 32, -3)
    assert 29 == GF.pow(gf, 32, -2)
    assert 12 == GF.pow(gf, 32, -1)
    assert 1 == GF.pow(gf, 32, 0)
    assert 32 == GF.pow(gf, 32, 1)
    assert 45 == GF.pow(gf, 32, 2)
    assert 10 == GF.pow(gf, 33, -3)
    assert 3 == GF.pow(gf, 33, -2)
    assert 36 == GF.pow(gf, 33, -1)
    assert 1 == GF.pow(gf, 33, 0)
    assert 33 == GF.pow(gf, 33, 1)
    assert 5 == GF.pow(gf, 33, 2)
    assert 31 == GF.pow(gf, 34, -3)
    assert 26 == GF.pow(gf, 34, -2)
    assert 8 == GF.pow(gf, 34, -1)
    assert 1 == GF.pow(gf, 34, 0)
    assert 34 == GF.pow(gf, 34, 1)
    assert 9 == GF.pow(gf, 34, 2)
    assert 16 == GF.pow(gf, 35, -3)
    assert 47 == GF.pow(gf, 35, -2)
    assert 43 == GF.pow(gf, 35, -1)
    assert 1 == GF.pow(gf, 35, 0)
    assert 35 == GF.pow(gf, 35, 1)
    assert 30 == GF.pow(gf, 35, 2)
    assert 46 == GF.pow(gf, 36, -3)
    assert 5 == GF.pow(gf, 36, -2)
    assert 33 == GF.pow(gf, 36, -1)
    assert 1 == GF.pow(gf, 36, 0)
    assert 36 == GF.pow(gf, 36, 1)
    assert 3 == GF.pow(gf, 36, 2)
    assert 17 == GF.pow(gf, 37, -3)
    assert 11 == GF.pow(gf, 37, -2)
    assert 42 == GF.pow(gf, 37, -1)
    assert 1 == GF.pow(gf, 37, 0)
    assert 37 == GF.pow(gf, 37, 1)
    assert 27 == GF.pow(gf, 37, 2)
    assert 18 == GF.pow(gf, 38, -3)
    assert 10 == GF.pow(gf, 38, -2)
    assert 15 == GF.pow(gf, 38, -1)
    assert 1 == GF.pow(gf, 38, 0)
    assert 38 == GF.pow(gf, 38, 1)
    assert 46 == GF.pow(gf, 38, 2)
    assert 25 == GF.pow(gf, 39, -3)
    assert 41 == GF.pow(gf, 39, -2)
    assert 40 == GF.pow(gf, 39, -1)
    assert 1 == GF.pow(gf, 39, 0)
    assert 39 == GF.pow(gf, 39, 1)
    assert 18 == GF.pow(gf, 39, 2)
    assert 21 == GF.pow(gf, 40, -3)
    assert 18 == GF.pow(gf, 40, -2)
    assert 39 == GF.pow(gf, 40, -1)
    assert 1 == GF.pow(gf, 40, 0)
    assert 40 == GF.pow(gf, 40, 1)
    assert 41 == GF.pow(gf, 40, 2)
    assert 15 == GF.pow(gf, 41, -3)
    assert 46 == GF.pow(gf, 41, -2)
    assert 18 == GF.pow(gf, 41, -1)
    assert 1 == GF.pow(gf, 41, 0)
    assert 41 == GF.pow(gf, 41, 1)
    assert 10 == GF.pow(gf, 41, 2)
    assert 16 == GF.pow(gf, 42, -3)
    assert 27 == GF.pow(gf, 42, -2)
    assert 37 == GF.pow(gf, 42, -1)
    assert 1 == GF.pow(gf, 42, 0)
    assert 42 == GF.pow(gf, 42, 1)
    assert 11 == GF.pow(gf, 42, 2)
    assert 17 == GF.pow(gf, 43, -3)
    assert 30 == GF.pow(gf, 43, -2)
    assert 35 == GF.pow(gf, 43, -1)
    assert 1 == GF.pow(gf, 43, 0)
    assert 43 == GF.pow(gf, 43, 1)
    assert 47 == GF.pow(gf, 43, 2)
    assert 25 == GF.pow(gf, 44, -3)
    assert 45 == GF.pow(gf, 44, -2)
    assert 24 == GF.pow(gf, 44, -1)
    assert 1 == GF.pow(gf, 44, 0)
    assert 44 == GF.pow(gf, 44, 1)
    assert 29 == GF.pow(gf, 44, 2)
    assert 15 == GF.pow(gf, 45, -3)
    assert 23 == GF.pow(gf, 45, -2)
    assert 29 == GF.pow(gf, 45, -1)
    assert 1 == GF.pow(gf, 45, 0)
    assert 45 == GF.pow(gf, 45, 1)
    assert 20 == GF.pow(gf, 45, 2)
    assert 46 == GF.pow(gf, 46, -3)
    assert 6 == GF.pow(gf, 46, -2)
    assert 10 == GF.pow(gf, 46, -1)
    assert 1 == GF.pow(gf, 46, 0)
    assert 46 == GF.pow(gf, 46, 1)
    assert 6 == GF.pow(gf, 46, 2)
    assert 18 == GF.pow(gf, 47, -3)
    assert 33 == GF.pow(gf, 47, -2)
    assert 30 == GF.pow(gf, 47, -1)
    assert 1 == GF.pow(gf, 47, 0)
    assert 47 == GF.pow(gf, 47, 1)
    assert 36 == GF.pow(gf, 47, 2)
    assert 21 == GF.pow(gf, 48, -3)
    assert 9 == GF.pow(gf, 48, -2)
    assert 22 == GF.pow(gf, 48, -1)
    assert 1 == GF.pow(gf, 48, 0)
    assert 48 == GF.pow(gf, 48, 1)
    assert 26 == GF.pow(gf, 48, 2)
  end

  @tag :gen_test_pow
  test "GF(7, 3) pow" do
    gf = GF.new(7, 3, [4,0,6,1])
    assert 295 == GF.pow(gf, 317, -3)
    assert 143 == GF.pow(gf, 317, -2)
    assert 154 == GF.pow(gf, 317, -1)
    assert 1 == GF.pow(gf, 317, 0)
    assert 317 == GF.pow(gf, 317, 1)
    assert 10 == GF.pow(gf, 317, 2)
    assert 206 == GF.pow(gf, 307, -3)
    assert 29 == GF.pow(gf, 307, -2)
    assert 323 == GF.pow(gf, 307, -1)
    assert 1 == GF.pow(gf, 307, 0)
    assert 307 == GF.pow(gf, 307, 1)
    assert 110 == GF.pow(gf, 307, 2)
    assert 209 == GF.pow(gf, 181, -3)
    assert 24 == GF.pow(gf, 181, -2)
    assert 115 == GF.pow(gf, 181, -1)
    assert 1 == GF.pow(gf, 181, 0)
    assert 181 == GF.pow(gf, 181, 1)
    assert 86 == GF.pow(gf, 181, 2)
    assert 58 == GF.pow(gf, 337, -3)
    assert 119 == GF.pow(gf, 337, -2)
    assert 322 == GF.pow(gf, 337, -1)
    assert 1 == GF.pow(gf, 337, 0)
    assert 337 == GF.pow(gf, 337, 1)
    assert 108 == GF.pow(gf, 337, 2)
    assert 221 == GF.pow(gf, 160, -3)
    assert 64 == GF.pow(gf, 160, -2)
    assert 8 == GF.pow(gf, 160, -1)
    assert 1 == GF.pow(gf, 160, 0)
    assert 160 == GF.pow(gf, 160, 1)
    assert 179 == GF.pow(gf, 160, 2)
    assert 246 == GF.pow(gf, 229, -3)
    assert 307 == GF.pow(gf, 229, -2)
    assert 270 == GF.pow(gf, 229, -1)
    assert 1 == GF.pow(gf, 229, 0)
    assert 229 == GF.pow(gf, 229, 1)
    assert 323 == GF.pow(gf, 229, 2)
    assert 68 == GF.pow(gf, 11, -3)
    assert 44 == GF.pow(gf, 11, -2)
    assert 330 == GF.pow(gf, 11, -1)
    assert 1 == GF.pow(gf, 11, 0)
    assert 11 == GF.pow(gf, 11, 1)
    assert 58 == GF.pow(gf, 11, 2)
    assert 318 == GF.pow(gf, 208, -3)
    assert 190 == GF.pow(gf, 208, -2)
    assert 80 == GF.pow(gf, 208, -1)
    assert 1 == GF.pow(gf, 208, 0)
    assert 208 == GF.pow(gf, 208, 1)
    assert 118 == GF.pow(gf, 208, 2)
    assert 212 == GF.pow(gf, 99, -3)
    assert 332 == GF.pow(gf, 99, -2)
    assert 342 == GF.pow(gf, 99, -1)
    assert 1 == GF.pow(gf, 99, 0)
    assert 99 == GF.pow(gf, 99, 1)
    assert 90 == GF.pow(gf, 99, 2)
    assert 74 == GF.pow(gf, 238, -3)
    assert 10 == GF.pow(gf, 238, -2)
    assert 82 == GF.pow(gf, 238, -1)
    assert 1 == GF.pow(gf, 238, 0)
    assert 238 == GF.pow(gf, 238, 1)
    assert 143 == GF.pow(gf, 238, 2)
    assert 340 == GF.pow(gf, 268, -3)
    assert 116 == GF.pow(gf, 268, -2)
    assert 30 == GF.pow(gf, 268, -1)
    assert 1 == GF.pow(gf, 268, 0)
    assert 268 == GF.pow(gf, 268, 1)
    assert 22 == GF.pow(gf, 268, 2)
    assert 131 == GF.pow(gf, 49, -3)
    assert 242 == GF.pow(gf, 49, -2)
    assert 37 == GF.pow(gf, 49, -1)
    assert 1 == GF.pow(gf, 49, 0)
    assert 49 == GF.pow(gf, 49, 1)
    assert 73 == GF.pow(gf, 49, 2)
    assert 12 == GF.pow(gf, 70, -3)
    assert 108 == GF.pow(gf, 70, -2)
    assert 62 == GF.pow(gf, 70, -1)
    assert 1 == GF.pow(gf, 70, 0)
    assert 70 == GF.pow(gf, 70, 1)
    assert 119 == GF.pow(gf, 70, 2)
    assert 331 == GF.pow(gf, 41, -3)
    assert 39 == GF.pow(gf, 41, -2)
    assert 206 == GF.pow(gf, 41, -1)
    assert 1 == GF.pow(gf, 41, 0)
    assert 41 == GF.pow(gf, 41, 1)
    assert 225 == GF.pow(gf, 41, 2)
    assert 331 == GF.pow(gf, 26, -3)
    assert 22 == GF.pow(gf, 26, -2)
    assert 131 == GF.pow(gf, 26, -1)
    assert 1 == GF.pow(gf, 26, 0)
    assert 26 == GF.pow(gf, 26, 1)
    assert 116 == GF.pow(gf, 26, 2)
    assert 110 == GF.pow(gf, 79, -3)
    assert 148 == GF.pow(gf, 79, -2)
    assert 96 == GF.pow(gf, 79, -1)
    assert 1 == GF.pow(gf, 79, 0)
    assert 79 == GF.pow(gf, 79, 1)
    assert 87 == GF.pow(gf, 79, 2)
    assert 316 == GF.pow(gf, 151, -3)
    assert 267 == GF.pow(gf, 151, -2)
    assert 258 == GF.pow(gf, 151, -1)
    assert 1 == GF.pow(gf, 151, 0)
    assert 151 == GF.pow(gf, 151, 1)
    assert 288 == GF.pow(gf, 151, 2)
    assert 208 == GF.pow(gf, 324, -3)
    assert 218 == GF.pow(gf, 324, -2)
    assert 36 == GF.pow(gf, 324, -1)
    assert 1 == GF.pow(gf, 324, 0)
    assert 324 == GF.pow(gf, 324, 1)
    assert 284 == GF.pow(gf, 324, 2)
    assert 58 == GF.pow(gf, 172, -3)
    assert 84 == GF.pow(gf, 172, -2)
    assert 252 == GF.pow(gf, 172, -1)
    assert 1 == GF.pow(gf, 172, 0)
    assert 172 == GF.pow(gf, 172, 1)
    assert 216 == GF.pow(gf, 172, 2)
    assert 1 == GF.pow(gf, 1, -3)
    assert 1 == GF.pow(gf, 1, -2)
    assert 1 == GF.pow(gf, 1, -1)
    assert 1 == GF.pow(gf, 1, 0)
    assert 1 == GF.pow(gf, 1, 1)
    assert 1 == GF.pow(gf, 1, 2)
    assert 341 == GF.pow(gf, 62, -3)
    assert 119 == GF.pow(gf, 62, -2)
    assert 70 == GF.pow(gf, 62, -1)
    assert 1 == GF.pow(gf, 62, 0)
    assert 62 == GF.pow(gf, 62, 1)
    assert 108 == GF.pow(gf, 62, 2)
    assert 118 == GF.pow(gf, 169, -3)
    assert 123 == GF.pow(gf, 169, -2)
    assert 137 == GF.pow(gf, 169, -1)
    assert 1 == GF.pow(gf, 169, 0)
    assert 169 == GF.pow(gf, 169, 1)
    assert 40 == GF.pow(gf, 169, 2)
    assert 151 == GF.pow(gf, 65, -3)
    assert 266 == GF.pow(gf, 65, -2)
    assert 299 == GF.pow(gf, 65, -1)
    assert 1 == GF.pow(gf, 65, 0)
    assert 65 == GF.pow(gf, 65, 1)
    assert 327 == GF.pow(gf, 65, 2)
    assert 39 == GF.pow(gf, 213, -3)
    assert 212 == GF.pow(gf, 213, -2)
    assert 18 == GF.pow(gf, 213, -1)
    assert 1 == GF.pow(gf, 213, 0)
    assert 213 == GF.pow(gf, 213, 1)
    assert 224 == GF.pow(gf, 213, 2)
    assert 55 == GF.pow(gf, 82, -3)
    assert 143 == GF.pow(gf, 82, -2)
    assert 238 == GF.pow(gf, 82, -1)
    assert 1 == GF.pow(gf, 82, 0)
    assert 82 == GF.pow(gf, 82, 1)
    assert 10 == GF.pow(gf, 82, 2)
    assert 283 == GF.pow(gf, 314, -3)
    assert 102 == GF.pow(gf, 314, -2)
    assert 163 == GF.pow(gf, 314, -1)
    assert 1 == GF.pow(gf, 314, 0)
    assert 314 == GF.pow(gf, 314, 1)
    assert 195 == GF.pow(gf, 314, 2)
    assert 319 == GF.pow(gf, 20, -3)
    assert 284 == GF.pow(gf, 20, -2)
    assert 75 == GF.pow(gf, 20, -1)
    assert 1 == GF.pow(gf, 20, 0)
    assert 20 == GF.pow(gf, 20, 1)
    assert 218 == GF.pow(gf, 20, 2)
    assert 229 == GF.pow(gf, 88, -3)
    assert 328 == GF.pow(gf, 88, -2)
    assert 305 == GF.pow(gf, 88, -1)
    assert 1 == GF.pow(gf, 88, 0)
    assert 88 == GF.pow(gf, 88, 1)
    assert 105 == GF.pow(gf, 88, 2)
    assert 307 == GF.pow(gf, 328, -3)
    assert 136 == GF.pow(gf, 328, -2)
    assert 105 == GF.pow(gf, 328, -1)
    assert 1 == GF.pow(gf, 328, 0)
    assert 328 == GF.pow(gf, 328, 1)
    assert 211 == GF.pow(gf, 328, 2)
    assert 258 == GF.pow(gf, 153, -3)
    assert 167 == GF.pow(gf, 153, -2)
    assert 130 == GF.pow(gf, 153, -1)
    assert 1 == GF.pow(gf, 153, 0)
    assert 153 == GF.pow(gf, 153, 1)
    assert 189 == GF.pow(gf, 153, 2)
    assert 3 == GF.pow(gf, 173, -3)
    assert 113 == GF.pow(gf, 173, -2)
    assert 122 == GF.pow(gf, 173, -1)
    assert 1 == GF.pow(gf, 173, 0)
    assert 173 == GF.pow(gf, 173, 1)
    assert 155 == GF.pow(gf, 173, 2)
    assert 293 == GF.pow(gf, 54, -3)
    assert 21 == GF.pow(gf, 54, -2)
    assert 156 == GF.pow(gf, 54, -1)
    assert 1 == GF.pow(gf, 54, 0)
    assert 54 == GF.pow(gf, 54, 1)
    assert 217 == GF.pow(gf, 54, 2)
    assert 325 == GF.pow(gf, 154, -3)
    assert 10 == GF.pow(gf, 154, -2)
    assert 317 == GF.pow(gf, 154, -1)
    assert 1 == GF.pow(gf, 154, 0)
    assert 154 == GF.pow(gf, 154, 1)
    assert 143 == GF.pow(gf, 154, 2)
    assert 268 == GF.pow(gf, 147, -3)
    assert 121 == GF.pow(gf, 147, -2)
    assert 31 == GF.pow(gf, 147, -1)
    assert 1 == GF.pow(gf, 147, 0)
    assert 147 == GF.pow(gf, 147, 1)
    assert 146 == GF.pow(gf, 147, 2)
    assert 283 == GF.pow(gf, 157, -3)
    assert 51 == GF.pow(gf, 157, -2)
    assert 326 == GF.pow(gf, 157, -1)
    assert 1 == GF.pow(gf, 157, 0)
    assert 157 == GF.pow(gf, 157, 1)
    assert 334 == GF.pow(gf, 157, 2)
    assert 246 == GF.pow(gf, 118, -3)
    assert 178 == GF.pow(gf, 118, -2)
    assert 190 == GF.pow(gf, 118, -1)
    assert 1 == GF.pow(gf, 118, 0)
    assert 118 == GF.pow(gf, 118, 1)
    assert 254 == GF.pow(gf, 118, 2)
    assert 333 == GF.pow(gf, 134, -3)
    assert 41 == GF.pow(gf, 134, -2)
    assert 246 == GF.pow(gf, 134, -1)
    assert 1 == GF.pow(gf, 134, 0)
    assert 134 == GF.pow(gf, 134, 1)
    assert 206 == GF.pow(gf, 134, 2)
    assert 116 == GF.pow(gf, 121, -3)
    assert 197 == GF.pow(gf, 121, -2)
    assert 146 == GF.pow(gf, 121, -1)
    assert 1 == GF.pow(gf, 121, 0)
    assert 121 == GF.pow(gf, 121, 1)
    assert 269 == GF.pow(gf, 121, 2)
    assert 201 == GF.pow(gf, 309, -3)
    assert 185 == GF.pow(gf, 309, -2)
    assert 67 == GF.pow(gf, 309, -1)
    assert 1 == GF.pow(gf, 309, 0)
    assert 309 == GF.pow(gf, 309, 1)
    assert 300 == GF.pow(gf, 309, 2)
    assert 268 == GF.pow(gf, 294, -3)
    assert 242 == GF.pow(gf, 294, -2)
    assert 19 == GF.pow(gf, 294, -1)
    assert 1 == GF.pow(gf, 294, 0)
    assert 294 == GF.pow(gf, 294, 1)
    assert 73 == GF.pow(gf, 294, 2)
    assert 9 == GF.pow(gf, 74, -3)
    assert 319 == GF.pow(gf, 74, -2)
    assert 55 == GF.pow(gf, 74, -1)
    assert 1 == GF.pow(gf, 74, 0)
    assert 74 == GF.pow(gf, 74, 1)
    assert 191 == GF.pow(gf, 74, 2)
    assert 55 == GF.pow(gf, 82, -3)
    assert 143 == GF.pow(gf, 82, -2)
    assert 238 == GF.pow(gf, 82, -1)
    assert 1 == GF.pow(gf, 82, 0)
    assert 82 == GF.pow(gf, 82, 1)
    assert 10 == GF.pow(gf, 82, 2)
    assert 151 == GF.pow(gf, 204, -3)
    assert 329 == GF.pow(gf, 204, -2)
    assert 248 == GF.pow(gf, 204, -1)
    assert 1 == GF.pow(gf, 204, 0)
    assert 204 == GF.pow(gf, 204, 1)
    assert 255 == GF.pow(gf, 204, 2)
    assert 264 == GF.pow(gf, 116, -3)
    assert 141 == GF.pow(gf, 116, -2)
    assert 22 == GF.pow(gf, 116, -1)
    assert 1 == GF.pow(gf, 116, 0)
    assert 116 == GF.pow(gf, 116, 1)
    assert 199 == GF.pow(gf, 116, 2)
    assert 30 == GF.pow(gf, 31, -3)
    assert 146 == GF.pow(gf, 31, -2)
    assert 147 == GF.pow(gf, 31, -1)
    assert 1 == GF.pow(gf, 31, 0)
    assert 31 == GF.pow(gf, 31, 1)
    assert 121 == GF.pow(gf, 31, 2)
    assert 215 == GF.pow(gf, 52, -3)
    assert 131 == GF.pow(gf, 52, -2)
    assert 180 == GF.pow(gf, 52, -1)
    assert 1 == GF.pow(gf, 52, 0)
    assert 52 == GF.pow(gf, 52, 1)
    assert 26 == GF.pow(gf, 52, 2)
    assert 264 == GF.pow(gf, 116, -3)
    assert 141 == GF.pow(gf, 116, -2)
    assert 22 == GF.pow(gf, 116, -1)
    assert 1 == GF.pow(gf, 116, 0)
    assert 116 == GF.pow(gf, 116, 1)
    assert 199 == GF.pow(gf, 116, 2)
    assert 9 == GF.pow(gf, 74, -3)
    assert 319 == GF.pow(gf, 74, -2)
    assert 55 == GF.pow(gf, 74, -1)
    assert 1 == GF.pow(gf, 74, 0)
    assert 74 == GF.pow(gf, 74, 1)
    assert 191 == GF.pow(gf, 74, 2)
    assert 141 == GF.pow(gf, 51, -3)
    assert 327 == GF.pow(gf, 51, -2)
    assert 334 == GF.pow(gf, 51, -1)
    assert 1 == GF.pow(gf, 51, 0)
    assert 51 == GF.pow(gf, 51, 1)
    assert 266 == GF.pow(gf, 51, 2)
    assert 141 == GF.pow(gf, 51, -3)
    assert 327 == GF.pow(gf, 51, -2)
    assert 334 == GF.pow(gf, 51, -1)
    assert 1 == GF.pow(gf, 51, 0)
    assert 51 == GF.pow(gf, 51, 1)
    assert 266 == GF.pow(gf, 51, 2)
    assert 166 == GF.pow(gf, 168, -3)
    assert 149 == GF.pow(gf, 168, -2)
    assert 187 == GF.pow(gf, 168, -1)
    assert 1 == GF.pow(gf, 168, 0)
    assert 168 == GF.pow(gf, 168, 1)
    assert 95 == GF.pow(gf, 168, 2)
    assert 168 == GF.pow(gf, 57, -3)
    assert 90 == GF.pow(gf, 57, -2)
    assert 251 == GF.pow(gf, 57, -1)
    assert 1 == GF.pow(gf, 57, 0)
    assert 57 == GF.pow(gf, 57, 1)
    assert 332 == GF.pow(gf, 57, 2)
    assert 2 == GF.pow(gf, 277, -3)
    assert 155 == GF.pow(gf, 277, -2)
    assert 226 == GF.pow(gf, 277, -1)
    assert 1 == GF.pow(gf, 277, 0)
    assert 277 == GF.pow(gf, 277, 1)
    assert 113 == GF.pow(gf, 277, 2)
    assert 34 == GF.pow(gf, 326, -3)
    assert 334 == GF.pow(gf, 326, -2)
    assert 157 == GF.pow(gf, 326, -1)
    assert 1 == GF.pow(gf, 326, 0)
    assert 326 == GF.pow(gf, 326, 1)
    assert 51 == GF.pow(gf, 326, 2)
    assert 298 == GF.pow(gf, 217, -3)
    assert 98 == GF.pow(gf, 217, -2)
    assert 21 == GF.pow(gf, 217, -1)
    assert 1 == GF.pow(gf, 217, 0)
    assert 217 == GF.pow(gf, 217, 1)
    assert 43 == GF.pow(gf, 217, 2)
    assert 268 == GF.pow(gf, 245, -3)
    assert 85 == GF.pow(gf, 245, -2)
    assert 13 == GF.pow(gf, 245, -1)
    assert 1 == GF.pow(gf, 245, 0)
    assert 245 == GF.pow(gf, 245, 1)
    assert 236 == GF.pow(gf, 245, 2)
    assert 166 == GF.pow(gf, 280, -3)
    assert 246 == GF.pow(gf, 280, -2)
    assert 318 == GF.pow(gf, 280, -1)
    assert 1 == GF.pow(gf, 280, 0)
    assert 280 == GF.pow(gf, 280, 1)
    assert 134 == GF.pow(gf, 280, 2)
    assert 323 == GF.pow(gf, 105, -3)
    assert 211 == GF.pow(gf, 105, -2)
    assert 328 == GF.pow(gf, 105, -1)
    assert 1 == GF.pow(gf, 105, 0)
    assert 105 == GF.pow(gf, 105, 1)
    assert 136 == GF.pow(gf, 105, 2)
    assert 174 == GF.pow(gf, 27, -3)
    assert 56 == GF.pow(gf, 27, -2)
    assert 289 == GF.pow(gf, 27, -1)
    assert 1 == GF.pow(gf, 27, 0)
    assert 27 == GF.pow(gf, 27, 1)
    assert 106 == GF.pow(gf, 27, 2)
    assert 318 == GF.pow(gf, 66, -3)
    assert 331 == GF.pow(gf, 66, -2)
    assert 215 == GF.pow(gf, 66, -1)
    assert 1 == GF.pow(gf, 66, 0)
    assert 66 == GF.pow(gf, 66, 1)
    assert 59 == GF.pow(gf, 66, 2)
    assert 267 == GF.pow(gf, 189, -3)
    assert 260 == GF.pow(gf, 189, -2)
    assert 167 == GF.pow(gf, 189, -1)
    assert 1 == GF.pow(gf, 189, 0)
    assert 189 == GF.pow(gf, 189, 1)
    assert 240 == GF.pow(gf, 189, 2)
    assert 59 == GF.pow(gf, 69, -3)
    assert 58 == GF.pow(gf, 69, -2)
    assert 45 == GF.pow(gf, 69, -1)
    assert 1 == GF.pow(gf, 69, 0)
    assert 69 == GF.pow(gf, 69, 1)
    assert 44 == GF.pow(gf, 69, 2)
    assert 92 == GF.pow(gf, 235, -3)
    assert 96 == GF.pow(gf, 235, -2)
    assert 182 == GF.pow(gf, 235, -1)
    assert 1 == GF.pow(gf, 235, 0)
    assert 235 == GF.pow(gf, 235, 1)
    assert 79 == GF.pow(gf, 235, 2)
    assert 304 == GF.pow(gf, 67, -3)
    assert 300 == GF.pow(gf, 67, -2)
    assert 309 == GF.pow(gf, 67, -1)
    assert 1 == GF.pow(gf, 67, 0)
    assert 67 == GF.pow(gf, 67, 1)
    assert 185 == GF.pow(gf, 67, 2)
    assert 319 == GF.pow(gf, 20, -3)
    assert 284 == GF.pow(gf, 20, -2)
    assert 75 == GF.pow(gf, 20, -1)
    assert 1 == GF.pow(gf, 20, 0)
    assert 20 == GF.pow(gf, 20, 1)
    assert 218 == GF.pow(gf, 20, 2)
    assert 41 == GF.pow(gf, 165, -3)
    assert 83 == GF.pow(gf, 165, -2)
    assert 264 == GF.pow(gf, 165, -1)
    assert 1 == GF.pow(gf, 165, 0)
    assert 165 == GF.pow(gf, 165, 1)
    assert 9 == GF.pow(gf, 165, 2)
    assert 129 == GF.pow(gf, 94, -3)
    assert 105 == GF.pow(gf, 94, -2)
    assert 311 == GF.pow(gf, 94, -1)
    assert 1 == GF.pow(gf, 94, 0)
    assert 94 == GF.pow(gf, 94, 1)
    assert 328 == GF.pow(gf, 94, 2)
    assert 47 == GF.pow(gf, 325, -3)
    assert 319 == GF.pow(gf, 325, -2)
    assert 295 == GF.pow(gf, 325, -1)
    assert 1 == GF.pow(gf, 325, 0)
    assert 325 == GF.pow(gf, 325, 1)
    assert 191 == GF.pow(gf, 325, 2)
    assert 39 == GF.pow(gf, 110, -3)
    assert 106 == GF.pow(gf, 110, -2)
    assert 29 == GF.pow(gf, 110, -1)
    assert 1 == GF.pow(gf, 110, 0)
    assert 110 == GF.pow(gf, 110, 1)
    assert 56 == GF.pow(gf, 110, 2)
    assert 190 == GF.pow(gf, 218, -3)
    assert 24 == GF.pow(gf, 218, -2)
    assert 284 == GF.pow(gf, 218, -1)
    assert 1 == GF.pow(gf, 218, 0)
    assert 218 == GF.pow(gf, 218, 1)
    assert 86 == GF.pow(gf, 218, 2)
    assert 103 == GF.pow(gf, 212, -3)
    assert 95 == GF.pow(gf, 212, -2)
    assert 224 == GF.pow(gf, 212, -1)
    assert 1 == GF.pow(gf, 212, 0)
    assert 212 == GF.pow(gf, 212, 1)
    assert 149 == GF.pow(gf, 212, 2)
    assert 267 == GF.pow(gf, 189, -3)
    assert 260 == GF.pow(gf, 189, -2)
    assert 167 == GF.pow(gf, 189, -1)
    assert 1 == GF.pow(gf, 189, 0)
    assert 189 == GF.pow(gf, 189, 1)
    assert 240 == GF.pow(gf, 189, 2)
    assert 30 == GF.pow(gf, 31, -3)
    assert 146 == GF.pow(gf, 31, -2)
    assert 147 == GF.pow(gf, 31, -1)
    assert 1 == GF.pow(gf, 31, 0)
    assert 31 == GF.pow(gf, 31, 1)
    assert 121 == GF.pow(gf, 31, 2)
    assert 233 == GF.pow(gf, 56, -3)
    assert 298 == GF.pow(gf, 56, -2)
    assert 106 == GF.pow(gf, 56, -1)
    assert 1 == GF.pow(gf, 56, 0)
    assert 56 == GF.pow(gf, 56, 1)
    assert 219 == GF.pow(gf, 56, 2)
    assert 340 == GF.pow(gf, 193, -3)
    assert 225 == GF.pow(gf, 193, -2)
    assert 15 == GF.pow(gf, 193, -1)
    assert 1 == GF.pow(gf, 193, 0)
    assert 193 == GF.pow(gf, 193, 1)
    assert 39 == GF.pow(gf, 193, 2)
    assert 38 == GF.pow(gf, 271, -3)
    assert 342 == GF.pow(gf, 271, -2)
    assert 138 == GF.pow(gf, 271, -1)
    assert 1 == GF.pow(gf, 271, 0)
    assert 271 == GF.pow(gf, 271, 1)
    assert 99 == GF.pow(gf, 271, 2)
    assert 341 == GF.pow(gf, 117, -3)
    assert 238 == GF.pow(gf, 117, -2)
    assert 231 == GF.pow(gf, 117, -1)
    assert 1 == GF.pow(gf, 117, 0)
    assert 117 == GF.pow(gf, 117, 1)
    assert 82 == GF.pow(gf, 117, 2)
    assert 9 == GF.pow(gf, 74, -3)
    assert 319 == GF.pow(gf, 74, -2)
    assert 55 == GF.pow(gf, 74, -1)
    assert 1 == GF.pow(gf, 74, 0)
    assert 74 == GF.pow(gf, 74, 1)
    assert 191 == GF.pow(gf, 74, 2)
    assert 44 == GF.pow(gf, 322, -3)
    assert 108 == GF.pow(gf, 322, -2)
    assert 337 == GF.pow(gf, 322, -1)
    assert 1 == GF.pow(gf, 322, 0)
    assert 322 == GF.pow(gf, 322, 1)
    assert 119 == GF.pow(gf, 322, 2)
    assert 145 == GF.pow(gf, 8, -3)
    assert 179 == GF.pow(gf, 8, -2)
    assert 160 == GF.pow(gf, 8, -1)
    assert 1 == GF.pow(gf, 8, 0)
    assert 8 == GF.pow(gf, 8, 1)
    assert 64 == GF.pow(gf, 8, 2)
    assert 56 == GF.pow(gf, 125, -3)
    assert 133 == GF.pow(gf, 125, -2)
    assert 249 == GF.pow(gf, 125, -1)
    assert 1 == GF.pow(gf, 125, 0)
    assert 125 == GF.pow(gf, 125, 1)
    assert 42 == GF.pow(gf, 125, 2)
    assert 92 == GF.pow(gf, 235, -3)
    assert 96 == GF.pow(gf, 235, -2)
    assert 182 == GF.pow(gf, 235, -1)
    assert 1 == GF.pow(gf, 235, 0)
    assert 235 == GF.pow(gf, 235, 1)
    assert 79 == GF.pow(gf, 235, 2)
    assert 298 == GF.pow(gf, 217, -3)
    assert 98 == GF.pow(gf, 217, -2)
    assert 21 == GF.pow(gf, 217, -1)
    assert 1 == GF.pow(gf, 217, 0)
    assert 217 == GF.pow(gf, 217, 1)
    assert 43 == GF.pow(gf, 217, 2)
    assert 208 == GF.pow(gf, 324, -3)
    assert 218 == GF.pow(gf, 324, -2)
    assert 36 == GF.pow(gf, 324, -1)
    assert 1 == GF.pow(gf, 324, 0)
    assert 324 == GF.pow(gf, 324, 1)
    assert 284 == GF.pow(gf, 324, 2)
    assert 116 == GF.pow(gf, 242, -3)
    assert 51 == GF.pow(gf, 242, -2)
    assert 73 == GF.pow(gf, 242, -1)
    assert 1 == GF.pow(gf, 242, 0)
    assert 242 == GF.pow(gf, 242, 1)
    assert 334 == GF.pow(gf, 242, 2)
    assert 254 == GF.pow(gf, 48, -3)
    assert 179 == GF.pow(gf, 48, -2)
    assert 239 == GF.pow(gf, 48, -1)
    assert 1 == GF.pow(gf, 48, 0)
    assert 48 == GF.pow(gf, 48, 1)
    assert 64 == GF.pow(gf, 48, 2)
    assert 59 == GF.pow(gf, 69, -3)
    assert 58 == GF.pow(gf, 69, -2)
    assert 45 == GF.pow(gf, 69, -1)
    assert 1 == GF.pow(gf, 69, 0)
    assert 69 == GF.pow(gf, 69, 1)
    assert 44 == GF.pow(gf, 69, 2)
    assert 27 == GF.pow(gf, 263, -3)
    assert 125 == GF.pow(gf, 263, -2)
    assert 188 == GF.pow(gf, 263, -1)
    assert 1 == GF.pow(gf, 263, 0)
    assert 263 == GF.pow(gf, 263, 1)
    assert 249 == GF.pow(gf, 263, 2)
    assert 201 == GF.pow(gf, 309, -3)
    assert 185 == GF.pow(gf, 309, -2)
    assert 67 == GF.pow(gf, 309, -1)
    assert 1 == GF.pow(gf, 309, 0)
    assert 309 == GF.pow(gf, 309, 1)
    assert 300 == GF.pow(gf, 309, 2)
    assert 336 == GF.pow(gf, 312, -3)
    assert 91 == GF.pow(gf, 312, -2)
    assert 202 == GF.pow(gf, 312, -1)
    assert 1 == GF.pow(gf, 312, 0)
    assert 312 == GF.pow(gf, 312, 1)
    assert 35 == GF.pow(gf, 312, 2)
    assert 38 == GF.pow(gf, 271, -3)
    assert 342 == GF.pow(gf, 271, -2)
    assert 138 == GF.pow(gf, 271, -1)
    assert 1 == GF.pow(gf, 271, 0)
    assert 271 == GF.pow(gf, 271, 1)
    assert 99 == GF.pow(gf, 271, 2)
    assert 151 == GF.pow(gf, 65, -3)
    assert 266 == GF.pow(gf, 65, -2)
    assert 299 == GF.pow(gf, 65, -1)
    assert 1 == GF.pow(gf, 65, 0)
    assert 65 == GF.pow(gf, 65, 1)
    assert 327 == GF.pow(gf, 65, 2)
    assert 178 == GF.pow(gf, 86, -3)
    assert 128 == GF.pow(gf, 86, -2)
    assert 24 == GF.pow(gf, 86, -1)
    assert 1 == GF.pow(gf, 86, 0)
    assert 86 == GF.pow(gf, 86, 1)
    assert 261 == GF.pow(gf, 86, 2)
    assert 118 == GF.pow(gf, 338, -3)
    assert 239 == GF.pow(gf, 338, -2)
    assert 93 == GF.pow(gf, 338, -1)
    assert 1 == GF.pow(gf, 338, 0)
    assert 338 == GF.pow(gf, 338, 1)
    assert 48 == GF.pow(gf, 338, 2)
    assert 316 == GF.pow(gf, 247, -3)
    assert 333 == GF.pow(gf, 247, -2)
    assert 166 == GF.pow(gf, 247, -1)
    assert 1 == GF.pow(gf, 247, 0)
    assert 247 == GF.pow(gf, 247, 1)
    assert 184 == GF.pow(gf, 247, 2)
    assert 12 == GF.pow(gf, 140, -3)
    assert 216 == GF.pow(gf, 140, -2)
    assert 227 == GF.pow(gf, 140, -1)
    assert 1 == GF.pow(gf, 140, 0)
    assert 140 == GF.pow(gf, 140, 1)
    assert 84 == GF.pow(gf, 140, 2)
    assert 336 == GF.pow(gf, 156, -3)
    assert 217 == GF.pow(gf, 156, -2)
    assert 54 == GF.pow(gf, 156, -1)
    assert 1 == GF.pow(gf, 156, 0)
    assert 156 == GF.pow(gf, 156, 1)
    assert 21 == GF.pow(gf, 156, 2)
    assert 178 == GF.pow(gf, 123, -3)
    assert 207 == GF.pow(gf, 123, -2)
    assert 40 == GF.pow(gf, 123, -1)
    assert 1 == GF.pow(gf, 123, 0)
    assert 123 == GF.pow(gf, 123, 1)
    assert 302 == GF.pow(gf, 123, 2)
    assert 304 == GF.pow(gf, 127, -3)
    assert 250 == GF.pow(gf, 127, -2)
    assert 158 == GF.pow(gf, 127, -1)
    assert 1 == GF.pow(gf, 127, 0)
    assert 127 == GF.pow(gf, 127, 1)
    assert 292 == GF.pow(gf, 127, 2)
    assert 316 == GF.pow(gf, 247, -3)
    assert 333 == GF.pow(gf, 247, -2)
    assert 166 == GF.pow(gf, 247, -1)
    assert 1 == GF.pow(gf, 247, 0)
    assert 247 == GF.pow(gf, 247, 1)
    assert 184 == GF.pow(gf, 247, 2)
  end


end
