defmodule MulInvTest do
  use ExUnit.Case

  @tag :gen_test_mul_inv
  test "GF(2, 1) mul inv" do
    gf = GF.new(2, 1, [1,1])
    assert 1 == GF.mul_inv(gf, 1)
  end

  @tag :gen_test_mul_inv
  test "GF(2, 2) mul inv" do
    gf = GF.new(2, 2, [1,1,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 3 == GF.mul_inv(gf, 2)
    assert 2 == GF.mul_inv(gf, 3)
  end

  @tag :gen_test_mul_inv
  test "GF(2, 3) mul inv" do
    gf = GF.new(2, 3, [1,1,0,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 5 == GF.mul_inv(gf, 2)
    assert 6 == GF.mul_inv(gf, 3)
    assert 7 == GF.mul_inv(gf, 4)
    assert 2 == GF.mul_inv(gf, 5)
    assert 3 == GF.mul_inv(gf, 6)
    assert 4 == GF.mul_inv(gf, 7)
  end

  @tag :gen_test_mul_inv
  test "GF(3, 1) mul inv" do
    gf = GF.new(3, 1, [1,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 2 == GF.mul_inv(gf, 2)
  end

  @tag :gen_test_mul_inv
  test "GF(3, 2) mul inv" do
    gf = GF.new(3, 2, [2,2,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 2 == GF.mul_inv(gf, 2)
    assert 5 == GF.mul_inv(gf, 3)
    assert 8 == GF.mul_inv(gf, 4)
    assert 3 == GF.mul_inv(gf, 5)
    assert 7 == GF.mul_inv(gf, 6)
    assert 6 == GF.mul_inv(gf, 7)
    assert 4 == GF.mul_inv(gf, 8)
  end

  @tag :gen_test_mul_inv
  test "GF(3, 3) mul inv" do
    gf = GF.new(3, 3, [1,2,0,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 2 == GF.mul_inv(gf, 2)
    assert 19 == GF.mul_inv(gf, 3)
    assert 21 == GF.mul_inv(gf, 4)
    assert 24 == GF.mul_inv(gf, 5)
    assert 11 == GF.mul_inv(gf, 6)
    assert 12 == GF.mul_inv(gf, 7)
    assert 15 == GF.mul_inv(gf, 8)
    assert 25 == GF.mul_inv(gf, 9)
    assert 23 == GF.mul_inv(gf, 10)
    assert 6 == GF.mul_inv(gf, 11)
    assert 7 == GF.mul_inv(gf, 12)
    assert 22 == GF.mul_inv(gf, 13)
    assert 18 == GF.mul_inv(gf, 14)
    assert 8 == GF.mul_inv(gf, 15)
    assert 20 == GF.mul_inv(gf, 16)
    assert 26 == GF.mul_inv(gf, 17)
    assert 14 == GF.mul_inv(gf, 18)
    assert 3 == GF.mul_inv(gf, 19)
    assert 16 == GF.mul_inv(gf, 20)
    assert 4 == GF.mul_inv(gf, 21)
    assert 13 == GF.mul_inv(gf, 22)
    assert 10 == GF.mul_inv(gf, 23)
    assert 5 == GF.mul_inv(gf, 24)
    assert 9 == GF.mul_inv(gf, 25)
    assert 17 == GF.mul_inv(gf, 26)
  end

  @tag :gen_test_mul_inv
  test "GF(5, 1) mul inv" do
    gf = GF.new(5, 1, [3,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 3 == GF.mul_inv(gf, 2)
    assert 2 == GF.mul_inv(gf, 3)
    assert 4 == GF.mul_inv(gf, 4)
  end

  @tag :gen_test_mul_inv
  test "GF(5, 2) mul inv" do
    gf = GF.new(5, 2, [2,4,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 3 == GF.mul_inv(gf, 2)
    assert 2 == GF.mul_inv(gf, 3)
    assert 4 == GF.mul_inv(gf, 4)
    assert 13 == GF.mul_inv(gf, 5)
    assert 8 == GF.mul_inv(gf, 6)
    assert 16 == GF.mul_inv(gf, 7)
    assert 6 == GF.mul_inv(gf, 8)
    assert 10 == GF.mul_inv(gf, 9)
    assert 9 == GF.mul_inv(gf, 10)
    assert 18 == GF.mul_inv(gf, 11)
    assert 19 == GF.mul_inv(gf, 12)
    assert 5 == GF.mul_inv(gf, 13)
    assert 23 == GF.mul_inv(gf, 14)
    assert 21 == GF.mul_inv(gf, 15)
    assert 7 == GF.mul_inv(gf, 16)
    assert 20 == GF.mul_inv(gf, 17)
    assert 11 == GF.mul_inv(gf, 18)
    assert 12 == GF.mul_inv(gf, 19)
    assert 17 == GF.mul_inv(gf, 20)
    assert 15 == GF.mul_inv(gf, 21)
    assert 24 == GF.mul_inv(gf, 22)
    assert 14 == GF.mul_inv(gf, 23)
    assert 22 == GF.mul_inv(gf, 24)
  end

  @tag :gen_test_mul_inv
  test "GF(5, 3) mul inv" do
    gf = GF.new(5, 3, [3,3,0,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 3 == GF.mul_inv(gf, 2)
    assert 4 == GF.mul_inv(gf, 4)
    assert 49 == GF.mul_inv(gf, 6)
    assert 49 == GF.mul_inv(gf, 6)
    assert 63 == GF.mul_inv(gf, 9)
    assert 37 == GF.mul_inv(gf, 11)
    assert 37 == GF.mul_inv(gf, 11)
    assert 37 == GF.mul_inv(gf, 11)
    assert 37 == GF.mul_inv(gf, 11)
    assert 87 == GF.mul_inv(gf, 12)
    assert 34 == GF.mul_inv(gf, 13)
    assert 96 == GF.mul_inv(gf, 14)
    assert 59 == GF.mul_inv(gf, 16)
    assert 51 == GF.mul_inv(gf, 20)
    assert 92 == GF.mul_inv(gf, 21)
    assert 81 == GF.mul_inv(gf, 22)
    assert 81 == GF.mul_inv(gf, 22)
    assert 123 == GF.mul_inv(gf, 26)
    assert 15 == GF.mul_inv(gf, 28)
    assert 15 == GF.mul_inv(gf, 28)
    assert 55 == GF.mul_inv(gf, 30)
    assert 35 == GF.mul_inv(gf, 31)
    assert 104 == GF.mul_inv(gf, 32)
    assert 104 == GF.mul_inv(gf, 32)
    assert 13 == GF.mul_inv(gf, 34)
    assert 27 == GF.mul_inv(gf, 36)
    assert 11 == GF.mul_inv(gf, 37)
    assert 99 == GF.mul_inv(gf, 39)
    assert 105 == GF.mul_inv(gf, 41)
    assert 105 == GF.mul_inv(gf, 41)
    assert 105 == GF.mul_inv(gf, 41)
    assert 105 == GF.mul_inv(gf, 41)
    assert 82 == GF.mul_inv(gf, 43)
    assert 77 == GF.mul_inv(gf, 44)
    assert 114 == GF.mul_inv(gf, 45)
    assert 114 == GF.mul_inv(gf, 45)
    assert 61 == GF.mul_inv(gf, 46)
    assert 61 == GF.mul_inv(gf, 46)
    assert 50 == GF.mul_inv(gf, 48)
    assert 20 == GF.mul_inv(gf, 51)
    assert 64 == GF.mul_inv(gf, 52)
    assert 111 == GF.mul_inv(gf, 53)
    assert 83 == GF.mul_inv(gf, 54)
    assert 30 == GF.mul_inv(gf, 55)
    assert 30 == GF.mul_inv(gf, 55)
    assert 30 == GF.mul_inv(gf, 55)
    assert 116 == GF.mul_inv(gf, 56)
    assert 65 == GF.mul_inv(gf, 57)
    assert 101 == GF.mul_inv(gf, 58)
    assert 101 == GF.mul_inv(gf, 58)
    assert 16 == GF.mul_inv(gf, 59)
    assert 16 == GF.mul_inv(gf, 59)
    assert 16 == GF.mul_inv(gf, 59)
    assert 40 == GF.mul_inv(gf, 60)
    assert 40 == GF.mul_inv(gf, 60)
    assert 40 == GF.mul_inv(gf, 60)
    assert 80 == GF.mul_inv(gf, 62)
    assert 9 == GF.mul_inv(gf, 63)
    assert 9 == GF.mul_inv(gf, 63)
    assert 25 == GF.mul_inv(gf, 66)
    assert 25 == GF.mul_inv(gf, 66)
    assert 38 == GF.mul_inv(gf, 69)
    assert 47 == GF.mul_inv(gf, 71)
    assert 47 == GF.mul_inv(gf, 71)
    assert 112 == GF.mul_inv(gf, 73)
    assert 112 == GF.mul_inv(gf, 73)
    assert 107 == GF.mul_inv(gf, 75)
    assert 107 == GF.mul_inv(gf, 75)
    assert 107 == GF.mul_inv(gf, 75)
    assert 44 == GF.mul_inv(gf, 77)
    assert 91 == GF.mul_inv(gf, 78)
    assert 91 == GF.mul_inv(gf, 78)
    assert 5 == GF.mul_inv(gf, 79)
    assert 62 == GF.mul_inv(gf, 80)
    assert 78 == GF.mul_inv(gf, 91)
    assert 21 == GF.mul_inv(gf, 92)
    assert 109 == GF.mul_inv(gf, 94)
    assert 14 == GF.mul_inv(gf, 96)
    assert 85 == GF.mul_inv(gf, 98)
    assert 85 == GF.mul_inv(gf, 98)
    assert 39 == GF.mul_inv(gf, 99)
    assert 39 == GF.mul_inv(gf, 99)
    assert 39 == GF.mul_inv(gf, 99)
    assert 89 == GF.mul_inv(gf, 100)
    assert 58 == GF.mul_inv(gf, 101)
    assert 58 == GF.mul_inv(gf, 101)
    assert 32 == GF.mul_inv(gf, 104)
    assert 32 == GF.mul_inv(gf, 104)
    assert 24 == GF.mul_inv(gf, 106)
    assert 24 == GF.mul_inv(gf, 106)
    assert 90 == GF.mul_inv(gf, 110)
    assert 53 == GF.mul_inv(gf, 111)
    assert 73 == GF.mul_inv(gf, 112)
    assert 124 == GF.mul_inv(gf, 115)
    assert 124 == GF.mul_inv(gf, 115)
    assert 19 == GF.mul_inv(gf, 118)
    assert 103 == GF.mul_inv(gf, 119)
    assert 95 == GF.mul_inv(gf, 120)
    assert 26 == GF.mul_inv(gf, 123)
  end

  @tag :gen_test_mul_inv
  test "GF(7, 1) mul inv" do
    gf = GF.new(7, 1, [4,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 4 == GF.mul_inv(gf, 2)
    assert 5 == GF.mul_inv(gf, 3)
    assert 2 == GF.mul_inv(gf, 4)
    assert 3 == GF.mul_inv(gf, 5)
    assert 6 == GF.mul_inv(gf, 6)
  end

  @tag :gen_test_mul_inv
  test "GF(7, 2) mul inv" do
    gf = GF.new(7, 2, [3,6,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 4 == GF.mul_inv(gf, 2)
    assert 5 == GF.mul_inv(gf, 3)
    assert 2 == GF.mul_inv(gf, 4)
    assert 3 == GF.mul_inv(gf, 5)
    assert 6 == GF.mul_inv(gf, 6)
    assert 19 == GF.mul_inv(gf, 7)
    assert 34 == GF.mul_inv(gf, 8)
    assert 26 == GF.mul_inv(gf, 9)
    assert 46 == GF.mul_inv(gf, 10)
    assert 27 == GF.mul_inv(gf, 11)
    assert 32 == GF.mul_inv(gf, 12)
    assert 14 == GF.mul_inv(gf, 13)
    assert 13 == GF.mul_inv(gf, 14)
    assert 38 == GF.mul_inv(gf, 15)
    assert 17 == GF.mul_inv(gf, 16)
    assert 16 == GF.mul_inv(gf, 17)
    assert 41 == GF.mul_inv(gf, 18)
    assert 7 == GF.mul_inv(gf, 19)
    assert 23 == GF.mul_inv(gf, 20)
    assert 25 == GF.mul_inv(gf, 21)
    assert 48 == GF.mul_inv(gf, 22)
    assert 20 == GF.mul_inv(gf, 23)
    assert 44 == GF.mul_inv(gf, 24)
    assert 21 == GF.mul_inv(gf, 25)
    assert 9 == GF.mul_inv(gf, 26)
    assert 11 == GF.mul_inv(gf, 27)
    assert 31 == GF.mul_inv(gf, 28)
    assert 45 == GF.mul_inv(gf, 29)
    assert 47 == GF.mul_inv(gf, 30)
    assert 28 == GF.mul_inv(gf, 31)
    assert 12 == GF.mul_inv(gf, 32)
    assert 36 == GF.mul_inv(gf, 33)
    assert 8 == GF.mul_inv(gf, 34)
    assert 43 == GF.mul_inv(gf, 35)
    assert 33 == GF.mul_inv(gf, 36)
    assert 42 == GF.mul_inv(gf, 37)
    assert 15 == GF.mul_inv(gf, 38)
    assert 40 == GF.mul_inv(gf, 39)
    assert 39 == GF.mul_inv(gf, 40)
    assert 18 == GF.mul_inv(gf, 41)
    assert 37 == GF.mul_inv(gf, 42)
    assert 35 == GF.mul_inv(gf, 43)
    assert 24 == GF.mul_inv(gf, 44)
    assert 29 == GF.mul_inv(gf, 45)
    assert 10 == GF.mul_inv(gf, 46)
    assert 30 == GF.mul_inv(gf, 47)
    assert 22 == GF.mul_inv(gf, 48)
  end

  @tag :gen_test_mul_inv
  test "GF(7, 3) mul inv" do
    gf = GF.new(7, 3, [4,0,6,1])
    assert 1 == GF.mul_inv(gf, 1)
    assert 330 == GF.mul_inv(gf, 11)
    assert 330 == GF.mul_inv(gf, 11)
    assert 341 == GF.mul_inv(gf, 12)
    assert 174 == GF.mul_inv(gf, 17)
    assert 116 == GF.mul_inv(gf, 22)
    assert 162 == GF.mul_inv(gf, 23)
    assert 289 == GF.mul_inv(gf, 27)
    assert 175 == GF.mul_inv(gf, 28)
    assert 133 == GF.mul_inv(gf, 42)
    assert 69 == GF.mul_inv(gf, 45)
    assert 316 == GF.mul_inv(gf, 47)
    assert 239 == GF.mul_inv(gf, 48)
    assert 214 == GF.mul_inv(gf, 50)
    assert 180 == GF.mul_inv(gf, 52)
    assert 179 == GF.mul_inv(gf, 64)
    assert 96 == GF.mul_inv(gf, 79)
    assert 208 == GF.mul_inv(gf, 80)
    assert 9 == GF.mul_inv(gf, 83)
    assert 9 == GF.mul_inv(gf, 83)
    assert 236 == GF.mul_inv(gf, 85)
    assert 339 == GF.mul_inv(gf, 89)
    assert 332 == GF.mul_inv(gf, 90)
    assert 35 == GF.mul_inv(gf, 91)
    assert 274 == GF.mul_inv(gf, 101)
    assert 274 == GF.mul_inv(gf, 101)
    assert 297 == GF.mul_inv(gf, 114)
    assert 249 == GF.mul_inv(gf, 125)
    assert 158 == GF.mul_inv(gf, 127)
    assert 261 == GF.mul_inv(gf, 128)
    assert 26 == GF.mul_inv(gf, 131)
    assert 211 == GF.mul_inv(gf, 136)
    assert 271 == GF.mul_inv(gf, 138)
    assert 10 == GF.mul_inv(gf, 143)
    assert 221 == GF.mul_inv(gf, 145)
    assert 121 == GF.mul_inv(gf, 146)
    assert 130 == GF.mul_inv(gf, 153)
    assert 127 == GF.mul_inv(gf, 158)
    assert 210 == GF.mul_inv(gf, 164)
    assert 247 == GF.mul_inv(gf, 166)
    assert 189 == GF.mul_inv(gf, 167)
    assert 137 == GF.mul_inv(gf, 169)
    assert 252 == GF.mul_inv(gf, 172)
    assert 17 == GF.mul_inv(gf, 174)
    assert 64 == GF.mul_inv(gf, 179)
    assert 115 == GF.mul_inv(gf, 181)
    assert 235 == GF.mul_inv(gf, 182)
    assert 308 == GF.mul_inv(gf, 183)
    assert 167 == GF.mul_inv(gf, 189)
    assert 97 == GF.mul_inv(gf, 192)
    assert 15 == GF.mul_inv(gf, 193)
    assert 102 == GF.mul_inv(gf, 195)
    assert 25 == GF.mul_inv(gf, 196)
    assert 269 == GF.mul_inv(gf, 197)
    assert 78 == GF.mul_inv(gf, 200)
    assert 78 == GF.mul_inv(gf, 200)
    assert 41 == GF.mul_inv(gf, 206)
    assert 41 == GF.mul_inv(gf, 206)
    assert 302 == GF.mul_inv(gf, 207)
    assert 18 == GF.mul_inv(gf, 213)
    assert 50 == GF.mul_inv(gf, 214)
    assert 84 == GF.mul_inv(gf, 216)
    assert 109 == GF.mul_inv(gf, 223)
    assert 39 == GF.mul_inv(gf, 225)
    assert 277 == GF.mul_inv(gf, 226)
    assert 203 == GF.mul_inv(gf, 232)
    assert 103 == GF.mul_inv(gf, 233)
    assert 48 == GF.mul_inv(gf, 239)
    assert 272 == GF.mul_inv(gf, 241)
    assert 296 == GF.mul_inv(gf, 243)
    assert 286 == GF.mul_inv(gf, 244)
    assert 134 == GF.mul_inv(gf, 246)
    assert 134 == GF.mul_inv(gf, 246)
    assert 166 == GF.mul_inv(gf, 247)
    assert 292 == GF.mul_inv(gf, 250)
    assert 329 == GF.mul_inv(gf, 255)
    assert 77 == GF.mul_inv(gf, 257)
    assert 240 == GF.mul_inv(gf, 260)
    assert 128 == GF.mul_inv(gf, 261)
    assert 165 == GF.mul_inv(gf, 264)
    assert 229 == GF.mul_inv(gf, 270)
    assert 205 == GF.mul_inv(gf, 275)
    assert 16 == GF.mul_inv(gf, 276)
    assert 16 == GF.mul_inv(gf, 276)
    assert 226 == GF.mul_inv(gf, 277)
    assert 209 == GF.mul_inv(gf, 281)
    assert 34 == GF.mul_inv(gf, 283)
    assert 267 == GF.mul_inv(gf, 288)
    assert 219 == GF.mul_inv(gf, 298)
    assert 65 == GF.mul_inv(gf, 299)
    assert 320 == GF.mul_inv(gf, 303)
    assert 88 == GF.mul_inv(gf, 305)
    assert 323 == GF.mul_inv(gf, 307)
    assert 202 == GF.mul_inv(gf, 312)
    assert 163 == GF.mul_inv(gf, 314)
    assert 142 == GF.mul_inv(gf, 315)
    assert 150 == GF.mul_inv(gf, 321)
    assert 11 == GF.mul_inv(gf, 330)
    assert 11 == GF.mul_inv(gf, 330)
    assert 293 == GF.mul_inv(gf, 336)
  end
end
