defmodule MulTest do
  use ExUnit.Case

  @tag :gen_test_mul
  test "GF(2, 1) mul" do
    gf = GF.new(2, 1, [1,1])
    assert 0 == GF.mul(gf, 0, 0)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 1, 0)
    assert 1 == GF.mul(gf, 1, 1)
  end

  @tag :gen_test_mul
  test "GF(2, 2) mul" do
    gf = GF.new(2, 2, [1,1,1])
    assert 0 == GF.mul(gf, 0, 0)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 2)
    assert 0 == GF.mul(gf, 0, 3)
    assert 0 == GF.mul(gf, 1, 0)
    assert 1 == GF.mul(gf, 1, 1)
    assert 2 == GF.mul(gf, 1, 2)
    assert 3 == GF.mul(gf, 1, 3)
    assert 0 == GF.mul(gf, 2, 0)
    assert 2 == GF.mul(gf, 2, 1)
    assert 3 == GF.mul(gf, 2, 2)
    assert 1 == GF.mul(gf, 2, 3)
    assert 0 == GF.mul(gf, 3, 0)
    assert 3 == GF.mul(gf, 3, 1)
    assert 1 == GF.mul(gf, 3, 2)
    assert 2 == GF.mul(gf, 3, 3)
  end

  @tag :gen_test_mul
  test "GF(2, 3) mul" do
    gf = GF.new(2, 3, [1,1,0,1])
    assert 0 == GF.mul(gf, 0, 0)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 2)
    assert 0 == GF.mul(gf, 0, 3)
    assert 0 == GF.mul(gf, 0, 4)
    assert 0 == GF.mul(gf, 0, 5)
    assert 0 == GF.mul(gf, 0, 6)
    assert 0 == GF.mul(gf, 0, 7)
    assert 0 == GF.mul(gf, 1, 0)
    assert 1 == GF.mul(gf, 1, 1)
    assert 2 == GF.mul(gf, 1, 2)
    assert 3 == GF.mul(gf, 1, 3)
    assert 4 == GF.mul(gf, 1, 4)
    assert 5 == GF.mul(gf, 1, 5)
    assert 6 == GF.mul(gf, 1, 6)
    assert 7 == GF.mul(gf, 1, 7)
    assert 0 == GF.mul(gf, 2, 0)
    assert 2 == GF.mul(gf, 2, 1)
    assert 4 == GF.mul(gf, 2, 2)
    assert 6 == GF.mul(gf, 2, 3)
    assert 3 == GF.mul(gf, 2, 4)
    assert 1 == GF.mul(gf, 2, 5)
    assert 7 == GF.mul(gf, 2, 6)
    assert 5 == GF.mul(gf, 2, 7)
    assert 0 == GF.mul(gf, 3, 0)
    assert 3 == GF.mul(gf, 3, 1)
    assert 6 == GF.mul(gf, 3, 2)
    assert 5 == GF.mul(gf, 3, 3)
    assert 7 == GF.mul(gf, 3, 4)
    assert 4 == GF.mul(gf, 3, 5)
    assert 1 == GF.mul(gf, 3, 6)
    assert 2 == GF.mul(gf, 3, 7)
    assert 0 == GF.mul(gf, 4, 0)
    assert 4 == GF.mul(gf, 4, 1)
    assert 3 == GF.mul(gf, 4, 2)
    assert 7 == GF.mul(gf, 4, 3)
    assert 6 == GF.mul(gf, 4, 4)
    assert 2 == GF.mul(gf, 4, 5)
    assert 5 == GF.mul(gf, 4, 6)
    assert 1 == GF.mul(gf, 4, 7)
    assert 0 == GF.mul(gf, 5, 0)
    assert 5 == GF.mul(gf, 5, 1)
    assert 1 == GF.mul(gf, 5, 2)
    assert 4 == GF.mul(gf, 5, 3)
    assert 2 == GF.mul(gf, 5, 4)
    assert 7 == GF.mul(gf, 5, 5)
    assert 3 == GF.mul(gf, 5, 6)
    assert 6 == GF.mul(gf, 5, 7)
    assert 0 == GF.mul(gf, 6, 0)
    assert 6 == GF.mul(gf, 6, 1)
    assert 7 == GF.mul(gf, 6, 2)
    assert 1 == GF.mul(gf, 6, 3)
    assert 5 == GF.mul(gf, 6, 4)
    assert 3 == GF.mul(gf, 6, 5)
    assert 2 == GF.mul(gf, 6, 6)
    assert 4 == GF.mul(gf, 6, 7)
    assert 0 == GF.mul(gf, 7, 0)
    assert 7 == GF.mul(gf, 7, 1)
    assert 5 == GF.mul(gf, 7, 2)
    assert 2 == GF.mul(gf, 7, 3)
    assert 1 == GF.mul(gf, 7, 4)
    assert 6 == GF.mul(gf, 7, 5)
    assert 4 == GF.mul(gf, 7, 6)
    assert 3 == GF.mul(gf, 7, 7)
  end

  @tag :gen_test_mul
  test "GF(3, 1) mul" do
    gf = GF.new(3, 1, [1,1])
    assert 0 == GF.mul(gf, 0, 0)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 2)
    assert 0 == GF.mul(gf, 1, 0)
    assert 1 == GF.mul(gf, 1, 1)
    assert 2 == GF.mul(gf, 1, 2)
    assert 0 == GF.mul(gf, 2, 0)
    assert 2 == GF.mul(gf, 2, 1)
    assert 1 == GF.mul(gf, 2, 2)
  end

  @tag :gen_test_mul
  test "GF(3, 2) mul" do
    gf = GF.new(3, 2, [2,2,1])
    assert 0 == GF.mul(gf, 0, 0)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 2)
    assert 0 == GF.mul(gf, 0, 3)
    assert 0 == GF.mul(gf, 0, 4)
    assert 0 == GF.mul(gf, 0, 5)
    assert 0 == GF.mul(gf, 0, 6)
    assert 0 == GF.mul(gf, 0, 7)
    assert 0 == GF.mul(gf, 0, 8)
    assert 0 == GF.mul(gf, 1, 0)
    assert 1 == GF.mul(gf, 1, 1)
    assert 2 == GF.mul(gf, 1, 2)
    assert 3 == GF.mul(gf, 1, 3)
    assert 4 == GF.mul(gf, 1, 4)
    assert 5 == GF.mul(gf, 1, 5)
    assert 6 == GF.mul(gf, 1, 6)
    assert 7 == GF.mul(gf, 1, 7)
    assert 8 == GF.mul(gf, 1, 8)
    assert 0 == GF.mul(gf, 2, 0)
    assert 2 == GF.mul(gf, 2, 1)
    assert 1 == GF.mul(gf, 2, 2)
    assert 6 == GF.mul(gf, 2, 3)
    assert 8 == GF.mul(gf, 2, 4)
    assert 7 == GF.mul(gf, 2, 5)
    assert 3 == GF.mul(gf, 2, 6)
    assert 5 == GF.mul(gf, 2, 7)
    assert 4 == GF.mul(gf, 2, 8)
    assert 0 == GF.mul(gf, 3, 0)
    assert 3 == GF.mul(gf, 3, 1)
    assert 6 == GF.mul(gf, 3, 2)
    assert 4 == GF.mul(gf, 3, 3)
    assert 7 == GF.mul(gf, 3, 4)
    assert 1 == GF.mul(gf, 3, 5)
    assert 8 == GF.mul(gf, 3, 6)
    assert 2 == GF.mul(gf, 3, 7)
    assert 5 == GF.mul(gf, 3, 8)
    assert 0 == GF.mul(gf, 4, 0)
    assert 4 == GF.mul(gf, 4, 1)
    assert 8 == GF.mul(gf, 4, 2)
    assert 7 == GF.mul(gf, 4, 3)
    assert 2 == GF.mul(gf, 4, 4)
    assert 3 == GF.mul(gf, 4, 5)
    assert 5 == GF.mul(gf, 4, 6)
    assert 6 == GF.mul(gf, 4, 7)
    assert 1 == GF.mul(gf, 4, 8)
    assert 0 == GF.mul(gf, 5, 0)
    assert 5 == GF.mul(gf, 5, 1)
    assert 7 == GF.mul(gf, 5, 2)
    assert 1 == GF.mul(gf, 5, 3)
    assert 3 == GF.mul(gf, 5, 4)
    assert 8 == GF.mul(gf, 5, 5)
    assert 2 == GF.mul(gf, 5, 6)
    assert 4 == GF.mul(gf, 5, 7)
    assert 6 == GF.mul(gf, 5, 8)
    assert 0 == GF.mul(gf, 6, 0)
    assert 6 == GF.mul(gf, 6, 1)
    assert 3 == GF.mul(gf, 6, 2)
    assert 8 == GF.mul(gf, 6, 3)
    assert 5 == GF.mul(gf, 6, 4)
    assert 2 == GF.mul(gf, 6, 5)
    assert 4 == GF.mul(gf, 6, 6)
    assert 1 == GF.mul(gf, 6, 7)
    assert 7 == GF.mul(gf, 6, 8)
    assert 0 == GF.mul(gf, 7, 0)
    assert 7 == GF.mul(gf, 7, 1)
    assert 5 == GF.mul(gf, 7, 2)
    assert 2 == GF.mul(gf, 7, 3)
    assert 6 == GF.mul(gf, 7, 4)
    assert 4 == GF.mul(gf, 7, 5)
    assert 1 == GF.mul(gf, 7, 6)
    assert 8 == GF.mul(gf, 7, 7)
    assert 3 == GF.mul(gf, 7, 8)
    assert 0 == GF.mul(gf, 8, 0)
    assert 8 == GF.mul(gf, 8, 1)
    assert 4 == GF.mul(gf, 8, 2)
    assert 5 == GF.mul(gf, 8, 3)
    assert 1 == GF.mul(gf, 8, 4)
    assert 6 == GF.mul(gf, 8, 5)
    assert 7 == GF.mul(gf, 8, 6)
    assert 3 == GF.mul(gf, 8, 7)
    assert 2 == GF.mul(gf, 8, 8)
  end

  @tag :gen_test_mul
  test "GF(3, 3) mul" do
    gf = GF.new(3, 3, [1,2,0,1])
    assert 0 == GF.mul(gf, 0, 21)
    assert 0 == GF.mul(gf, 0, 26)
    assert 0 == GF.mul(gf, 0, 16)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 10)
    assert 0 == GF.mul(gf, 0, 12)
    assert 11 == GF.mul(gf, 1, 11)
    assert 11 == GF.mul(gf, 1, 11)
    assert 4 == GF.mul(gf, 2, 8)
    assert 9 == GF.mul(gf, 2, 18)
    assert 6 == GF.mul(gf, 2, 3)
    assert 2 == GF.mul(gf, 2, 1)
    assert 19 == GF.mul(gf, 2, 11)
    assert 26 == GF.mul(gf, 3, 16)
    assert 9 == GF.mul(gf, 3, 3)
    assert 21 == GF.mul(gf, 3, 7)
    assert 13 == GF.mul(gf, 3, 23)
    assert 8 == GF.mul(gf, 4, 2)
    assert 3 == GF.mul(gf, 4, 16)
    assert 9 == GF.mul(gf, 4, 26)
    assert 10 == GF.mul(gf, 4, 11)
    assert 9 == GF.mul(gf, 4, 26)
    assert 14 == GF.mul(gf, 4, 9)
    assert 8 == GF.mul(gf, 5, 26)
    assert 16 == GF.mul(gf, 5, 18)
    assert 2 == GF.mul(gf, 5, 12)
    assert 10 == GF.mul(gf, 6, 17)
    assert 5 == GF.mul(gf, 7, 2)
    assert 18 == GF.mul(gf, 7, 19)
    assert 6 == GF.mul(gf, 8, 16)
    assert 17 == GF.mul(gf, 9, 23)
    assert 8 == GF.mul(gf, 9, 22)
    assert 10 == GF.mul(gf, 9, 26)
    assert 23 == GF.mul(gf, 9, 5)
    assert 12 == GF.mul(gf, 9, 20)
    assert 8 == GF.mul(gf, 10, 3)
    assert 8 == GF.mul(gf, 10, 3)
    assert 14 == GF.mul(gf, 10, 7)
    assert 21 == GF.mul(gf, 11, 23)
    assert 15 == GF.mul(gf, 11, 16)
    assert 9 == GF.mul(gf, 11, 7)
    assert 3 == GF.mul(gf, 11, 18)
    assert 9 == GF.mul(gf, 11, 7)
    assert 7 == GF.mul(gf, 11, 15)
    assert 13 == GF.mul(gf, 12, 8)
    assert 3 == GF.mul(gf, 12, 21)
    assert 19 == GF.mul(gf, 13, 26)
    assert 22 == GF.mul(gf, 13, 6)
    assert 3 == GF.mul(gf, 13, 10)
    assert 2 == GF.mul(gf, 14, 9)
    assert 15 == GF.mul(gf, 14, 26)
    assert 4 == GF.mul(gf, 15, 23)
    assert 12 == GF.mul(gf, 15, 13)
    assert 13 == GF.mul(gf, 15, 9)
    assert 26 == GF.mul(gf, 16, 3)
    assert 14 == GF.mul(gf, 16, 26)
    assert 6 == GF.mul(gf, 16, 8)
    assert 0 == GF.mul(gf, 16, 0)
    assert 9 == GF.mul(gf, 16, 12)
    assert 2 == GF.mul(gf, 17, 13)
    assert 6 == GF.mul(gf, 17, 17)
    assert 25 == GF.mul(gf, 18, 4)
    assert 18 == GF.mul(gf, 19, 7)
    assert 8 == GF.mul(gf, 19, 24)
    assert 18 == GF.mul(gf, 19, 7)
    assert 7 == GF.mul(gf, 19, 21)
    assert 11 == GF.mul(gf, 19, 2)
    assert 16 == GF.mul(gf, 20, 12)
    assert 20 == GF.mul(gf, 20, 1)
    assert 23 == GF.mul(gf, 21, 6)
    assert 26 == GF.mul(gf, 21, 9)
    assert 26 == GF.mul(gf, 21, 9)
    assert 20 == GF.mul(gf, 22, 6)
    assert 0 == GF.mul(gf, 22, 0)
    assert 2 == GF.mul(gf, 22, 26)
    assert 5 == GF.mul(gf, 22, 4)
    assert 26 == GF.mul(gf, 23, 6)
    assert 21 == GF.mul(gf, 23, 11)
    assert 2 == GF.mul(gf, 23, 20)
    assert 17 == GF.mul(gf, 23, 9)
    assert 25 == GF.mul(gf, 24, 3)
    assert 8 == GF.mul(gf, 24, 19)
    assert 26 == GF.mul(gf, 24, 8)
    assert 17 == GF.mul(gf, 24, 12)
    assert 23 == GF.mul(gf, 24, 20)
    assert 22 == GF.mul(gf, 24, 24)
    assert 22 == GF.mul(gf, 24, 24)
    assert 22 == GF.mul(gf, 24, 24)
    assert 3 == GF.mul(gf, 24, 15)
    assert 16 == GF.mul(gf, 25, 22)
    assert 15 == GF.mul(gf, 25, 13)
    assert 20 == GF.mul(gf, 25, 12)
    assert 3 == GF.mul(gf, 25, 5)
    assert 11 == GF.mul(gf, 25, 6)
    assert 11 == GF.mul(gf, 25, 6)
    assert 12 == GF.mul(gf, 26, 21)
    assert 19 == GF.mul(gf, 26, 13)
    assert 4 == GF.mul(gf, 26, 7)
    assert 16 == GF.mul(gf, 26, 19)
    assert 11 == GF.mul(gf, 26, 26)
  end

  @tag :gen_test_mul
  test "GF(5, 1) mul" do
    gf = GF.new(5, 1, [3,1])
    assert 0 == GF.mul(gf, 0, 0)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 2)
    assert 0 == GF.mul(gf, 0, 3)
    assert 0 == GF.mul(gf, 0, 4)
    assert 0 == GF.mul(gf, 1, 0)
    assert 1 == GF.mul(gf, 1, 1)
    assert 2 == GF.mul(gf, 1, 2)
    assert 3 == GF.mul(gf, 1, 3)
    assert 4 == GF.mul(gf, 1, 4)
    assert 0 == GF.mul(gf, 2, 0)
    assert 2 == GF.mul(gf, 2, 1)
    assert 4 == GF.mul(gf, 2, 2)
    assert 1 == GF.mul(gf, 2, 3)
    assert 3 == GF.mul(gf, 2, 4)
    assert 0 == GF.mul(gf, 3, 0)
    assert 3 == GF.mul(gf, 3, 1)
    assert 1 == GF.mul(gf, 3, 2)
    assert 4 == GF.mul(gf, 3, 3)
    assert 2 == GF.mul(gf, 3, 4)
    assert 0 == GF.mul(gf, 4, 0)
    assert 4 == GF.mul(gf, 4, 1)
    assert 3 == GF.mul(gf, 4, 2)
    assert 2 == GF.mul(gf, 4, 3)
    assert 1 == GF.mul(gf, 4, 4)
  end

  @tag :gen_test_mul
  test "GF(5, 2) mul" do
    gf = GF.new(5, 2, [2,4,1])
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 12)
    assert 0 == GF.mul(gf, 0, 3)
    assert 18 == GF.mul(gf, 1, 18)
    assert 14 == GF.mul(gf, 1, 14)
    assert 19 == GF.mul(gf, 2, 22)
    assert 2 == GF.mul(gf, 2, 1)
    assert 18 == GF.mul(gf, 2, 24)
    assert 8 == GF.mul(gf, 2, 19)
    assert 16 == GF.mul(gf, 3, 7)
    assert 8 == GF.mul(gf, 4, 22)
    assert 8 == GF.mul(gf, 4, 22)
    assert 24 == GF.mul(gf, 4, 6)
    assert 24 == GF.mul(gf, 4, 6)
    assert 5 == GF.mul(gf, 5, 1)
    assert 20 == GF.mul(gf, 5, 4)
    assert 0 == GF.mul(gf, 5, 0)
    assert 12 == GF.mul(gf, 6, 2)
    assert 16 == GF.mul(gf, 6, 17)
    assert 18 == GF.mul(gf, 6, 3)
    assert 0 == GF.mul(gf, 6, 0)
    assert 16 == GF.mul(gf, 6, 17)
    assert 17 == GF.mul(gf, 7, 19)
    assert 18 == GF.mul(gf, 7, 5)
    assert 20 == GF.mul(gf, 8, 17)
    assert 4 == GF.mul(gf, 8, 24)
    assert 1 == GF.mul(gf, 8, 6)
    assert 9 == GF.mul(gf, 8, 7)
    assert 10 == GF.mul(gf, 9, 22)
    assert 18 == GF.mul(gf, 9, 13)
    assert 21 == GF.mul(gf, 9, 4)
    assert 14 == GF.mul(gf, 9, 12)
    assert 24 == GF.mul(gf, 9, 9)
    assert 13 == GF.mul(gf, 9, 2)
    assert 5 == GF.mul(gf, 9, 11)
    assert 21 == GF.mul(gf, 10, 6)
    assert 20 == GF.mul(gf, 10, 2)
    assert 8 == GF.mul(gf, 10, 15)
    assert 11 == GF.mul(gf, 10, 5)
    assert 16 == GF.mul(gf, 10, 8)
    assert 6 == GF.mul(gf, 10, 7)
    assert 22 == GF.mul(gf, 10, 10)
    assert 21 == GF.mul(gf, 11, 14)
    assert 24 == GF.mul(gf, 11, 8)
    assert 9 == GF.mul(gf, 11, 16)
    assert 22 == GF.mul(gf, 11, 2)
    assert 5 == GF.mul(gf, 11, 9)
    assert 7 == GF.mul(gf, 11, 10)
    assert 3 == GF.mul(gf, 11, 24)
    assert 23 == GF.mul(gf, 11, 15)
    assert 2 == GF.mul(gf, 11, 6)
    assert 10 == GF.mul(gf, 12, 23)
    assert 17 == GF.mul(gf, 12, 10)
    assert 0 == GF.mul(gf, 12, 0)
    assert 15 == GF.mul(gf, 12, 7)
    assert 23 == GF.mul(gf, 12, 13)
    assert 3 == GF.mul(gf, 13, 15)
    assert 1 == GF.mul(gf, 13, 5)
    assert 21 == GF.mul(gf, 13, 2)
    assert 23 == GF.mul(gf, 14, 2)
    assert 24 == GF.mul(gf, 14, 20)
    assert 5 == GF.mul(gf, 14, 12)
    assert 22 == GF.mul(gf, 15, 15)
    assert 14 == GF.mul(gf, 15, 8)
    assert 4 == GF.mul(gf, 15, 9)
    assert 11 == GF.mul(gf, 15, 20)
    assert 12 == GF.mul(gf, 15, 16)
    assert 11 == GF.mul(gf, 15, 20)
    assert 23 == GF.mul(gf, 16, 3)
    assert 6 == GF.mul(gf, 16, 20)
    assert 4 == GF.mul(gf, 16, 23)
    assert 9 == GF.mul(gf, 16, 11)
    assert 15 == GF.mul(gf, 16, 24)
    assert 20 == GF.mul(gf, 16, 12)
    assert 8 == GF.mul(gf, 16, 9)
    assert 6 == GF.mul(gf, 17, 17)
    assert 9 == GF.mul(gf, 17, 2)
    assert 17 == GF.mul(gf, 17, 1)
    assert 13 == GF.mul(gf, 17, 4)
    assert 18 == GF.mul(gf, 18, 1)
    assert 18 == GF.mul(gf, 18, 1)
    assert 2 == GF.mul(gf, 18, 22)
    assert 7 == GF.mul(gf, 18, 13)
    assert 0 == GF.mul(gf, 18, 0)
    assert 22 == GF.mul(gf, 18, 6)
    assert 8 == GF.mul(gf, 18, 24)
    assert 20 == GF.mul(gf, 18, 14)
    assert 7 == GF.mul(gf, 19, 15)
    assert 12 == GF.mul(gf, 19, 11)
    assert 17 == GF.mul(gf, 19, 7)
    assert 8 == GF.mul(gf, 19, 2)
    assert 0 == GF.mul(gf, 20, 0)
    assert 0 == GF.mul(gf, 20, 0)
    assert 17 == GF.mul(gf, 20, 6)
    assert 10 == GF.mul(gf, 22, 9)
    assert 5 == GF.mul(gf, 23, 6)
    assert 13 == GF.mul(gf, 23, 19)
    assert 14 == GF.mul(gf, 24, 17)
    assert 17 == GF.mul(gf, 24, 5)
    assert 5 == GF.mul(gf, 24, 7)
  end

  @tag :gen_test_mul
  test "GF(5, 3) mul" do
    gf = GF.new(5, 3, [3,3,0,1])
    assert 0 == GF.mul(gf, 0, 96)
    assert 0 == GF.mul(gf, 0, 104)
    assert 0 == GF.mul(gf, 0, 10)
    assert 26 == GF.mul(gf, 1, 26)
    assert 70 == GF.mul(gf, 1, 70)
    assert 55 == GF.mul(gf, 3, 110)
    assert 54 == GF.mul(gf, 3, 103)
    assert 52 == GF.mul(gf, 3, 104)
    assert 101 == GF.mul(gf, 4, 29)
    assert 81 == GF.mul(gf, 4, 74)
    assert 75 == GF.mul(gf, 6, 79)
    assert 15 == GF.mul(gf, 6, 66)
    assert 3 == GF.mul(gf, 7, 96)
    assert 20 == GF.mul(gf, 8, 36)
    assert 100 == GF.mul(gf, 12, 51)
    assert 81 == GF.mul(gf, 12, 100)
    assert 29 == GF.mul(gf, 14, 102)
    assert 124 == GF.mul(gf, 15, 115)
    assert 21 == GF.mul(gf, 15, 26)
    assert 26 == GF.mul(gf, 16, 11)
    assert 104 == GF.mul(gf, 16, 19)
    assert 112 == GF.mul(gf, 16, 89)
    assert 53 == GF.mul(gf, 17, 24)
    assert 6 == GF.mul(gf, 19, 71)
    assert 107 == GF.mul(gf, 19, 18)
    assert 97 == GF.mul(gf, 20, 113)
    assert 24 == GF.mul(gf, 20, 75)
    assert 67 == GF.mul(gf, 21, 49)
    assert 89 == GF.mul(gf, 22, 12)
    assert 102 == GF.mul(gf, 23, 62)
    assert 74 == GF.mul(gf, 24, 75)
    assert 105 == GF.mul(gf, 25, 78)
    assert 48 == GF.mul(gf, 26, 114)
    assert 77 == GF.mul(gf, 27, 39)
    assert 21 == GF.mul(gf, 28, 65)
    assert 100 == GF.mul(gf, 30, 48)
    assert 106 == GF.mul(gf, 30, 122)
    assert 50 == GF.mul(gf, 34, 43)
    assert 98 == GF.mul(gf, 35, 37)
    assert 9 == GF.mul(gf, 36, 120)
    assert 2 == GF.mul(gf, 36, 54)
    assert 113 == GF.mul(gf, 37, 99)
    assert 36 == GF.mul(gf, 39, 44)
    assert 73 == GF.mul(gf, 40, 69)
    assert 89 == GF.mul(gf, 41, 52)
    assert 111 == GF.mul(gf, 43, 72)
    assert 43 == GF.mul(gf, 46, 74)
    assert 57 == GF.mul(gf, 48, 64)
    assert 61 == GF.mul(gf, 50, 123)
    assert 44 == GF.mul(gf, 52, 52)
    assert 124 == GF.mul(gf, 52, 88)
    assert 9 == GF.mul(gf, 54, 93)
    assert 54 == GF.mul(gf, 55, 89)
    assert 121 == GF.mul(gf, 56, 52)
    assert 59 == GF.mul(gf, 58, 102)
    assert 49 == GF.mul(gf, 60, 94)
    assert 124 == GF.mul(gf, 60, 112)
    assert 18 == GF.mul(gf, 60, 51)
    assert 26 == GF.mul(gf, 62, 122)
    assert 25 == GF.mul(gf, 62, 42)
    assert 114 == GF.mul(gf, 65, 104)
    assert 89 == GF.mul(gf, 67, 32)
    assert 104 == GF.mul(gf, 68, 56)
    assert 80 == GF.mul(gf, 68, 58)
    assert 57 == GF.mul(gf, 69, 106)
    assert 118 == GF.mul(gf, 71, 49)
    assert 29 == GF.mul(gf, 71, 81)
    assert 89 == GF.mul(gf, 72, 86)
    assert 111 == GF.mul(gf, 78, 52)
    assert 77 == GF.mul(gf, 81, 38)
    assert 58 == GF.mul(gf, 83, 56)
    assert 117 == GF.mul(gf, 84, 3)
    assert 26 == GF.mul(gf, 85, 66)
    assert 47 == GF.mul(gf, 88, 124)
    assert 58 == GF.mul(gf, 89, 98)
    assert 115 == GF.mul(gf, 95, 116)
    assert 122 == GF.mul(gf, 95, 49)
    assert 115 == GF.mul(gf, 98, 19)
    assert 8 == GF.mul(gf, 104, 113)
    assert 63 == GF.mul(gf, 105, 9)
    assert 93 == GF.mul(gf, 105, 37)
    assert 124 == GF.mul(gf, 106, 73)
    assert 49 == GF.mul(gf, 107, 79)
    assert 118 == GF.mul(gf, 108, 53)
    assert 7 == GF.mul(gf, 108, 64)
    assert 104 == GF.mul(gf, 114, 57)
    assert 93 == GF.mul(gf, 116, 106)
    assert 9 == GF.mul(gf, 117, 100)
    assert 5 == GF.mul(gf, 117, 61)
    assert 58 == GF.mul(gf, 118, 29)
    assert 31 == GF.mul(gf, 119, 21)
    assert 3 == GF.mul(gf, 119, 54)
    assert 68 == GF.mul(gf, 119, 123)
    assert 80 == GF.mul(gf, 120, 65)
    assert 56 == GF.mul(gf, 120, 117)
    assert 44 == GF.mul(gf, 120, 16)
    assert 9 == GF.mul(gf, 121, 98)
    assert 117 == GF.mul(gf, 122, 80)
    assert 71 == GF.mul(gf, 124, 69)
    assert 88 == GF.mul(gf, 124, 64)
  end

  @tag :gen_test_mul
  test "GF(7, 1) mul" do
    gf = GF.new(7, 1, [4,1])
    assert 0 == GF.mul(gf, 0, 0)
    assert 0 == GF.mul(gf, 0, 1)
    assert 0 == GF.mul(gf, 0, 2)
    assert 0 == GF.mul(gf, 0, 3)
    assert 0 == GF.mul(gf, 0, 4)
    assert 0 == GF.mul(gf, 0, 5)
    assert 0 == GF.mul(gf, 0, 6)
    assert 0 == GF.mul(gf, 1, 0)
    assert 1 == GF.mul(gf, 1, 1)
    assert 2 == GF.mul(gf, 1, 2)
    assert 3 == GF.mul(gf, 1, 3)
    assert 4 == GF.mul(gf, 1, 4)
    assert 5 == GF.mul(gf, 1, 5)
    assert 6 == GF.mul(gf, 1, 6)
    assert 0 == GF.mul(gf, 2, 0)
    assert 2 == GF.mul(gf, 2, 1)
    assert 4 == GF.mul(gf, 2, 2)
    assert 6 == GF.mul(gf, 2, 3)
    assert 1 == GF.mul(gf, 2, 4)
    assert 3 == GF.mul(gf, 2, 5)
    assert 5 == GF.mul(gf, 2, 6)
    assert 0 == GF.mul(gf, 3, 0)
    assert 3 == GF.mul(gf, 3, 1)
    assert 6 == GF.mul(gf, 3, 2)
    assert 2 == GF.mul(gf, 3, 3)
    assert 5 == GF.mul(gf, 3, 4)
    assert 1 == GF.mul(gf, 3, 5)
    assert 4 == GF.mul(gf, 3, 6)
    assert 0 == GF.mul(gf, 4, 0)
    assert 4 == GF.mul(gf, 4, 1)
    assert 1 == GF.mul(gf, 4, 2)
    assert 5 == GF.mul(gf, 4, 3)
    assert 2 == GF.mul(gf, 4, 4)
    assert 6 == GF.mul(gf, 4, 5)
    assert 3 == GF.mul(gf, 4, 6)
    assert 0 == GF.mul(gf, 5, 0)
    assert 5 == GF.mul(gf, 5, 1)
    assert 3 == GF.mul(gf, 5, 2)
    assert 1 == GF.mul(gf, 5, 3)
    assert 6 == GF.mul(gf, 5, 4)
    assert 4 == GF.mul(gf, 5, 5)
    assert 2 == GF.mul(gf, 5, 6)
    assert 0 == GF.mul(gf, 6, 0)
    assert 6 == GF.mul(gf, 6, 1)
    assert 5 == GF.mul(gf, 6, 2)
    assert 4 == GF.mul(gf, 6, 3)
    assert 3 == GF.mul(gf, 6, 4)
    assert 2 == GF.mul(gf, 6, 5)
    assert 1 == GF.mul(gf, 6, 6)
  end

  @tag :gen_test_mul
  test "GF(7, 2) mul" do
    gf = GF.new(7, 2, [3,6,1])
    assert 0 == GF.mul(gf, 0, 23)
    assert 15 == GF.mul(gf, 1, 15)
    assert 21 == GF.mul(gf, 1, 21)
    assert 18 == GF.mul(gf, 1, 18)
    assert 44 == GF.mul(gf, 2, 22)
    assert 5 == GF.mul(gf, 2, 6)
    assert 48 == GF.mul(gf, 3, 16)
    assert 44 == GF.mul(gf, 3, 17)
    assert 10 == GF.mul(gf, 4, 20)
    assert 25 == GF.mul(gf, 4, 43)
    assert 35 == GF.mul(gf, 5, 7)
    assert 15 == GF.mul(gf, 5, 45)
    assert 5 == GF.mul(gf, 5, 1)
    assert 36 == GF.mul(gf, 6, 20)
    assert 38 == GF.mul(gf, 6, 18)
    assert 29 == GF.mul(gf, 6, 27)
    assert 41 == GF.mul(gf, 6, 15)
    assert 2 == GF.mul(gf, 6, 5)
    assert 4 == GF.mul(gf, 6, 3)
    assert 44 == GF.mul(gf, 7, 30)
    assert 37 == GF.mul(gf, 7, 29)
    assert 15 == GF.mul(gf, 7, 14)
    assert 23 == GF.mul(gf, 7, 34)
    assert 24 == GF.mul(gf, 7, 46)
    assert 3 == GF.mul(gf, 7, 43)
    assert 7 == GF.mul(gf, 9, 12)
    assert 37 == GF.mul(gf, 9, 28)
    assert 19 == GF.mul(gf, 11, 40)
    assert 4 == GF.mul(gf, 12, 16)
    assert 47 == GF.mul(gf, 12, 39)
    assert 22 == GF.mul(gf, 13, 10)
    assert 11 == GF.mul(gf, 13, 22)
    assert 28 == GF.mul(gf, 14, 2)
    assert 0 == GF.mul(gf, 14, 0)
    assert 4 == GF.mul(gf, 15, 47)
    assert 2 == GF.mul(gf, 16, 34)
    assert 48 == GF.mul(gf, 16, 3)
    assert 34 == GF.mul(gf, 17, 2)
    assert 8 == GF.mul(gf, 17, 45)
    assert 22 == GF.mul(gf, 18, 24)
    assert 32 == GF.mul(gf, 18, 13)
    assert 35 == GF.mul(gf, 18, 44)
    assert 44 == GF.mul(gf, 18, 48)
    assert 1 == GF.mul(gf, 19, 7)
    assert 39 == GF.mul(gf, 21, 41)
    assert 14 == GF.mul(gf, 21, 3)
    assert 47 == GF.mul(gf, 21, 8)
    assert 26 == GF.mul(gf, 22, 25)
    assert 48 == GF.mul(gf, 22, 26)
    assert 13 == GF.mul(gf, 22, 46)
    assert 40 == GF.mul(gf, 23, 7)
    assert 48 == GF.mul(gf, 24, 2)
    assert 32 == GF.mul(gf, 24, 6)
    assert 43 == GF.mul(gf, 24, 41)
    assert 4 == GF.mul(gf, 25, 35)
    assert 2 == GF.mul(gf, 25, 42)
    assert 40 == GF.mul(gf, 26, 44)
    assert 15 == GF.mul(gf, 28, 28)
    assert 48 == GF.mul(gf, 28, 23)
    assert 46 == GF.mul(gf, 29, 9)
    assert 21 == GF.mul(gf, 29, 44)
    assert 30 == GF.mul(gf, 31, 22)
    assert 24 == GF.mul(gf, 31, 27)
    assert 44 == GF.mul(gf, 32, 27)
    assert 6 == GF.mul(gf, 32, 44)
    assert 42 == GF.mul(gf, 33, 8)
    assert 31 == GF.mul(gf, 33, 34)
    assert 28 == GF.mul(gf, 34, 9)
    assert 30 == GF.mul(gf, 34, 25)
    assert 16 == GF.mul(gf, 34, 45)
    assert 23 == GF.mul(gf, 34, 7)
    assert 48 == GF.mul(gf, 34, 30)
    assert 43 == GF.mul(gf, 34, 46)
    assert 18 == GF.mul(gf, 35, 24)
    assert 11 == GF.mul(gf, 35, 21)
    assert 8 == GF.mul(gf, 39, 11)
    assert 22 == GF.mul(gf, 39, 2)
    assert 46 == GF.mul(gf, 40, 31)
    assert 26 == GF.mul(gf, 40, 24)
    assert 19 == GF.mul(gf, 41, 8)
    assert 41 == GF.mul(gf, 41, 1)
    assert 30 == GF.mul(gf, 41, 5)
    assert 24 == GF.mul(gf, 42, 10)
    assert 43 == GF.mul(gf, 43, 1)
    assert 41 == GF.mul(gf, 43, 44)
    assert 12 == GF.mul(gf, 44, 6)
    assert 16 == GF.mul(gf, 44, 30)
    assert 39 == GF.mul(gf, 44, 2)
    assert 27 == GF.mul(gf, 45, 33)
    assert 7 == GF.mul(gf, 45, 37)
    assert 19 == GF.mul(gf, 46, 44)
    assert 43 == GF.mul(gf, 46, 34)
    assert 24 == GF.mul(gf, 46, 7)
    assert 11 == GF.mul(gf, 47, 10)
    assert 15 == GF.mul(gf, 47, 20)
    assert 19 == GF.mul(gf, 47, 28)
    assert 31 == GF.mul(gf, 48, 30)
    assert 2 == GF.mul(gf, 48, 44)
    assert 42 == GF.mul(gf, 48, 23)
    assert 13 == GF.mul(gf, 48, 11)
  end

  @tag :gen_test_mul
  test "GF(7, 3) mul" do
    gf = GF.new(7, 3, [4,0,6,1])
    assert 298 == GF.mul(gf, 7, 294)
    assert 213 == GF.mul(gf, 10, 194)
    assert 327 == GF.mul(gf, 19, 320)
    assert 162 == GF.mul(gf, 22, 297)
    assert 215 == GF.mul(gf, 27, 74)
    assert 17 == GF.mul(gf, 31, 53)
    assert 284 == GF.mul(gf, 35, 225)
    assert 58 == GF.mul(gf, 35, 108)
    assert 45 == GF.mul(gf, 39, 229)
    assert 48 == GF.mul(gf, 41, 272)
    assert 16 == GF.mul(gf, 44, 339)
    assert 240 == GF.mul(gf, 46, 114)
    assert 195 == GF.mul(gf, 48, 252)
    assert 267 == GF.mul(gf, 51, 35)
    assert 64 == GF.mul(gf, 55, 148)
    assert 167 == GF.mul(gf, 55, 150)
    assert 225 == GF.mul(gf, 61, 259)
    assert 269 == GF.mul(gf, 68, 57)
    assert 112 == GF.mul(gf, 69, 141)
    assert 256 == GF.mul(gf, 75, 5)
    assert 147 == GF.mul(gf, 76, 161)
    assert 97 == GF.mul(gf, 79, 244)
    assert 332 == GF.mul(gf, 84, 123)
    assert 323 == GF.mul(gf, 85, 292)
    assert 256 == GF.mul(gf, 88, 104)
    assert 266 == GF.mul(gf, 92, 335)
    assert 181 == GF.mul(gf, 92, 161)
    assert 43 == GF.mul(gf, 94, 293)
    assert 107 == GF.mul(gf, 95, 290)
    assert 29 == GF.mul(gf, 99, 260)
    assert 315 == GF.mul(gf, 105, 3)
    assert 198 == GF.mul(gf, 106, 150)
    assert 266 == GF.mul(gf, 106, 109)
    assert 315 == GF.mul(gf, 111, 329)
    assert 247 == GF.mul(gf, 112, 265)
    assert 40 == GF.mul(gf, 119, 241)
    assert 336 == GF.mul(gf, 121, 313)
    assert 308 == GF.mul(gf, 121, 142)
    assert 38 == GF.mul(gf, 129, 233)
    assert 96 == GF.mul(gf, 132, 138)
    assert 214 == GF.mul(gf, 132, 86)
    assert 335 == GF.mul(gf, 139, 56)
    assert 142 == GF.mul(gf, 143, 47)
    assert 281 == GF.mul(gf, 144, 172)
    assert 49 == GF.mul(gf, 158, 46)
    assert 265 == GF.mul(gf, 160, 252)
    assert 311 == GF.mul(gf, 161, 132)
    assert 180 == GF.mul(gf, 170, 254)
    assert 255 == GF.mul(gf, 171, 239)
    assert 134 == GF.mul(gf, 172, 272)
    assert 130 == GF.mul(gf, 175, 164)
    assert 226 == GF.mul(gf, 182, 276)
    assert 244 == GF.mul(gf, 182, 225)
    assert 245 == GF.mul(gf, 187, 125)
    assert 137 == GF.mul(gf, 188, 14)
    assert 129 == GF.mul(gf, 188, 121)
    assert 247 == GF.mul(gf, 189, 248)
    assert 279 == GF.mul(gf, 192, 90)
    assert 305 == GF.mul(gf, 196, 161)
    assert 74 == GF.mul(gf, 196, 123)
    assert 295 == GF.mul(gf, 202, 85)
    assert 235 == GF.mul(gf, 202, 20)
    assert 155 == GF.mul(gf, 203, 52)
    assert 218 == GF.mul(gf, 204, 192)
    assert 36 == GF.mul(gf, 211, 145)
    assert 116 == GF.mul(gf, 212, 331)
    assert 20 == GF.mul(gf, 214, 68)
    assert 113 == GF.mul(gf, 222, 230)
    assert 195 == GF.mul(gf, 227, 38)
    assert 106 == GF.mul(gf, 228, 67)
    assert 251 == GF.mul(gf, 230, 172)
    assert 192 == GF.mul(gf, 231, 87)
    assert 82 == GF.mul(gf, 231, 12)
    assert 298 == GF.mul(gf, 233, 56)
    assert 170 == GF.mul(gf, 235, 260)
    assert 19 == GF.mul(gf, 237, 67)
    assert 204 == GF.mul(gf, 240, 100)
    assert 330 == GF.mul(gf, 241, 176)
    assert 281 == GF.mul(gf, 241, 173)
    assert 139 == GF.mul(gf, 260, 6)
    assert 38 == GF.mul(gf, 267, 15)
    assert 146 == GF.mul(gf, 268, 57)
    assert 1 == GF.mul(gf, 270, 229)
    assert 34 == GF.mul(gf, 282, 183)
    assert 281 == GF.mul(gf, 283, 45)
    assert 103 == GF.mul(gf, 287, 50)
    assert 62 == GF.mul(gf, 292, 193)
    assert 315 == GF.mul(gf, 293, 172)
    assert 196 == GF.mul(gf, 294, 3)
    assert 284 == GF.mul(gf, 305, 44)
    assert 272 == GF.mul(gf, 310, 35)
    assert 182 == GF.mul(gf, 311, 120)
    assert 323 == GF.mul(gf, 317, 94)
    assert 224 == GF.mul(gf, 320, 72)
    assert 101 == GF.mul(gf, 323, 130)
    assert 17 == GF.mul(gf, 324, 171)
    assert 228 == GF.mul(gf, 331, 202)
    assert 127 == GF.mul(gf, 334, 202)
    assert 216 == GF.mul(gf, 341, 259)
    assert 192 == GF.mul(gf, 341, 185)
  end
end
