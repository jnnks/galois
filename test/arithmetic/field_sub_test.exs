defmodule SubTest do
  use ExUnit.Case

  @tag :gen_test_sub
  test "GF(2, 1) sub" do
    gf = GF.new(2, 1, [1,1])
    assert 0 == GF.sub(gf, 0, 0)
    assert 1 == GF.sub(gf, 0, 1)
    assert 1 == GF.sub(gf, 1, 0)
    assert 0 == GF.sub(gf, 1, 1)
  end

  @tag :gen_test_sub
  test "GF(2, 2) sub" do
    gf = GF.new(2, 2, [1,1,1])
    assert 0 == GF.sub(gf, 0, 0)
    assert 1 == GF.sub(gf, 0, 1)
    assert 2 == GF.sub(gf, 0, 2)
    assert 3 == GF.sub(gf, 0, 3)
    assert 1 == GF.sub(gf, 1, 0)
    assert 0 == GF.sub(gf, 1, 1)
    assert 3 == GF.sub(gf, 1, 2)
    assert 2 == GF.sub(gf, 1, 3)
    assert 2 == GF.sub(gf, 2, 0)
    assert 3 == GF.sub(gf, 2, 1)
    assert 0 == GF.sub(gf, 2, 2)
    assert 1 == GF.sub(gf, 2, 3)
    assert 3 == GF.sub(gf, 3, 0)
    assert 2 == GF.sub(gf, 3, 1)
    assert 1 == GF.sub(gf, 3, 2)
    assert 0 == GF.sub(gf, 3, 3)
  end

  @tag :gen_test_sub
  test "GF(2, 3) sub" do
    gf = GF.new(2, 3, [1,1,0,1])
    assert 0 == GF.sub(gf, 0, 0)
    assert 1 == GF.sub(gf, 0, 1)
    assert 2 == GF.sub(gf, 0, 2)
    assert 3 == GF.sub(gf, 0, 3)
    assert 4 == GF.sub(gf, 0, 4)
    assert 5 == GF.sub(gf, 0, 5)
    assert 6 == GF.sub(gf, 0, 6)
    assert 7 == GF.sub(gf, 0, 7)
    assert 1 == GF.sub(gf, 1, 0)
    assert 0 == GF.sub(gf, 1, 1)
    assert 3 == GF.sub(gf, 1, 2)
    assert 2 == GF.sub(gf, 1, 3)
    assert 5 == GF.sub(gf, 1, 4)
    assert 4 == GF.sub(gf, 1, 5)
    assert 7 == GF.sub(gf, 1, 6)
    assert 6 == GF.sub(gf, 1, 7)
    assert 2 == GF.sub(gf, 2, 0)
    assert 3 == GF.sub(gf, 2, 1)
    assert 0 == GF.sub(gf, 2, 2)
    assert 1 == GF.sub(gf, 2, 3)
    assert 6 == GF.sub(gf, 2, 4)
    assert 7 == GF.sub(gf, 2, 5)
    assert 4 == GF.sub(gf, 2, 6)
    assert 5 == GF.sub(gf, 2, 7)
    assert 3 == GF.sub(gf, 3, 0)
    assert 2 == GF.sub(gf, 3, 1)
    assert 1 == GF.sub(gf, 3, 2)
    assert 0 == GF.sub(gf, 3, 3)
    assert 7 == GF.sub(gf, 3, 4)
    assert 6 == GF.sub(gf, 3, 5)
    assert 5 == GF.sub(gf, 3, 6)
    assert 4 == GF.sub(gf, 3, 7)
    assert 4 == GF.sub(gf, 4, 0)
    assert 5 == GF.sub(gf, 4, 1)
    assert 6 == GF.sub(gf, 4, 2)
    assert 7 == GF.sub(gf, 4, 3)
    assert 0 == GF.sub(gf, 4, 4)
    assert 1 == GF.sub(gf, 4, 5)
    assert 2 == GF.sub(gf, 4, 6)
    assert 3 == GF.sub(gf, 4, 7)
    assert 5 == GF.sub(gf, 5, 0)
    assert 4 == GF.sub(gf, 5, 1)
    assert 7 == GF.sub(gf, 5, 2)
    assert 6 == GF.sub(gf, 5, 3)
    assert 1 == GF.sub(gf, 5, 4)
    assert 0 == GF.sub(gf, 5, 5)
    assert 3 == GF.sub(gf, 5, 6)
    assert 2 == GF.sub(gf, 5, 7)
    assert 6 == GF.sub(gf, 6, 0)
    assert 7 == GF.sub(gf, 6, 1)
    assert 4 == GF.sub(gf, 6, 2)
    assert 5 == GF.sub(gf, 6, 3)
    assert 2 == GF.sub(gf, 6, 4)
    assert 3 == GF.sub(gf, 6, 5)
    assert 0 == GF.sub(gf, 6, 6)
    assert 1 == GF.sub(gf, 6, 7)
    assert 7 == GF.sub(gf, 7, 0)
    assert 6 == GF.sub(gf, 7, 1)
    assert 5 == GF.sub(gf, 7, 2)
    assert 4 == GF.sub(gf, 7, 3)
    assert 3 == GF.sub(gf, 7, 4)
    assert 2 == GF.sub(gf, 7, 5)
    assert 1 == GF.sub(gf, 7, 6)
    assert 0 == GF.sub(gf, 7, 7)
  end

  @tag :gen_test_sub
  test "GF(3, 1) sub" do
    gf = GF.new(3, 1, [1,1])
    assert 0 == GF.sub(gf, 0, 0)
    assert 2 == GF.sub(gf, 0, 1)
    assert 1 == GF.sub(gf, 0, 2)
    assert 1 == GF.sub(gf, 1, 0)
    assert 0 == GF.sub(gf, 1, 1)
    assert 2 == GF.sub(gf, 1, 2)
    assert 2 == GF.sub(gf, 2, 0)
    assert 1 == GF.sub(gf, 2, 1)
    assert 0 == GF.sub(gf, 2, 2)
  end

  @tag :gen_test_sub
  test "GF(3, 2) sub" do
    gf = GF.new(3, 2, [2,2,1])
    assert 0 == GF.sub(gf, 0, 0)
    assert 2 == GF.sub(gf, 0, 1)
    assert 1 == GF.sub(gf, 0, 2)
    assert 6 == GF.sub(gf, 0, 3)
    assert 8 == GF.sub(gf, 0, 4)
    assert 7 == GF.sub(gf, 0, 5)
    assert 3 == GF.sub(gf, 0, 6)
    assert 5 == GF.sub(gf, 0, 7)
    assert 4 == GF.sub(gf, 0, 8)
    assert 1 == GF.sub(gf, 1, 0)
    assert 0 == GF.sub(gf, 1, 1)
    assert 2 == GF.sub(gf, 1, 2)
    assert 7 == GF.sub(gf, 1, 3)
    assert 6 == GF.sub(gf, 1, 4)
    assert 8 == GF.sub(gf, 1, 5)
    assert 4 == GF.sub(gf, 1, 6)
    assert 3 == GF.sub(gf, 1, 7)
    assert 5 == GF.sub(gf, 1, 8)
    assert 2 == GF.sub(gf, 2, 0)
    assert 1 == GF.sub(gf, 2, 1)
    assert 0 == GF.sub(gf, 2, 2)
    assert 8 == GF.sub(gf, 2, 3)
    assert 7 == GF.sub(gf, 2, 4)
    assert 6 == GF.sub(gf, 2, 5)
    assert 5 == GF.sub(gf, 2, 6)
    assert 4 == GF.sub(gf, 2, 7)
    assert 3 == GF.sub(gf, 2, 8)
    assert 3 == GF.sub(gf, 3, 0)
    assert 5 == GF.sub(gf, 3, 1)
    assert 4 == GF.sub(gf, 3, 2)
    assert 0 == GF.sub(gf, 3, 3)
    assert 2 == GF.sub(gf, 3, 4)
    assert 1 == GF.sub(gf, 3, 5)
    assert 6 == GF.sub(gf, 3, 6)
    assert 8 == GF.sub(gf, 3, 7)
    assert 7 == GF.sub(gf, 3, 8)
    assert 4 == GF.sub(gf, 4, 0)
    assert 3 == GF.sub(gf, 4, 1)
    assert 5 == GF.sub(gf, 4, 2)
    assert 1 == GF.sub(gf, 4, 3)
    assert 0 == GF.sub(gf, 4, 4)
    assert 2 == GF.sub(gf, 4, 5)
    assert 7 == GF.sub(gf, 4, 6)
    assert 6 == GF.sub(gf, 4, 7)
    assert 8 == GF.sub(gf, 4, 8)
    assert 5 == GF.sub(gf, 5, 0)
    assert 4 == GF.sub(gf, 5, 1)
    assert 3 == GF.sub(gf, 5, 2)
    assert 2 == GF.sub(gf, 5, 3)
    assert 1 == GF.sub(gf, 5, 4)
    assert 0 == GF.sub(gf, 5, 5)
    assert 8 == GF.sub(gf, 5, 6)
    assert 7 == GF.sub(gf, 5, 7)
    assert 6 == GF.sub(gf, 5, 8)
    assert 6 == GF.sub(gf, 6, 0)
    assert 8 == GF.sub(gf, 6, 1)
    assert 7 == GF.sub(gf, 6, 2)
    assert 3 == GF.sub(gf, 6, 3)
    assert 5 == GF.sub(gf, 6, 4)
    assert 4 == GF.sub(gf, 6, 5)
    assert 0 == GF.sub(gf, 6, 6)
    assert 2 == GF.sub(gf, 6, 7)
    assert 1 == GF.sub(gf, 6, 8)
    assert 7 == GF.sub(gf, 7, 0)
    assert 6 == GF.sub(gf, 7, 1)
    assert 8 == GF.sub(gf, 7, 2)
    assert 4 == GF.sub(gf, 7, 3)
    assert 3 == GF.sub(gf, 7, 4)
    assert 5 == GF.sub(gf, 7, 5)
    assert 1 == GF.sub(gf, 7, 6)
    assert 0 == GF.sub(gf, 7, 7)
    assert 2 == GF.sub(gf, 7, 8)
    assert 8 == GF.sub(gf, 8, 0)
    assert 7 == GF.sub(gf, 8, 1)
    assert 6 == GF.sub(gf, 8, 2)
    assert 5 == GF.sub(gf, 8, 3)
    assert 4 == GF.sub(gf, 8, 4)
    assert 3 == GF.sub(gf, 8, 5)
    assert 2 == GF.sub(gf, 8, 6)
    assert 1 == GF.sub(gf, 8, 7)
    assert 0 == GF.sub(gf, 8, 8)
  end

  @tag :gen_test_sub
  test "GF(3, 3) sub" do
    gf = GF.new(3, 3, [1,2,0,1])
    assert 4 == GF.sub(gf, 0, 8)
    assert 4 == GF.sub(gf, 0, 8)
    assert 7 == GF.sub(gf, 0, 5)
    assert 15 == GF.sub(gf, 0, 21)
    assert 25 == GF.sub(gf, 0, 14)
    assert 25 == GF.sub(gf, 1, 12)
    assert 19 == GF.sub(gf, 1, 9)
    assert 10 == GF.sub(gf, 2, 19)
    assert 11 == GF.sub(gf, 2, 18)
    assert 10 == GF.sub(gf, 2, 19)
    assert 15 == GF.sub(gf, 2, 23)
    assert 17 == GF.sub(gf, 2, 21)
    assert 11 == GF.sub(gf, 3, 22)
    assert 11 == GF.sub(gf, 3, 22)
    assert 26 == GF.sub(gf, 3, 16)
    assert 12 == GF.sub(gf, 3, 18)
    assert 7 == GF.sub(gf, 3, 8)
    assert 1 == GF.sub(gf, 3, 5)
    assert 26 == GF.sub(gf, 3, 16)
    assert 8 == GF.sub(gf, 4, 8)
    assert 5 == GF.sub(gf, 4, 2)
    assert 5 == GF.sub(gf, 4, 2)
    assert 17 == GF.sub(gf, 4, 26)
    assert 13 == GF.sub(gf, 5, 19)
    assert 26 == GF.sub(gf, 5, 15)
    assert 23 == GF.sub(gf, 5, 9)
    assert 23 == GF.sub(gf, 5, 9)
    assert 1 == GF.sub(gf, 5, 4)
    assert 7 == GF.sub(gf, 5, 7)
    assert 10 == GF.sub(gf, 5, 22)
    assert 0 == GF.sub(gf, 5, 5)
    assert 11 == GF.sub(gf, 7, 26)
    assert 12 == GF.sub(gf, 7, 22)
    assert 0 == GF.sub(gf, 7, 7)
    assert 19 == GF.sub(gf, 7, 15)
    assert 10 == GF.sub(gf, 7, 24)
    assert 21 == GF.sub(gf, 7, 13)
    assert 5 == GF.sub(gf, 8, 3)
    assert 10 == GF.sub(gf, 8, 25)
    assert 15 == GF.sub(gf, 8, 20)
    assert 2 == GF.sub(gf, 8, 6)
    assert 17 == GF.sub(gf, 8, 18)
    assert 7 == GF.sub(gf, 9, 14)
    assert 14 == GF.sub(gf, 9, 7)
    assert 5 == GF.sub(gf, 10, 17)
    assert 20 == GF.sub(gf, 10, 20)
    assert 1 == GF.sub(gf, 10, 9)
    assert 17 == GF.sub(gf, 10, 5)
    assert 23 == GF.sub(gf, 10, 26)
    assert 10 == GF.sub(gf, 11, 1)
    assert 13 == GF.sub(gf, 11, 7)
    assert 1 == GF.sub(gf, 11, 10)
    assert 2 == GF.sub(gf, 11, 9)
    assert 17 == GF.sub(gf, 11, 3)
    assert 0 == GF.sub(gf, 11, 11)
    assert 8 == GF.sub(gf, 12, 16)
    assert 13 == GF.sub(gf, 12, 2)
    assert 6 == GF.sub(gf, 13, 16)
    assert 15 == GF.sub(gf, 13, 7)
    assert 20 == GF.sub(gf, 13, 23)
    assert 3 == GF.sub(gf, 13, 10)
    assert 15 == GF.sub(gf, 14, 8)
    assert 20 == GF.sub(gf, 15, 25)
    assert 12 == GF.sub(gf, 15, 3)
    assert 20 == GF.sub(gf, 15, 25)
    assert 20 == GF.sub(gf, 16, 26)
    assert 7 == GF.sub(gf, 16, 9)
    assert 15 == GF.sub(gf, 16, 1)
    assert 7 == GF.sub(gf, 16, 9)
    assert 25 == GF.sub(gf, 16, 18)
    assert 21 == GF.sub(gf, 17, 23)
    assert 19 == GF.sub(gf, 17, 25)
    assert 7 == GF.sub(gf, 18, 23)
    assert 2 == GF.sub(gf, 18, 19)
    assert 16 == GF.sub(gf, 19, 12)
    assert 17 == GF.sub(gf, 19, 14)
    assert 14 == GF.sub(gf, 19, 17)
    assert 11 == GF.sub(gf, 20, 9)
    assert 22 == GF.sub(gf, 21, 2)
    assert 7 == GF.sub(gf, 21, 26)
    assert 11 == GF.sub(gf, 21, 13)
    assert 19 == GF.sub(gf, 21, 5)
    assert 19 == GF.sub(gf, 22, 3)
    assert 9 == GF.sub(gf, 22, 13)
    assert 21 == GF.sub(gf, 22, 1)
    assert 0 == GF.sub(gf, 23, 23)
    assert 11 == GF.sub(gf, 23, 12)
    assert 2 == GF.sub(gf, 23, 21)
    assert 2 == GF.sub(gf, 23, 21)
    assert 16 == GF.sub(gf, 24, 11)
    assert 14 == GF.sub(gf, 24, 13)
    assert 14 == GF.sub(gf, 25, 14)
    assert 26 == GF.sub(gf, 25, 2)
    assert 7 == GF.sub(gf, 25, 18)
    assert 20 == GF.sub(gf, 25, 8)
    assert 15 == GF.sub(gf, 25, 10)
    assert 12 == GF.sub(gf, 26, 14)
    assert 23 == GF.sub(gf, 26, 3)
    assert 14 == GF.sub(gf, 26, 12)
    assert 20 == GF.sub(gf, 26, 6)
  end

  @tag :gen_test_sub
  test "GF(5, 1) sub" do
    gf = GF.new(5, 1, [3,1])
    assert 0 == GF.sub(gf, 0, 0)
    assert 4 == GF.sub(gf, 0, 1)
    assert 3 == GF.sub(gf, 0, 2)
    assert 2 == GF.sub(gf, 0, 3)
    assert 1 == GF.sub(gf, 0, 4)
    assert 1 == GF.sub(gf, 1, 0)
    assert 0 == GF.sub(gf, 1, 1)
    assert 4 == GF.sub(gf, 1, 2)
    assert 3 == GF.sub(gf, 1, 3)
    assert 2 == GF.sub(gf, 1, 4)
    assert 2 == GF.sub(gf, 2, 0)
    assert 1 == GF.sub(gf, 2, 1)
    assert 0 == GF.sub(gf, 2, 2)
    assert 4 == GF.sub(gf, 2, 3)
    assert 3 == GF.sub(gf, 2, 4)
    assert 3 == GF.sub(gf, 3, 0)
    assert 2 == GF.sub(gf, 3, 1)
    assert 1 == GF.sub(gf, 3, 2)
    assert 0 == GF.sub(gf, 3, 3)
    assert 4 == GF.sub(gf, 3, 4)
    assert 4 == GF.sub(gf, 4, 0)
    assert 3 == GF.sub(gf, 4, 1)
    assert 2 == GF.sub(gf, 4, 2)
    assert 1 == GF.sub(gf, 4, 3)
    assert 0 == GF.sub(gf, 4, 4)
  end

  @tag :gen_test_sub
  test "GF(5, 2) sub" do
    gf = GF.new(5, 2, [2,4,1])
    assert 6 == GF.sub(gf, 0, 24)
    assert 21 == GF.sub(gf, 0, 9)
    assert 14 == GF.sub(gf, 1, 17)
    assert 21 == GF.sub(gf, 2, 6)
    assert 2 == GF.sub(gf, 2, 0)
    assert 15 == GF.sub(gf, 2, 12)
    assert 0 == GF.sub(gf, 2, 2)
    assert 5 == GF.sub(gf, 3, 23)
    assert 11 == GF.sub(gf, 3, 17)
    assert 10 == GF.sub(gf, 3, 18)
    assert 13 == GF.sub(gf, 3, 15)
    assert 5 == GF.sub(gf, 3, 23)
    assert 21 == GF.sub(gf, 3, 7)
    assert 4 == GF.sub(gf, 3, 4)
    assert 11 == GF.sub(gf, 3, 17)
    assert 23 == GF.sub(gf, 4, 6)
    assert 17 == GF.sub(gf, 4, 12)
    assert 3 == GF.sub(gf, 4, 1)
    assert 7 == GF.sub(gf, 4, 22)
    assert 20 == GF.sub(gf, 4, 9)
    assert 18 == GF.sub(gf, 5, 17)
    assert 0 == GF.sub(gf, 5, 5)
    assert 16 == GF.sub(gf, 6, 15)
    assert 10 == GF.sub(gf, 6, 21)
    assert 8 == GF.sub(gf, 7, 4)
    assert 11 == GF.sub(gf, 7, 21)
    assert 8 == GF.sub(gf, 7, 4)
    assert 14 == GF.sub(gf, 7, 23)
    assert 9 == GF.sub(gf, 7, 3)
    assert 0 == GF.sub(gf, 7, 7)
    assert 5 == GF.sub(gf, 8, 3)
    assert 1 == GF.sub(gf, 8, 7)
    assert 10 == GF.sub(gf, 8, 23)
    assert 6 == GF.sub(gf, 9, 3)
    assert 23 == GF.sub(gf, 9, 11)
    assert 9 == GF.sub(gf, 9, 0)
    assert 15 == GF.sub(gf, 9, 19)
    assert 22 == GF.sub(gf, 10, 18)
    assert 20 == GF.sub(gf, 10, 15)
    assert 22 == GF.sub(gf, 11, 19)
    assert 21 == GF.sub(gf, 11, 15)
    assert 24 == GF.sub(gf, 11, 17)
    assert 14 == GF.sub(gf, 12, 3)
    assert 21 == GF.sub(gf, 12, 16)
    assert 22 == GF.sub(gf, 13, 16)
    assert 9 == GF.sub(gf, 13, 9)
    assert 22 == GF.sub(gf, 13, 16)
    assert 2 == GF.sub(gf, 13, 11)
    assert 7 == GF.sub(gf, 14, 7)
    assert 19 == GF.sub(gf, 14, 20)
    assert 15 == GF.sub(gf, 14, 24)
    assert 11 == GF.sub(gf, 14, 3)
    assert 24 == GF.sub(gf, 14, 15)
    assert 24 == GF.sub(gf, 15, 21)
    assert 6 == GF.sub(gf, 15, 14)
    assert 17 == GF.sub(gf, 15, 3)
    assert 7 == GF.sub(gf, 15, 13)
    assert 22 == GF.sub(gf, 16, 24)
    assert 18 == GF.sub(gf, 16, 3)
    assert 12 == GF.sub(gf, 16, 9)
    assert 13 == GF.sub(gf, 16, 8)
    assert 7 == GF.sub(gf, 17, 10)
    assert 18 == GF.sub(gf, 17, 4)
    assert 14 == GF.sub(gf, 17, 8)
    assert 9 == GF.sub(gf, 17, 13)
    assert 4 == GF.sub(gf, 17, 18)
    assert 20 == GF.sub(gf, 17, 22)
    assert 7 == GF.sub(gf, 18, 11)
    assert 15 == GF.sub(gf, 18, 3)
    assert 19 == GF.sub(gf, 18, 4)
    assert 21 == GF.sub(gf, 18, 22)
    assert 8 == GF.sub(gf, 19, 11)
    assert 12 == GF.sub(gf, 19, 7)
    assert 8 == GF.sub(gf, 19, 11)
    assert 8 == GF.sub(gf, 19, 11)
    assert 21 == GF.sub(gf, 19, 23)
    assert 15 == GF.sub(gf, 20, 5)
    assert 18 == GF.sub(gf, 20, 7)
    assert 24 == GF.sub(gf, 20, 1)
    assert 6 == GF.sub(gf, 20, 19)
    assert 7 == GF.sub(gf, 20, 18)
    assert 18 == GF.sub(gf, 21, 8)
    assert 15 == GF.sub(gf, 21, 6)
    assert 19 == GF.sub(gf, 21, 7)
    assert 9 == GF.sub(gf, 22, 18)
    assert 17 == GF.sub(gf, 22, 5)
    assert 7 == GF.sub(gf, 22, 15)
    assert 14 == GF.sub(gf, 23, 14)
    assert 4 == GF.sub(gf, 23, 24)
    assert 17 == GF.sub(gf, 24, 7)
    assert 12 == GF.sub(gf, 24, 12)
    assert 24 == GF.sub(gf, 24, 0)
    assert 2 == GF.sub(gf, 24, 22)
    assert 9 == GF.sub(gf, 24, 15)
    assert 0 == GF.sub(gf, 24, 24)
    assert 17 == GF.sub(gf, 24, 7)
    assert 0 == GF.sub(gf, 24, 24)
    assert 13 == GF.sub(gf, 24, 11)
    assert 8 == GF.sub(gf, 24, 16)
    assert 17 == GF.sub(gf, 24, 7)
  end

  @tag :gen_test_sub
  test "GF(5, 3) sub" do
    gf = GF.new(5, 3, [3,3,0,1])
    assert 44 == GF.sub(gf, 0, 111)
    assert 19 == GF.sub(gf, 0, 11)
    assert 37 == GF.sub(gf, 2, 115)
    assert 74 == GF.sub(gf, 2, 83)
    assert 13 == GF.sub(gf, 4, 16)
    assert 108 == GF.sub(gf, 5, 27)
    assert 74 == GF.sub(gf, 9, 85)
    assert 41 == GF.sub(gf, 11, 120)
    assert 3 == GF.sub(gf, 11, 13)
    assert 84 == GF.sub(gf, 12, 58)
    assert 106 == GF.sub(gf, 13, 32)
    assert 55 == GF.sub(gf, 14, 84)
    assert 50 == GF.sub(gf, 15, 90)
    assert 14 == GF.sub(gf, 15, 6)
    assert 116 == GF.sub(gf, 16, 25)
    assert 39 == GF.sub(gf, 16, 107)
    assert 71 == GF.sub(gf, 17, 96)
    assert 102 == GF.sub(gf, 19, 42)
    assert 33 == GF.sub(gf, 19, 111)
    assert 99 == GF.sub(gf, 22, 53)
    assert 51 == GF.sub(gf, 24, 98)
    assert 93 == GF.sub(gf, 24, 56)
    assert 62 == GF.sub(gf, 27, 115)
    assert 99 == GF.sub(gf, 30, 86)
    assert 28 == GF.sub(gf, 30, 7)
    assert 97 == GF.sub(gf, 31, 89)
    assert 49 == GF.sub(gf, 33, 14)
    assert 23 == GF.sub(gf, 33, 35)
    assert 50 == GF.sub(gf, 38, 113)
    assert 93 == GF.sub(gf, 39, 96)
    assert 66 == GF.sub(gf, 43, 102)
    assert 58 == GF.sub(gf, 46, 118)
    assert 21 == GF.sub(gf, 49, 28)
    assert 68 == GF.sub(gf, 52, 14)
    assert 1 == GF.sub(gf, 52, 51)
    assert 31 == GF.sub(gf, 53, 47)
    assert 81 == GF.sub(gf, 54, 123)
    assert 62 == GF.sub(gf, 55, 23)
    assert 14 == GF.sub(gf, 57, 73)
    assert 67 == GF.sub(gf, 57, 15)
    assert 117 == GF.sub(gf, 57, 90)
    assert 10 == GF.sub(gf, 58, 73)
    assert 107 == GF.sub(gf, 59, 77)
    assert 70 == GF.sub(gf, 59, 14)
    assert 2 == GF.sub(gf, 61, 64)
    assert 54 == GF.sub(gf, 63, 14)
    assert 23 == GF.sub(gf, 63, 65)
    assert 73 == GF.sub(gf, 63, 15)
    assert 92 == GF.sub(gf, 64, 122)
    assert 38 == GF.sub(gf, 64, 26)
    assert 80 == GF.sub(gf, 66, 111)
    assert 116 == GF.sub(gf, 66, 75)
    assert 38 == GF.sub(gf, 66, 33)
    assert 30 == GF.sub(gf, 68, 38)
    assert 82 == GF.sub(gf, 68, 111)
    assert 98 == GF.sub(gf, 71, 103)
    assert 124 == GF.sub(gf, 72, 78)
    assert 82 == GF.sub(gf, 73, 116)
    assert 5 == GF.sub(gf, 74, 69)
    assert 5 == GF.sub(gf, 75, 95)
    assert 79 == GF.sub(gf, 76, 2)
    assert 68 == GF.sub(gf, 76, 38)
    assert 113 == GF.sub(gf, 79, 116)
    assert 90 == GF.sub(gf, 80, 15)
    assert 22 == GF.sub(gf, 83, 86)
    assert 116 == GF.sub(gf, 84, 118)
    assert 29 == GF.sub(gf, 84, 55)
    assert 99 == GF.sub(gf, 85, 16)
    assert 84 == GF.sub(gf, 85, 6)
    assert 106 == GF.sub(gf, 86, 105)
    assert 101 == GF.sub(gf, 87, 111)
    assert 102 == GF.sub(gf, 89, 112)
    assert 89 == GF.sub(gf, 93, 9)
    assert 79 == GF.sub(gf, 93, 19)
    assert 25 == GF.sub(gf, 96, 71)
    assert 73 == GF.sub(gf, 97, 29)
    assert 90 == GF.sub(gf, 97, 7)
    assert 10 == GF.sub(gf, 97, 87)
    assert 2 == GF.sub(gf, 98, 96)
    assert 15 == GF.sub(gf, 99, 84)
    assert 39 == GF.sub(gf, 101, 92)
    assert 63 == GF.sub(gf, 101, 68)
    assert 9 == GF.sub(gf, 101, 122)
    assert 45 == GF.sub(gf, 102, 82)
    assert 2 == GF.sub(gf, 104, 102)
    assert 49 == GF.sub(gf, 105, 86)
    assert 63 == GF.sub(gf, 108, 70)
    assert 39 == GF.sub(gf, 110, 76)
    assert 110 == GF.sub(gf, 111, 1)
    assert 40 == GF.sub(gf, 113, 98)
    assert 41 == GF.sub(gf, 114, 98)
    assert 68 == GF.sub(gf, 114, 71)
    assert 31 == GF.sub(gf, 114, 83)
    assert 104 == GF.sub(gf, 116, 17)
    assert 1 == GF.sub(gf, 116, 115)
    assert 44 == GF.sub(gf, 117, 78)
    assert 35 == GF.sub(gf, 117, 82)
    assert 40 == GF.sub(gf, 121, 81)
    assert 34 == GF.sub(gf, 124, 90)
    assert 63 == GF.sub(gf, 124, 61)
  end

  @tag :gen_test_sub
  test "GF(7, 1) sub" do
    gf = GF.new(7, 1, [4,1])
    assert 0 == GF.sub(gf, 0, 0)
    assert 6 == GF.sub(gf, 0, 1)
    assert 5 == GF.sub(gf, 0, 2)
    assert 4 == GF.sub(gf, 0, 3)
    assert 3 == GF.sub(gf, 0, 4)
    assert 2 == GF.sub(gf, 0, 5)
    assert 1 == GF.sub(gf, 0, 6)
    assert 1 == GF.sub(gf, 1, 0)
    assert 0 == GF.sub(gf, 1, 1)
    assert 6 == GF.sub(gf, 1, 2)
    assert 5 == GF.sub(gf, 1, 3)
    assert 4 == GF.sub(gf, 1, 4)
    assert 3 == GF.sub(gf, 1, 5)
    assert 2 == GF.sub(gf, 1, 6)
    assert 2 == GF.sub(gf, 2, 0)
    assert 1 == GF.sub(gf, 2, 1)
    assert 0 == GF.sub(gf, 2, 2)
    assert 6 == GF.sub(gf, 2, 3)
    assert 5 == GF.sub(gf, 2, 4)
    assert 4 == GF.sub(gf, 2, 5)
    assert 3 == GF.sub(gf, 2, 6)
    assert 3 == GF.sub(gf, 3, 0)
    assert 2 == GF.sub(gf, 3, 1)
    assert 1 == GF.sub(gf, 3, 2)
    assert 0 == GF.sub(gf, 3, 3)
    assert 6 == GF.sub(gf, 3, 4)
    assert 5 == GF.sub(gf, 3, 5)
    assert 4 == GF.sub(gf, 3, 6)
    assert 4 == GF.sub(gf, 4, 0)
    assert 3 == GF.sub(gf, 4, 1)
    assert 2 == GF.sub(gf, 4, 2)
    assert 1 == GF.sub(gf, 4, 3)
    assert 0 == GF.sub(gf, 4, 4)
    assert 6 == GF.sub(gf, 4, 5)
    assert 5 == GF.sub(gf, 4, 6)
    assert 5 == GF.sub(gf, 5, 0)
    assert 4 == GF.sub(gf, 5, 1)
    assert 3 == GF.sub(gf, 5, 2)
    assert 2 == GF.sub(gf, 5, 3)
    assert 1 == GF.sub(gf, 5, 4)
    assert 0 == GF.sub(gf, 5, 5)
    assert 6 == GF.sub(gf, 5, 6)
    assert 6 == GF.sub(gf, 6, 0)
    assert 5 == GF.sub(gf, 6, 1)
    assert 4 == GF.sub(gf, 6, 2)
    assert 3 == GF.sub(gf, 6, 3)
    assert 2 == GF.sub(gf, 6, 4)
    assert 1 == GF.sub(gf, 6, 5)
    assert 0 == GF.sub(gf, 6, 6)
  end

  @tag :gen_test_sub
  test "GF(7, 2) sub" do
    gf = GF.new(7, 2, [3,6,1])
    assert 11 == GF.sub(gf, 0, 45)
    assert 22 == GF.sub(gf, 0, 34)
    assert 14 == GF.sub(gf, 0, 35)
    assert 35 == GF.sub(gf, 1, 15)
    assert 48 == GF.sub(gf, 1, 9)
    assert 38 == GF.sub(gf, 1, 19)
    assert 5 == GF.sub(gf, 1, 3)
    assert 3 == GF.sub(gf, 1, 5)
    assert 26 == GF.sub(gf, 2, 32)
    assert 43 == GF.sub(gf, 2, 8)
    assert 39 == GF.sub(gf, 2, 19)
    assert 46 == GF.sub(gf, 2, 12)
    assert 19 == GF.sub(gf, 4, 41)
    assert 30 == GF.sub(gf, 5, 24)
    assert 37 == GF.sub(gf, 6, 18)
    assert 18 == GF.sub(gf, 7, 45)
    assert 48 == GF.sub(gf, 9, 17)
    assert 8 == GF.sub(gf, 10, 2)
    assert 27 == GF.sub(gf, 10, 39)
    assert 13 == GF.sub(gf, 10, 4)
    assert 5 == GF.sub(gf, 11, 13)
    assert 2 == GF.sub(gf, 11, 9)
    assert 31 == GF.sub(gf, 11, 29)
    assert 20 == GF.sub(gf, 11, 47)
    assert 36 == GF.sub(gf, 11, 24)
    assert 45 == GF.sub(gf, 12, 16)
    assert 37 == GF.sub(gf, 12, 24)
    assert 20 == GF.sub(gf, 13, 42)
    assert 23 == GF.sub(gf, 13, 39)
    assert 21 == GF.sub(gf, 14, 42)
    assert 7 == GF.sub(gf, 14, 7)
    assert 13 == GF.sub(gf, 14, 8)
    assert 35 == GF.sub(gf, 15, 29)
    assert 43 == GF.sub(gf, 15, 21)
    assert 26 == GF.sub(gf, 15, 45)
    assert 12 == GF.sub(gf, 15, 10)
    assert 27 == GF.sub(gf, 16, 45)
    assert 4 == GF.sub(gf, 16, 19)
    assert 5 == GF.sub(gf, 17, 19)
    assert 15 == GF.sub(gf, 17, 2)
    assert 22 == GF.sub(gf, 18, 45)
    assert 12 == GF.sub(gf, 18, 13)
    assert 3 == GF.sub(gf, 20, 17)
    assert 10 == GF.sub(gf, 20, 10)
    assert 34 == GF.sub(gf, 21, 43)
    assert 33 == GF.sub(gf, 22, 45)
    assert 14 == GF.sub(gf, 22, 8)
    assert 37 == GF.sub(gf, 23, 35)
    assert 12 == GF.sub(gf, 23, 18)
    assert 14 == GF.sub(gf, 23, 9)
    assert 45 == GF.sub(gf, 24, 28)
    assert 36 == GF.sub(gf, 25, 38)
    assert 41 == GF.sub(gf, 25, 40)
    assert 41 == GF.sub(gf, 26, 41)
    assert 40 == GF.sub(gf, 27, 36)
    assert 44 == GF.sub(gf, 27, 32)
    assert 19 == GF.sub(gf, 28, 16)
    assert 43 == GF.sub(gf, 28, 41)
    assert 37 == GF.sub(gf, 29, 48)
    assert 47 == GF.sub(gf, 30, 39)
    assert 44 == GF.sub(gf, 30, 35)
    assert 5 == GF.sub(gf, 30, 32)
    assert 35 == GF.sub(gf, 30, 44)
    assert 15 == GF.sub(gf, 31, 16)
    assert 27 == GF.sub(gf, 32, 12)
    assert 30 == GF.sub(gf, 32, 2)
    assert 6 == GF.sub(gf, 32, 33)
    assert 6 == GF.sub(gf, 32, 33)
    assert 28 == GF.sub(gf, 32, 4)
    assert 34 == GF.sub(gf, 34, 0)
    assert 33 == GF.sub(gf, 34, 1)
    assert 44 == GF.sub(gf, 34, 39)
    assert 2 == GF.sub(gf, 34, 32)
    assert 44 == GF.sub(gf, 35, 47)
    assert 7 == GF.sub(gf, 35, 28)
    assert 25 == GF.sub(gf, 35, 17)
    assert 24 == GF.sub(gf, 35, 18)
    assert 42 == GF.sub(gf, 36, 43)
    assert 36 == GF.sub(gf, 38, 2)
    assert 39 == GF.sub(gf, 38, 6)
    assert 23 == GF.sub(gf, 38, 15)
    assert 45 == GF.sub(gf, 39, 43)
    assert 41 == GF.sub(gf, 39, 5)
    assert 48 == GF.sub(gf, 39, 47)
    assert 15 == GF.sub(gf, 40, 25)
    assert 10 == GF.sub(gf, 40, 30)
    assert 25 == GF.sub(gf, 40, 15)
    assert 27 == GF.sub(gf, 41, 14)
    assert 2 == GF.sub(gf, 42, 47)
    assert 1 == GF.sub(gf, 42, 48)
    assert 4 == GF.sub(gf, 42, 45)
    assert 14 == GF.sub(gf, 43, 29)
    assert 36 == GF.sub(gf, 44, 8)
    assert 39 == GF.sub(gf, 45, 13)
    assert 23 == GF.sub(gf, 46, 23)
    assert 29 == GF.sub(gf, 46, 17)
    assert 3 == GF.sub(gf, 47, 44)
    assert 38 == GF.sub(gf, 47, 9)
    assert 34 == GF.sub(gf, 48, 14)
    assert 37 == GF.sub(gf, 48, 11)
  end

  @tag :gen_test_sub
  test "GF(7, 3) sub" do
    gf = GF.new(7, 3, [4,0,6,1])
    assert 64 == GF.sub(gf, 0, 335)
    assert 10 == GF.sub(gf, 1, 47)
    assert 138 == GF.sub(gf, 3, 264)
    assert 73 == GF.sub(gf, 3, 322)
    assert 32 == GF.sub(gf, 4, 21)
    assert 318 == GF.sub(gf, 5, 79)
    assert 56 == GF.sub(gf, 10, 297)
    assert 195 == GF.sub(gf, 15, 219)
    assert 201 == GF.sub(gf, 17, 166)
    assert 272 == GF.sub(gf, 17, 144)
    assert 245 == GF.sub(gf, 20, 118)
    assert 124 == GF.sub(gf, 21, 247)
    assert 64 == GF.sub(gf, 22, 301)
    assert 82 == GF.sub(gf, 23, 340)
    assert 85 == GF.sub(gf, 34, 341)
    assert 290 == GF.sub(gf, 38, 140)
    assert 197 == GF.sub(gf, 40, 186)
    assert 68 == GF.sub(gf, 45, 327)
    assert 331 == GF.sub(gf, 48, 60)
    assert 106 == GF.sub(gf, 48, 285)
    assert 231 == GF.sub(gf, 49, 210)
    assert 91 == GF.sub(gf, 49, 7)
    assert 109 == GF.sub(gf, 52, 342)
    assert 91 == GF.sub(gf, 61, 19)
    assert 71 == GF.sub(gf, 61, 39)
    assert 256 == GF.sub(gf, 62, 149)
    assert 107 == GF.sub(gf, 62, 298)
    assert 299 == GF.sub(gf, 65, 116)
    assert 99 == GF.sub(gf, 70, 321)
    assert 257 == GF.sub(gf, 71, 164)
    assert 238 == GF.sub(gf, 71, 225)
    assert 145 == GF.sub(gf, 76, 323)
    assert 126 == GF.sub(gf, 85, 302)
    assert 210 == GF.sub(gf, 103, 285)
    assert 277 == GF.sub(gf, 118, 233)
    assert 65 == GF.sub(gf, 121, 56)
    assert 11 == GF.sub(gf, 125, 114)
    assert 277 == GF.sub(gf, 126, 199)
    assert 201 == GF.sub(gf, 131, 273)
    assert 240 == GF.sub(gf, 133, 292)
    assert 127 == GF.sub(gf, 136, 9)
    assert 203 == GF.sub(gf, 139, 279)
    assert 314 == GF.sub(gf, 149, 234)
    assert 223 == GF.sub(gf, 159, 335)
    assert 49 == GF.sub(gf, 159, 110)
    assert 33 == GF.sub(gf, 159, 175)
    assert 86 == GF.sub(gf, 162, 132)
    assert 59 == GF.sub(gf, 162, 110)
    assert 37 == GF.sub(gf, 163, 175)
    assert 102 == GF.sub(gf, 165, 63)
    assert 116 == GF.sub(gf, 172, 56)
    assert 159 == GF.sub(gf, 173, 14)
    assert 198 == GF.sub(gf, 177, 322)
    assert 59 == GF.sub(gf, 180, 121)
    assert 276 == GF.sub(gf, 183, 257)
    assert 0 == GF.sub(gf, 185, 185)
    assert 115 == GF.sub(gf, 191, 83)
    assert 3 == GF.sub(gf, 192, 189)
    assert 1 == GF.sub(gf, 201, 200)
    assert 29 == GF.sub(gf, 202, 222)
    assert 147 == GF.sub(gf, 205, 58)
    assert 249 == GF.sub(gf, 206, 307)
    assert 255 == GF.sub(gf, 210, 305)
    assert 294 == GF.sub(gf, 214, 263)
    assert 192 == GF.sub(gf, 222, 79)
    assert 152 == GF.sub(gf, 223, 71)
    assert 255 == GF.sub(gf, 227, 315)
    assert 293 == GF.sub(gf, 234, 340)
    assert 265 == GF.sub(gf, 239, 324)
    assert 93 == GF.sub(gf, 243, 150)
    assert 48 == GF.sub(gf, 255, 263)
    assert 189 == GF.sub(gf, 256, 116)
    assert 153 == GF.sub(gf, 257, 111)
    assert 299 == GF.sub(gf, 259, 310)
    assert 115 == GF.sub(gf, 261, 153)
    assert 243 == GF.sub(gf, 266, 79)
    assert 224 == GF.sub(gf, 270, 95)
    assert 274 == GF.sub(gf, 271, 46)
    assert 118 == GF.sub(gf, 272, 154)
    assert 167 == GF.sub(gf, 288, 128)
    assert 174 == GF.sub(gf, 293, 119)
    assert 252 == GF.sub(gf, 295, 92)
    assert 197 == GF.sub(gf, 298, 101)
    assert 258 == GF.sub(gf, 299, 97)
    assert 320 == GF.sub(gf, 301, 37)
    assert 267 == GF.sub(gf, 305, 87)
    assert 288 == GF.sub(gf, 305, 66)
    assert 112 == GF.sub(gf, 306, 243)
    assert 86 == GF.sub(gf, 308, 278)
    assert 74 == GF.sub(gf, 311, 293)
    assert 26 == GF.sub(gf, 319, 300)
    assert 251 == GF.sub(gf, 322, 78)
    assert 264 == GF.sub(gf, 322, 65)
    assert 144 == GF.sub(gf, 324, 236)
    assert 305 == GF.sub(gf, 335, 30)
    assert 195 == GF.sub(gf, 336, 148)
    assert 88 == GF.sub(gf, 337, 256)
    assert 24 == GF.sub(gf, 338, 321)
    assert 111 == GF.sub(gf, 341, 237)
    assert 340 == GF.sub(gf, 341, 1)
  end

end
